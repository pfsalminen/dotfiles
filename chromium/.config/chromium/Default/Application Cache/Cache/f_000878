$T.prototype.pUa=jP(214,function(a){this.J=qb(arguments,0)});function PV(a){Pf(this,a,0,-1,null,null)}x(PV,Nf);function QV(a){Pf(this,a,0,-1,null,null)}x(QV,Nf);function RV(a,b){W(a,1,b)}function DNc(a,b){W(a,3,b)}function ENc(a,b){W(a,6,b)}function SV(a,b){return V(a,2,b)}function TV(a,b){return V(a,2,b)}function FNc(a){return a.C["ritz-DisplayExplorePivotPromoV2"].fb()}function GNc(a,b,c,d,e){return f5b(a,v(function(){return this.C.calculateArrayFormulaResultPreview(b,c,d,e,!1,this.H,!0)},a))}
function HNc(a,b){a.C=b}function INc(a){var b=0;z(a,function(c,d){c.length>a[b].length&&(b=d)});return Va(a[b],function(b,d){return Va(a,function(a){return a[d]})})}function JNc(a,b){var c={row:0,yj:0};ritz_api.RitzModelApi.getActiveFilterId(a)&&b&&(b=b.rect,ritz_api.RitzModelApi.getNumberOfRows(a)>b.Yc()+1?c.row=b.Yc()+1:ritz_api.RitzModelApi.getNumberOfColumns(a)>b.cd()+1&&(c.yj=b.cd()+1));return c}
function KNc(a,b,c,d){b="="!=b[0]?"="+b:b;var e=c.bd+"";c=JNc(e,c);(a=GNc(a.C,b,e,c.row,c.yj))&&d&&a.length<a[0].length&&(a=INc(a));return a}function LNc(a){if(a)for(var b=1<a.length?1:0;b<a.length;b++){for(var c=!1,d=a[b],e=0;e<d.length;e++)if(!d[e]){c=!0;break}if(!c)return!0}return!1}function MNc(a,b){ZT(a);for(var c=0;c<b.length;c++)GEc(a,b[c])}function NNc(a,b){if(a.Sb()){if(b){var c=ze(document);c&&c==a.D.qb()&&a.C.focus()}Lh(a.qb(),"waffle-autovis-lightbox-readonly",b);a.D.setVisible(!b)}}
var ONc=[2];function PNc(a){Pf(this,a,0,-1,ONc,null)}x(PNc,Nf);var QNc={FFc:0,bza:1,Fza:2},RNc=[1,2];function SNc(a){Pf(this,a,0,-1,RNc,null)}x(SNc,Nf);var TNc=[1];function UNc(a){Pf(this,a,0,-1,TNc,null)}x(UNc,Nf);var VNc=[1];function WNc(a){Pf(this,a,0,-1,VNc,null)}x(WNc,Nf);var XNc=[1];function YNc(a){Pf(this,a,0,-1,XNc,null)}x(YNc,Nf);var ZNc=[3];function $Nc(a){Pf(this,a,0,-1,ZNc,null)}x($Nc,Nf);$Nc.prototype.getChartType=function(){return F(this,1)};
function aOc(a){Pf(this,a,0,-1,null,null)}x(aOc,Nf);function bOc(a){Pf(this,a,0,-1,null,null)}x(bOc,Nf);bOc.prototype.getChartType=function(){return F(this,1)};function cOc(a){Pf(this,a,0,-1,null,null)}x(cOc,Nf);cOc.prototype.tf=function(){return F(this,2)};function dOc(){return J(H(),"feepts")&&J(H(),"feepp")}
function UV(a,b){var c=[],d={};if(a>b*b)for(var e=0;e<b;e++){do var f=Math.floor(Math.random()*a);while(d[f]);d[f]=1;c.push(f)}else{for(d=0;d<a;d++)c.push(d);for(d=0;d<b;d++)e=Math.floor(Math.random()*(a-d)+d),f=c[d],c[d]=c[e],c[e]=f}return c.slice(0,b)}function VV(a){return a[UV(a.length,1)[0]]}function eOc(a){var b={};z(a,function(a){b[a]||(b[a]=0);b[a]++});rb(a);vb(a,function(a,d){return b[d]-b[a]})}
function fOc(){return P('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content"><div class="waffle-assistant-answercard-interpret-content"><div class="waffle-assistant-answercard-interpret"></div></div><div class="waffle-assistant-answercard-answer-content"><div class="waffle-assistant-answercard-pivot-content"></div></div></div></div>')}
function gOc(a,b,c){b=c||b;return P(O(Fr({Md:"waffle-assistant-insert-pivottable-button waffle-assistant-readonly-hidden",content:wr(""+O(Ls({icon:"docs-icon-img docs-icon-insert-pivot-table"},b))),style:4},b))+'<div class="waffle-assistant-button-separator waffle-assistant-readonly-hidden"></div>'+O(Fr({Md:"waffle-assistant-zoom-button",content:wr(""+O(Ls({icon:"docs-icon-img docs-icon-zoom-in"},b))),style:4},b)))}
function hOc(a,b,c){b=c||b;a=vr("Ask a question about your data");a='<div class="waffle-assistant-answers-input"><form class="waffle-assistant-answers-query-box"><div class="waffle-assistant-answers-input-container">'+('<div class="waffle-assistant-answers-search-icon">'+O(Ls({icon:"docs-icon-img docs-icon-search-this-document"},b))+'</div><input type="text" class="waffle-assistant-answers-input-box" placeholder="'+Q(a)+'" aria-label="'+Q(a)+'"/></div><div class="waffle-assistant-answers-input-controls"><div class="waffle-assistant-answers-button-container">');
a+='<div class="'+Q("waffle-assistant-answers-query-box-button waffle-assistant-answers-clear-query-button")+'">'+O(Ls({icon:"docs-icon-img docs-icon-cancel"},b))+'</div></div><div class="waffle-assistant-answers-spinner-container" style="display:none"></div></div></form></div>';return P(a)};function WV(){}x(WV,nr);ta(WV);WV.prototype.xc=n("waffle-assistant-button");function XV(a){M.call(this,a);this.D=new pr("",new WV,this.qa());this.Qa(this.D);this.H=new UT(!1,"#4285f4");this.Qa(this.H);this.C=this.J=this.F=null}q(XV,M);XV.prototype.Ma=function(){this.$c(N(hOc))};XV.prototype.$c=function(a){M.prototype.$c.call(this,a)};
XV.prototype.Wa=function(){M.prototype.Wa.call(this);var a=this.qa();this.C=a.$a("waffle-assistant-answers-query-box",this.qb());this.D.Ab(a.$a("waffle-assistant-answers-clear-query-button",this.C));this.F=a.$a("waffle-assistant-answers-spinner-container",this.C);this.H.render(this.F);this.J=a.$a("waffle-assistant-answers-input-box",this.C)};XV.prototype.setVisible=function(a){this.getElement()&&(L(this.getElement(),a),(a=Wt)&&a.dispatchEvent("resize"))};function iOc(a,b,c,d,e,f){D.call(this,"sqc");this.O=a;this.F=f||"";this.V=b;this.H=d;this.Na=e;this.C=c}x(iOc,D);iOc.prototype.Ij=g("V");function jOc(a,b,c,d,e,f,h){d=void 0===d?null:d;e=void 0===e?null:e;f=void 0===f?null:f;h=void 0===h?null:h;D.call(this,"answers-submit-query");this.O=a;this.V=b;this.H=c;this.F=d;this.Na=e;this.C=f;this.Va=h}x(jOc,D);function kOc(){this.F=[];this.D={};this.J=null;this.C=new oTa}function lOc(a,b,c,d){function e(a){return a.toLowerCase()}rb(b,void 0,e);rb(c,void 0,e);rb(d,void 0,e);z(b,a.H,a);z(c,a.H,a);z(d,a.H,a)}kOc.prototype.H=function(a){var b=a.toLocaleLowerCase(),c=0;if(100>b.length)for(var d=0;d<b.length&&3>c;++d)if(0==d||/[^a-zA-Z0-9]/.test(b[d-1])&&!/[^a-zA-Z0-9]/.test(b[d])){++c;var e=a,f=b.substr(d),h=this.C.get(f);h||(h=[],this.C.add(f,h));h.push(e)}};
function mOc(a,b){a.D[b.toLowerCase()]||(a.D[b.toLowerCase()]=b)}kOc.prototype.cI=function(a,b,c){if(Mb(a||"")){var d=this.J.Cm();d=nOc(this,a.substring(0,d));var e=oOc(this,b-d.length,a);d=nb(d,e)}else d=oOc(this,b);d.length>b&&(d=qb(d,0,b));c(a,d)};
function oOc(a,b,c){var d=c||"";c=jc(a.D,function(a){return Gb(a,d)});var e=pOc(oc(c),d?1:2,1);a=Ua(a.F,function(a){return Gb(a.query,d)&&!e[a.query.toLowerCase()]});b=pOc(a,b-nc(e),2);b=oc(b);var f=Va(b,function(a,b){a.ssa=b;return a.UVa});z(b,function(a){a.rsa=f});return nb(b,oc(e))}
function nOc(a,b){for(var c=[],d=3,e={},f=b.toLowerCase(),h={},k=0;k<f.length&&0<d;h={Nba:h.Nba,f0:h.f0,cT:h.cT},++k)if(0==k||" "==f[k-1]&&" "!=f[k]){h.cT={};h.f0=0;h.Nba=f.substr(k);var l=a.C.Ae(h.Nba);z(l,function(b){return function(c){var d=c.length-b.Nba.length;b.f0=Math.max(d,b.f0);c=a.C.get(c);b.cT[d]||(b.cT[d]=[]);pb(b.cT[d],c)}}(h));for(l=0;l<=h.f0&&0<d;++l){var m=h.cT[l];if(m)for(var r=0;r<m.length&&0<d;++r){var u=m[r];Sb(b.toLowerCase(),u.toLowerCase())||e[u]||(--d,c.push({text:u,iq:"",
FA:0,pBa:f.length-k,UVa:void 0,rsa:[],ssa:-1}),e[u]=!0)}}}return c}function pOc(a,b,c){b=UV(a.length,Math.min(a.length,b));var d={};z(b,function(b){b=a[b];var e=la(b)?b:b.query;d[e.toLowerCase()]={text:e,iq:la(b)?"":b.iq,FA:c,pBa:0,UVa:la(b)?void 0:b.type,rsa:[],ssa:-1}});return d};function YV(){JL.call(this,"",null,!1)}x(YV,JL);YV.prototype.HD=function(a,b){if(2==a.FA||1==a.FA)return YV.oa.HD.call(this,a.text,b);var c=this.fb(),d=this.Cm(),e=" "==c[d];void 0==c[d]&&(c=c.trim(),d>c.length&&(d=c.length));var f=c.substring(0,d-a.pBa)+a.text;e||(f+=" ");a=YV.oa.HD.call(this,{toString:function(){return f+c.substring(d)}},b);b=this.lk;b.blur();b.focus();this.j1(f.length);return a};
YV.prototype.Zf=function(a){var b=YV.oa.Zf.call(this,a);b||39!=a.keyCode||a.ctrlKey||a.shiftKey||(b=this.C,UJb(b)&&b.qC()&&a.preventDefault(),b=!0);return b};function qOc(a,b,c){b=c||b;return P('<div class="waffle-assistant-answers-ac-suggestion"><div class="waffle-assistant-answers-ac-suggestion-icon-container"><div class="waffle-assistant-answers-ac-suggested-query-icon">'+O(Ls({icon:"docs-icon-img docs-icon-help"},b))+'</div><div class="waffle-assistant-answers-ac-session-query-icon">'+O(Ls({icon:"docs-icon-img docs-icon-clock"},b))+'</div><div class="waffle-assistant-answers-ac-entity-icon">'+O(Ls({icon:"docs-icon-img docs-icon-arrow-tilted"},b))+
'</div></div><span class="waffle-assistant-answers-ac-suggestion-text"></span></div>')};function rOc(a){this.Fb=a||Md()}
rOc.prototype.jt=function(a,b,c){b=N(qOc);var d=this.Fb.$a("waffle-assistant-answers-ac-suggestion-text",b);a=a.data;this.Fb.Ze(d,a.text);d=this.Fb.$a("waffle-assistant-answers-ac-entity-icon",b);var e=this.Fb.$a("waffle-assistant-answers-ac-suggested-query-icon",b),f=this.Fb.$a("waffle-assistant-answers-ac-session-query-icon",b);L(d,0==a.FA);L(e,2==a.FA);L(f,1==a.FA);d="";switch(a.FA){case 0:d="waffle-assistant-answers-ac-row-entity";break;case 1:d="waffle-assistant-answers-ac-row-session-query";break;
case 2:d="waffle-assistant-answers-ac-row-suggested-query"}d&&Hh(c,d);this.Fb.appendChild(c,b)};function ZV(a,b,c){a&&(t(b)||(b=a.hasAttribute("title")?a.getAttribute("title"):""),b=Mb(b),kj(a,b,void 0),byc(a),a.setAttribute("data-tooltip-delay",500),Rcc(a,t(c)?c:1))};function sOc(a){var b=a.type;switch(la(b)&&b.toLowerCase()){case "checkbox":case "radio":return a.checked?a.value:null;case "select-one":return b=a.selectedIndex,0<=b?a.options[b].value:null;case "select-multiple":b=[];for(var c,d=0;c=a.options[d];d++)c.selected&&b.push(c.value);return b.length?b:null;default:return null!=a.value?a.value:null}}
function tOc(a,b){var c=a.type;switch(la(c)&&c.toLowerCase()){case "checkbox":case "radio":a.checked=b;break;case "select-one":a.selectedIndex=-1;if(la(b))for(var d=0;c=a.options[d];d++)if(c.value==b){c.selected=!0;break}break;case "select-multiple":la(b)&&(b=[b]);for(d=0;c=a.options[d];d++)if(c.selected=!1,b)for(var e,f=0;e=b[f];f++)c.value==e&&(c.selected=!0);break;default:a.value=null!=b?b:""}};function uOc(a,b,c,d){A.call(this);this.O=a;this.D=a.J;this.F=a.D;this.L=a.C;this.H=new YV;this.H.lGa=!0;this.H.Va=!0;this.xa(this.H);this.V=c;this.V.J=this.H;a=new HL(null,new rOc(a.qa()));this.C=new FL(this.V,a,this.H);this.xa(this.C);this.ma=b;this.J=!1;this.$=Kj(new Jj,d).build();this.bb=new Ph(this);this.xa(this.bb);vOc(this)}q(uOc,A);
function vOc(a){wOc(a);a.H.C=a.C;a.C.jZ=!1;a.C.b$=6;jKb(a.H,a.D);ZV(a.F.getElement(),"Clear query");a.bb.R(a.C,"update",a.Fob).R(a.L,"submit",a.sNb).R(a.L,"focus",function(){return xOc(a,!0)},!0).R(a.L,"blur",function(){return xOc(a,!1)},!0).R(a.F,"action",a.V8a).R(a.D,"input",a.TWa).R(a.D,"focus",a.xTa);a.F.setVisible(!1)}p=uOc.prototype;p.Pa=function(){A.prototype.Pa.call(this);this.V.J=null};function yOc(a,b,c){c=void 0===c?!1:c;tOc(a.D,b);c&&a.D.focus();a.TWa()}
function wOc(a){a=a.C.Wd();a.className="waffle-assistant-answers-ac-renderer";a.jN="waffle-assistant-answers-ac-row";a.L3="waffle-assistant-answers-ac-active";a.Wma="waffle-assistant-answers-ac-highlighted"}p.Fob=function(a){a.row&&(a=a.row,2==a.FA?(zOc(this,1,a.rsa,a.ssa,a.iq,2),this.ma.Yb(2652,this.$)):0==a.FA?(this.J=!0,this.ma.Yb(2651,this.$)):1==a.FA&&zOc(this,3))};function xOc(a,b){Lh(a.L,"waffle-assistant-answers-query-box-focused",b);GL(a.C)&&!b&&a.C.Wh()}p.TWa=function(){this.F.setVisible(!!sOc(this.D))};
p.xTa=function(){this.C.ow(this.D);var a=Yb(sOc(this.D));this.H.j1(a.length);this.C.setToken(a||"  ");this.C.update(!0)};p.sNb=function(a){a.stopPropagation();a.preventDefault();zOc(this,2)};function zOc(a,b,c,d,e,f){c=void 0===c?null:c;d=void 0===d?null:d;e=void 0===e?null:e;f=void 0===f?null:f;var h=Mb(sOc(a.D));a.F.setVisible(!!h);AOc(a);a.O.dispatchEvent(new jOc(b,h,a.J,c,d,e,f));a.J=!1}p.V8a=function(){tOc(this.D,"");this.F.setVisible(!1)};function AOc(a){a.D.blur();GL(a.C)&&a.C.Wh()};function BOc(a,b){M.call(this,b);this.F=a;this.H=new kOc;this.C=new XV(this.qa());this.Qa(this.C);this.D=null}q(BOc,M);BOc.prototype.$c=function(a){M.prototype.$c.call(this,a);this.C.render(a)};BOc.prototype.Wa=function(){M.prototype.Wa.call(this);this.D=new uOc(this.C,this.F,this.H,4);this.xa(this.D);Hh(this.C.qb(),"waffle-assistant-answers-input-with-icon")};function COc(){return P('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-before-chart-preview" tabindex="0"></div><div class="waffle-assistant-chart-preview"></div><div class="waffle-assistant-after-chart-preview" tabindex="0"></div><div class="waffle-assistant-chart-highlights"></div></div>')}
function DOc(a,b,c){b=c||b;return P(O(Fr({Md:"waffle-assistant-insert-chart-button waffle-assistant-readonly-hidden",content:wr(""+O(Ls({icon:"docs-icon-img docs-icon-insert-autovis-chart"},b))),style:4},b))+'<div class="waffle-assistant-button-separator waffle-assistant-readonly-hidden"></div>'+O(Fr({Md:"waffle-assistant-zoom-button",content:wr(""+O(Ls({icon:"docs-icon-img docs-icon-zoom-in"},b))),style:4},b)))};function EOc(a){var b='<div class="waffle-assistant-facet-section"><div class="waffle-assistant-facet-header"><div class="waffle-assistant-pie-icon"></div><div class="waffle-assistant-facet-top-text">',c='By <span class="waffle-assistant-facet-title">'+(O(a.b9a)+"</span>"),d=0==a.DFa.length;b=b+c+'</div><div class="waffle-assistant-facet-toggle" tabindex="0"></div></div>';if(d)c=P('<div class="waffle-assistant-facet-by-color-container"><div class="waffle-assistant-faceted-chart waffle-assistant-facet-by-color"></div></div>');
else{c='<div class="waffle-assistant-facet-charts-container">';a=a.DFa;for(var e=a.length,f=0;f<e;f++){var h=a[f];c+=(0==f%2?'<div class="waffle-assistant-facet-chart-row">':"")+'<div class="waffle-assistant-single-facet"><div class="waffle-assistant-single-facet-title">';c=h?c+O(h):c+"(empty)";c+='</div><div class="waffle-assistant-faceted-chart"></div></div>'+(1==f%2||f==e-1?"</div>":"")}c=P(c+"</div>")}b+='<div class="waffle-assistant-facet-content-wrapper'+(d?" waffle-assistant-facet-white-section":
"")+'">'+c+(uA?'<div class="waffle-assistant-facet-feedback-container"></div><div class="waffle-assistant-facet-thumbs-container"></div>':"")+"</div></div>";return P(b)};function $V(a,b,c,d,e,f){d=void 0===d?null:d;e=void 0===e?null:e;f=void 0===f?null:f;D.call(this,a,b);this.C=b;this.cb=c;this.H=d;this.O=e;this.gb=f}q($V,D);$V.prototype.Ui=g("cb");function FOc(a,b,c,d,e,f,h){h=void 0===h?null:h;$V.call(this,"be",null,d,e,f);this.V=a;this.Na=b;this.Jc=c;this.F=h}q(FOc,$V);FOc.prototype.le=g("Jc");function GOc(a,b,c,d,e,f,h,k){M.call(this,k);this.J=a;this.D=b;this.O=e;this.V=f;this.F=h;this.C=this.Jc=null;this.L=Kj(new Jj,10).build()}x(GOc,M);GOc.prototype.Wa=function(){GOc.oa.Wa.call(this);(new bS(yI,this.D.oh)).send(v(this.H,this,this.D))};GOc.prototype.rKa=function(a,b){a=new FOc(this.J.clone(),this.O,this.Jc,2746,a,b);this.dispatchEvent(a)};
GOc.prototype.H=function(a,b){var c=this;if(b)if(b.Yi())eI.fF(this.qb(),b);else{a.Df(b.le());kT(a,a.le());var d=(b=a.le())?b.toJSON():null,e=new ritz.charts.model.GvizChart;e.updateChartWrapperJsonString(a.toJSON());d&&e.updateDataTableJsonString(d);WDc(e,this.qb(),this.V,this.F,function(a){HOc(c,a)});this.Jc=b}};
function HOc(a,b){a.getHandler().R(b,"waffle-tvizchart-tooltip-shown",function(){a.C=Ea()}).R(b,"waffle-tvizchart-tooltip-hidden",function(){na(a.C)&&500<Ea()-a.C&&a.F.Yb(2750,a.L);a.C=null})};function IOc(){return P('<div class="waffle-assistant-feedback-card waffle-assistant-feedback-card-hidden"><div class="waffle-assistant-feedback-card-content"><div class="waffle-assistant-feedback-card-text">Tell us what could be improved.</div><div class="waffle-assistant-feedback-card-link">Send feedback</div></div></div>')};function JOc(a,b){M.call(this,b);this.D=a;this.C=new pr("",new WT,this.qa());this.Qa(this.C)}x(JOc,M);p=JOc.prototype;p.Ma=function(){this.wb=N(IOc)};p.Wa=function(){JOc.oa.Wa.call(this);var a=this.$a("waffle-assistant-feedback-card-link");this.C.Ab(a);this.getHandler().R(this.qb(),"mousedown",this.q0b).R(this.C,"action",this.Iub);this.show(!1)};p.q0b=function(a){a.stopPropagation()};
p.show=function(a){var b=this.qb(),c=this.$a("waffle-assistant-feedback-card-link");Lh(b,"waffle-assistant-feedback-card-hidden",!a);ue(c,a)};p.Iub=function(){K.Wu.$b({source:this.D});this.show(!1);this.dispatchEvent(new D("feedback-dialog-opened"))};function KOc(a,b,c){b=c||b;a='<div class="waffle-assistant-thumbs"><div class="waffle-assistant-thumbs-text">Was this useful?'+('</div><div class="waffle-assistant-thumbs-button-holder"><div class="waffle-assistant-thumbs-up-button">'+O(Ls({icon:"docs-icon-img docs-icon-thumb-up"},b))+'</div><div class="waffle-assistant-thumbs-down-button">'+O(Ls({icon:"docs-icon-img docs-icon-thumb-down"},b))+"</div></div></div>");return P(a)};function aW(a){M.call(this,a);this.C=new pr("",new WV,this.qa());this.Qa(this.C);this.D=new pr("",new WV,this.qa());this.Qa(this.D)}x(aW,M);aW.prototype.Ma=function(){this.wb=N(KOc)};aW.prototype.Wa=function(){aW.oa.Wa.call(this);var a=this.$a("waffle-assistant-thumbs-down-button");this.C.Ab(a);ZV(a,"Not useful");a=this.$a("waffle-assistant-thumbs-up-button");this.D.Ab(a);ZV(a,"Useful");this.getHandler().R(this.C,"action",this.F).R(this.D,"action",this.H)};
function LOc(a,b){a.qa().Ze(a.$a("waffle-assistant-thumbs-text"),b)}aW.prototype.F=function(){this.dispatchEvent(new D("thumbs-down"));L(this.qb(),!1)};aW.prototype.H=function(){this.dispatchEvent(new D("thumbs-up"));L(this.qb(),!1)};function MOc(a,b,c,d,e,f){M.call(this,f);this.J=a;this.cb=b;this.gb=c;this.Na=d;this.Aa=e;this.L=Wv(this.J,23);this.Va=V(this.J,22);this.C=V(this.J,26);this.ma=[];this.Zc=new $v;this.O=this.F=this.D=null;this.V=!1;this.$=new Gr("",this.qa());this.Qa(this.$);this.H=null}x(MOc,M);p=MOc.prototype;p.Ma=function(){MOc.oa.Ma.call(this);this.wb=N(EOc,{b9a:this.C,DFa:this.L});this.qb().style.visibility="hidden"};
p.Wa=function(){MOc.oa.Wa.call(this);var a=this.$a("waffle-assistant-facet-toggle");this.$.Ab(a);this.getHandler().R(this.qb(),"mousedown",this.$_b).R(this.$,"action",this.bIb);uA&&(this.O=new JOc("assistantAutovisFacetFeedback",this.qa()),this.O.render(this.$a("waffle-assistant-facet-feedback-container")),this.D=new aW(this.qa()),this.Qa(this.D),this.D.render(this.$a("waffle-assistant-facet-thumbs-container")),LOc(this.D,this.L.length?"Were these charts useful?":"Was this chart useful?"),this.getHandler().R(this.D,
"thumbs-up",this.b0b).R(this.D,"thumbs-down",this.a0b));NOc(this,J(H(),"fefsbd"))};p.Pd=g("V");p.$_b=function(a){a.stopPropagation()};p.bIb=function(){var a=Gh(this.$a("waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden");NOc(this,a);OOc(this,a?2647:2646)};
function NOc(a,b){var c=a.$a("waffle-assistant-facet-toggle");se(c,b?"HIDE":"SHOW");Lh(a.$a("waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden",!b);z(a.Ti("waffle-assistant-faceted-chart"),function(a){ue(a,b)});a.D&&L(a.D.qb(),b);var d='Show chart broken down by "'+(a.C+'"');a='Hide chart broken down by "'+(a.C+'"');ZV(c,b?a:d)}
function POc(a){a.setOption("legend","top");a.setOption("titleTextStyle.fontSize",10);a.setOption("allowAsync",!0);a.setOption("applyAggregateData",void 0);a.setOption("pieSliceTextStyle.fontSize",11);a.setOption("tooltip.textStyle.fontSize",11);"BarChart"==a.getChartType()&&a.setOption("isStacked",!0)}function QOc(a){"BarChart"==a.getChartType()&&a.setOption("isStacked",!0);a.setOption("applyAggregateData",void 0)}
function ROc(a){a.V||z(a.ma,v(function(a){var b=a.qb();if(!this.Aa.contains(b)){var d=this.Aa;a=new SOc(b,a);WXb(d,a)}},a))}p.b0b=function(){OOc(this,2649)};p.a0b=function(){OOc(this,2648);this.O.show(!0)};function OOc(a,b){var c=a.Na,d=new KT,e=a.H.getChartType();d.J=e;e=a.H.le();d.F=e?e.clone():null;MDc(c,b,d,10,a.H,a.H.oh)};function TOc(){return P('<div class="waffle-assistant-card" tabindex="0" role="region">'+(uA?'<div class="waffle-assistant-card-feedback-container waffle-assistant-feedback-card-hidden"></div>':"")+'<div class="waffle-assistant-card-spinner-container"></div><div class="waffle-assistant-card-inner"><div class="waffle-assistant-button-holder waffle-assistant-card-options"></div><div class="waffle-assistant-card-content-container"></div>'+(uA?'<div class="waffle-assistant-thumbs-container"></div>':"")+
"</div></div>")};function bW(a,b){var c=this;M.call(this,b);this.H=a;this.cb=this.Va=this.O=null;this.Lb=new UT(!0,"#4285f4");this.Qa(this.Lb);this.Rb=this.ad=this.ze=!1;this.rb=new Ui(function(){c.rb.stop();c.qb().parentNode.querySelector(":hover")==c.qb()?c.rb.start():c.eH()},100);this.xa(this.rb);this.hg=this.Sc=!1}x(bW,M);p=bW.prototype;p.OA=Je;p.T8=Ke;p.hC=Le;p.gC=Le;p.W6=Le;p.pka=Le;p.oka=Le;p.Ct=ca("hg");p.Pd=g("hg");p.Ma=function(){this.wb=N(TOc)};
p.Wa=function(){bW.oa.Wa.call(this);var a=this.$a("waffle-assistant-card-spinner-container");this.Lb.render(a);Yh(this.$a("waffle-assistant-card-inner"),"visibility","hidden");if(this.OA()){a=this.qb();var b=new yq(a);this.xa(b);this.getHandler().R(b,"focusin",this.zpb).R(b,"focusout",this.ypb).R(a,"mouseenter",this.JL).R(a,"mouseleave",this.eH)}UOc(this,!1);uA&&(this.cb=new JOc(this.xz(),this.qa()),this.cb.render(this.$a("waffle-assistant-card-feedback-container")),this.getHandler().R(this.cb,"feedback-dialog-opened",
this.Jub).R(this,"trigger_feedback",this.$Zb),this.T8()?(this.Va=new aW(this.qa()),this.Va.render(this.$a("waffle-assistant-thumbs-container")),VOc(this,!0),a=Yb(this.W6()),Kb(a)||LOc(this.Va,a),a=Yb(this.pka()),Kb(a)||ZV(this.Va.$a("waffle-assistant-thumbs-up-button"),a),a=Yb(this.oka()),Kb(a)||ZV(this.Va.$a("waffle-assistant-thumbs-down-button"),a),this.getHandler().R(this.Va,"thumbs-down",this.o0b).R(this.Va,"thumbs-up",this.p0b)):VOc(this,!1));this.yy()};
function cW(a){return a.$a("waffle-assistant-card-content-container")}function dW(a){a.OA();return a.$a("waffle-assistant-card-options")}function VOc(a,b){uA&&L(a.$a("waffle-assistant-thumbs-container"),a.T8()&&b)}p.WJ=function(){this.isDisposed()||(this.ze=!0,WOc(this))};function XOc(a,b){!a.ad&&b&&(a.ad=!0,WOc(a))}function WOc(a){if(a.ze&&a.ad){var b=v(a.n0b,a);a.zy(b)}}p.JL=function(){this.Rb||(UOc(this,!0),this.Rb=!0,this.rb.start())};p.eH=function(){UOc(this,!1);this.Rb=!1};
p.zpb=function(){UOc(this,!0)};p.ypb=function(){var a=this,b=new Ui(function(){qe(a.qb(),document.activeElement)||a.qb().parentNode.querySelector(":hover")==a.qb()||UOc(a,!1)},0);this.xa(b);b.start()};p.o0b=function(){YOc(this,!0);VOc(this,!1);var a=this.gC();this.dispatchEvent(new $V("ge",this,a))};p.p0b=function(){VOc(this,!1);var a=this.hC();this.dispatchEvent(new $V("ge",this,a))};p.Jub=function(){YOc(this,!1)};p.$Zb=function(){YOc(this,!0)};
function UOc(a,b){var c=a.$a("waffle-assistant-card-options");a=a.OA();L(c,a&&b)}p.n0b=function(){VT(this.Lb,!1);L(this.Lb.qb(),!1);Yh(this.$a("waffle-assistant-card-inner"),"visibility","visible");this.dispatchEvent(new D("content-rendered"))};function YOc(a,b){Lh(a.$a("waffle-assistant-card-feedback-container"),"waffle-assistant-feedback-card-hidden",!b);a.cb.show(b)};function ZOc(a,b,c,d,e,f,h){h=void 0===h?null:h;$V.call(this,"ae",null,d,e,f);this.V=a;this.Na=b;this.Va=c;this.F=h}q(ZOc,$V);ZOc.prototype.bx=g("V");var $Oc={options:{hAxis:{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0},vAxes:[{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0},{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0}],fontName:"Roboto",legacyContinuousAxisRemoved:!0,booleanRole:"certainty",theme:"material",width:null,height:null}};function aPc(a){var b=new nI(Ac($Oc));return BEc(a,b)}
function bPc(a){a.setOption("legend.position","none");a.setOption("hAxis.slantedText",!1);a.setOption("hAxis.textStyle.fontSize",11);a.setOption("vAxes.0.textStyle.fontSize",11);a.setOption("vAxes.1.textStyle.fontSize",11);a.setOption("fontStyle.size",10);a.setOption("fontStyle.italic",!1);a.setOption("titleTextStyle.bold",!1);a.setOption("titleTextStyle.fontSize",12);a.setOption("async",40);!1!==a.Uc("useFirstColumnAsDomain")&&a.le()&&"number"===a.le().xd(0)&&a.setOption("hAxis.gridlines.count",
-1);return a};function cPc(a,b,c){var d=a.Yc(),e=a.cd();switch(b){case 0:d=Math.min(d,a.zc()+c);break;case 1:e=Math.min(e,a.yc()+c)}return by(a.Ib(),a.zc(),a.yc(),d,e)}function dPc(a){var b=new Yfa;G(b,1,""+a.bd);var c=a.rect.zc();G(b,2,c);c=a.rect.Yc();G(b,3,c);b.Hr(a.rect.yc());b.ey(a.rect.cd());return b}function ePc(a){var b=new yg;if(a){var c=new Ag;a=dPc(a);Vf(c,7,a);Vf(b,58,c)}return b};function fPc(a){a.setLegendPositionType(0);var b=a.getAxis(ritz.charts.model.AxisName.X);b&&(b.setSlantedTextAngle(0),b.getTickTextStyle().setFontSize(11));(b=a.getAxis(ritz.charts.model.AxisName.Y))&&b.getTickTextStyle().setFontSize(11);(b=a.getAxis(ritz.charts.model.AxisName.RIGHT))&&b.getTickTextStyle().setFontSize(11);b=a.getGlobalTextStyle();b.setFontSize(10);b.setItalic(!1);a=a.getTitleTextStyle();a.setBold(!1);a.setFontSize(12)};function eW(a,b,c,d,e,f,h,k){bW.call(this,a,k);this.C=V(a,8);this.yb=b;this.Mb=c;this.Ob=d;this.L=e;this.sb=f;this.gc=h;this.V=new Gr("",this.qa());this.Qa(this.V);this.$=new Gr("",this.qa());this.Qa(this.$);this.Zc=new $v;this.Jb=null;this.Na=!1;this.Eb=[];this.Cb=[];this.hb=[];this.gb=this.Aa=this.D=this.J=this.ma=null;a=ePc(this.gc);this.F=Lj(Kj(new Jj,10),a).build()}x(eW,bW);
var fW={wYa:"waffle-assistant-after-chart-preview",QYa:"waffle-assistant-before-chart-preview",eZa:"waffle-assistant-card-draggable",d3:"waffle-assistant-chart-highlights",r1a:"waffle-assistant-insert-chart-button",uea:"waffle-assistant-chart-preview",j4a:"waffle-assistant-button-separator",c5a:"waffle-assistant-styled-border",d5a:"waffle-assistant-styled-rect",y6a:"waffle-assistant-zoom-button"};p=eW.prototype;
p.zy=function(a){var b=this;this.isDisposed()||(ritz_api.ChartsApi?(this.Jb=a,gPc(this)):ritz_api.RitzEntryPoint.loadChartsApi(function(){b.zy(a)}))};p.yy=function(){var a=this;if(!this.isDisposed())if(J(H(),"fecpmr"))if(ritz_api.ChartsApi){var b=pzc(hPc(this),V(this.C,28));Eh(this.qb(),b)}else ritz_api.RitzEntryPoint.loadChartsApi(function(){a.yy()});else iPc(this,v(function(a){a=ozc(this.yb,a);Eh(this.qb(),a)},this),!1)};p.OA=Ke;p.xz=n("autovisFeedback");p.hC=n(2208);p.gC=n(2207);p.W6=n("Was this chart useful?");
p.Ma=function(){eW.oa.Ma.call(this);cW(this).appendChild(N(COc));dW(this).appendChild(N(DOc));if(Sv(this.C,22)){this.D=new MOc(this.C,this.O,this.Ob,this.L,this.sb,this.qa());this.Qa(this.D,!0);var a=this.D,b=this.Pd();a.V=b;ROc(a)}};
p.Wa=function(){eW.oa.Wa.call(this);Hh(this.qb(),fW.eZa);var a=this.$a(fW.r1a);this.V.Ab(a);ZV(a,"Insert chart");a=this.$a(fW.y6a);this.$.Ab(a);ZV(a,"View full size");a=this.$a(fW.QYa);var b=this.$a(fW.wYa);this.getHandler().R(this.qb(),"keydown",this.Y_b).R(a,"focus",this.cpb).R(b,"focus",this.Onb).R(this.V,"action",this.lxb).R(this.V.qb(),"mousedown",this.pta).R(this.$,"action",this.QJb).R(this.$.qb(),"mousedown",this.pta).R(this.$a(fW.d3),"mousedown",this.pta).R(pG(this.yb),"Xa",this.Z_b);jPc(this);
this.L.Yb(2790,this.F);this.D&&this.L.Yb(2791,this.F)};p.Ct=function(a){eW.oa.Ct.call(this,a);jPc(this);this.Sb()&&kPc(this)};function jPc(a){if(a.Sb()){var b=a.Pd();a.V.setVisible(!b);a=a.qa().$a(fW.j4a,dW(a));L(a,!b)}}p.Y_b=function(a){13==a.keyCode&&a.target==this.qb()&&(a.preventDefault(),a.stopPropagation(),lPc(this,2255))};
function mPc(a){var b=a.getChartType(),c=!!V(a.C,14),d=V(a.C,16),e=!!V(a.C,15),f="Histogram"==b;b="PieChart"==b;var h=jS(Wv(a.H,4));if(!h[0]||h[0].bd==VA(a.yb)){for(var k=1<h.length,l=[],m=0;m<h.length;m++){var r=h[m].rect;r=c!=b?DYa(r,new Jd(r.width,1)):DYa(r,new Jd(1,r.height));pb(l,r)}c=TE(a.Mb).D;var u=[];for(w in Cx)u.push(HFb(c,Cx[w]));var w=Va(l,function(a){return Va(u,Ca(Mx,a))});f&&e&&(w=qb(w,1));a.hb=nPc(w.length,b&&0<d||!f&&!b&&e,b&&k);d=TE(a.Mb);for(e=0;e<w.length;e++)for(f=a.hb[e],b=
0;b<w[e].length;b++)w[e][b]&&Zx(w[e][b])&&(k=nxc(d,w[e][b],fW.d5a),a.xa(k),yM(d.V,"default",k,!0),Yh(k.qb(),"background-color",f),k.setVisible(!0),a.Eb.push(k),k=WL(d,w[e][b],fW.c5a,1,0),a.xa(k),bMb(k,f),k.setVisible(!0),a.Cb.push(k))}}function oPc(a){Db(a.Eb);Db(a.Cb);a.Eb=[];a.Cb=[];a.hb=[]}p.Z_b=function(){this.Na&&(oPc(this),mPc(this))};p.JL=function(){eW.oa.JL.call(this);this.Aa=Ea();this.Na||(mPc(this),this.Na=!0)};
p.eH=function(){eW.oa.eH.call(this);na(this.Aa)&&500<Ea()-this.Aa&&this.L.Yb(2789,this.F);this.Aa=null;oPc(this);this.Na=!1};p.cpb=function(){var a=this.$a(fW.d3);vi(a)?a.focus():this.qb().nextSibling&&this.qb().nextSibling.focus()};p.Onb=function(){var a;if(a=this.cb)a=this.cb,a.Kb("waffle-assistant-feedback-card-hidden")?a=!1:(a.$a("waffle-assistant-feedback-card-link").focus(),a=!0);a||this.$.qb().focus()};p.lxb=function(){lPc(this,2255)};p.pta=function(a){a.stopPropagation()};
p.QJb=function(){E5a.$b(this,this.F)};p.rKa=function(a,b){lPc(this,2257,a,b)};function lPc(a,b,c,d){if(J(H(),"fecpmr")){var e=hPc(a);a.dispatchEvent(new ZOc(e,V(a.C,28),a.O,b,c,d,Ij(a.F)))}else iPc(a,v(function(a){a=new FOc(a,this.O,this.J&&this.J.le(),b,c,d,Ij(this.F));this.dispatchEvent(a)},a),!1)}function pPc(a,b){WDc(b,a.$a(fW.uea),a.Ob,a.L,function(b){qPc(a,b)})}
function qPc(a,b){null!==a.ma&&(sn(qn(),a.ma),a.ma=null);a.isDisposed()||(a.getHandler().R(b,"waffle-tvizchart-tooltip-shown",function(){a.gb=Ea()}).R(b,"waffle-tvizchart-tooltip-hidden",function(){na(a.gb)&&500<Ea()-a.gb&&a.L.Yb(2750,a.F);a.gb=null}),a.Jb(),kPc(a))}function kPc(a){if(!a.Pd()){var b=a.$a(fW.uea);if(!a.sb.contains(b)){var c=a.sb;a=new SOc(b,a);WXb(c,a)}}}
function rPc(a,b,c){var d=[];try{var e=a.Zc.serialize(c);d=Va(cDc(Ca(ritz_api.RitzModelApi.getVerbalHighlightsForProto,e),b).call(),$Cc)}catch(f){d=[]}a=a.$a(fW.d3);L(a,0<d.length);0<d.length&&(a.appendChild(d[0]),ue(a,!0))}function hPc(a){sPc(a);var b=new ritz.charts.model.ChartImpl,c=V(a.C,28);b.setChartModel(a.Zc.serialize(c.bx()));b.setChartDataSource(ritz_api.ChartsApi.createChartDataSource(a.Zc.serialize(c)));return b}
function tPc(a){sPc(a);V(a.C,16);var b=aPc(a.C);b.Uaa(yI);var c=DEc(a.H);b.sj(c.toString());a.D&&(c=c.clone(),a.D.F=c);return b}function sPc(a){a.Sc&&(a.ma=rn(qn(),oA.pua),a.Sc=!1)}
function gPc(a){var b=tPc(a);b=bPc(b,a.$a("waffle-assistant-card-inner"));if(J(H(),"fecpmr")){var c=hPc(a);fPc(c);rPc(a,c,V(a.C,28));pPc(a,c)}else(new bS(yI,b.oh)).send(function(c){var d=b;if(c)if(c.Yi())eI.fF(a.$a(fW.uea),c);else{d.Df(c.le());kT(d,d.le());c=new Vz;c.setContext(d.toJSON());var f=!!V(a.C,14);W(c,3,f);var h=V(a.C,16);W(c,4,h);W(c,5,f);W(c,8,0);V(a.C,24)&&(f=V(a.C,25),W(c,9,f));f=jS(Wv(a.H,4));for(h=0;h<f.length;h++)c.addRange(ey(f[h].rect,f[h].bd));f=(f=d.le())?f.toJSON():null;h=new ritz.charts.model.GvizChart;
h.updateChartWrapperJsonString(d.toJSON());f&&h.updateDataTableJsonString(f);rPc(a,h,c);a.J=d;c=(c=d.le())?c.toJSON():null;f=new ritz.charts.model.GvizChart;f.updateChartWrapperJsonString(d.toJSON());c&&f.updateDataTableJsonString(c);pPc(a,f)}});a.D&&iPc(a,v(function(a){var c=this.D,d=b;a=new nI(a.toJSON());d=new nI(d.toJSON());var h=c.Ti("waffle-assistant-faceted-chart");if(1<h.length){QOc(a);var k=d;POc(k);k.setOption("pieSliceText","percentage");k.setOption("axisFontSize",0);k.setOption("hAxis.title",
null);k.setOption("hAxis.textPosition","none");k.setOption("vAxes.0.title",null);k.setOption("vAxes.0.textPosition","none");k.setOption("vAxes.1.title",null);k.setOption("vAxes.1.textPosition","none");k.setOption("legend","none");k.setOption("titleTextStyle.fontSize",0)}else k=a,QOc(k),k.setOption("applyAggregateData",void 0),k.setOption("legend","right"),POc(d);k=jS(Wv(c.J,27));$rb(c.F,k);k=V(c.J,25);for(var l=0;l<h.length;l++){var m=la(c.L[l])?c.L[l]:null,r=k.clone(),u=c.Va,w=new $z;W(w,1,u);la(m)&&
w.mb(m);W(r,7,w);c.F.jc("dt",encodeURIComponent(JSON.stringify(c.Zc.serialize(r))));u=new nI(a.toJSON());u.sj(c.F.toString());r=d.clone();r.sj(c.F.toString());var y=c,B=u.Uc("title");B||(B=Byc(u));w=B+(' when "'+(y.C+('" is "'+(m+'"'))));y=B+(' by "'+(y.C+'"'));w=m?w:y;u.setOption("title",w);r.setOption("title",w);y=new GOc(u,r,c.C,m,c.cb,c.gb,c.Na,c.qa());c.Qa(y);w=h[l];y.Ab(w);c.ma.push(y);y=c;B=Byc(u);u=B+(' broken down by "'+(y.C+('" for "'+(m+'"'))));y=B+(' broken down by "'+(y.C+'"'));Eh(w,
m?u:y);c.H=r}ROc(c);c.qb().style.visibility="visible"},a),!1)}function iPc(a,b,c){var d=tPc(a);(new bS(yI,d.oh)).send(function(a){a?(a=a.le(),c&&d.Df(a),kT(d,a),b(d)):b(null)})}p.getChartType=function(){return this.C.getChartType()};function nPc(a,b,c){var d=b?["#666"]:[];c&&(a/=2);b&&--a;b=pBc("material").colors;for(var e=0;e<a;e++)d.push(b[e%b.length].color);c&&pb(d,d);return d};function SOc(a){WN.apply(this,arguments)}q(SOc,WN);SOc.prototype.yka=g("element");function uPc(){UN.call(this);EXb(this,this);this.rb="waffle-assistant-dragged-card"}x(uPc,VXb);uPc.prototype.contains=function(a){return!!z(this.L,function(b){if(b.element==a)return!0})};uPc.prototype.wka=function(a){var b=uPc.oa.wka.call(this,a);a=a.querySelectorAll("CANVAS");for(var c=b.querySelectorAll("CANVAS"),d=0;d<a.length;d++)c[d].getContext("2d").drawImage(a[d],0,0);return b};function vPc(){return P('<div class="waffle-assistant-word-cloud-card"><div class="waffle-assistant-word-cloud-title"></div><div class="waffle-assistant-word-cloud-words-container"></div></div>')};function wPc(a,b){bW.call(this,a,b);this.C=V(a,8)}x(wPc,bW);p=wPc.prototype;p.yy=sa;p.xz=n("assistantWordCloudFeedback");p.hC=n(2634);p.gC=n(2633);p.Ma=function(){wPc.oa.Ma.call(this);cW(this).appendChild(N(vPc));Hh(cW(this),"waffle-assistant-word-cloud-content-container")};
p.zy=function(a){for(var b=Wv(this.C,19),c=Wv(this.C,20),d=this.$a("waffle-assistant-word-cloud-words-container"),e=0;e<b.length;e++)if(xPc(this,b,c,e),120<d.clientHeight){xPc(this,b,c,e-1);break}b=this.qa();c=V(this.C,2);c=Ee(b,c);d=this.$a("waffle-assistant-word-cloud-title");b.appendChild(d,c);a()};
function xPc(a,b,c,d){var e=a.$a("waffle-assistant-word-cloud-words-container");for(a=a.qa();e.firstChild;)e.removeChild(e.firstChild);for(var f=c[d],h=c[0],k=0;k<=d;k++){0!=k&&e.appendChild(Ee(a," "));var l=a.createElement("SPAN");a.appendChild(l,Ee(a,b[k]));a.appendChild(e,l);Hh(l,"waffle-assistant-word-cloud-word");var m=c[k];l.style.color=0==k%2?"#00695C":"#61443C";l.style.fontSize=(m-f)/(h-f)*15+9+"px"}};function yPc(a,b,c){b=c||b;c='<div class="waffle-assistant-feature-section" tabindex="0" role="region" aria-label="';var d=" "+(Q(a.title)+" Section ");c+=zr(d);c+='"><div class="waffle-assistant-section-header"><div class="waffle-assistant-section-title">'+O(a.title)+"</div>";c+=O(Fr({Md:"waffle-assistant-section-more-button",content:wr("More"),style:4},b));return P(c+'</div><div class="waffle-assistant-section-content"></div><div class="waffle-assistant-section-card-holder"></div></div>')};function zPc(){var a=P;var b='<div class="waffle-assistant-empty-list" style="display: none"><div class="waffle-assistant-empty-list-content">'+O(v3b({color:"rgb(46%, 46%, 46%)",iconSize:"40"}))+'<div aria-live="polite"><div class="waffle-assistant-empty-list-title">';b=P(b+'Nothing interesting here right now</div><div class="waffle-assistant-empty-list-body">Try selecting different data. Information with numbers works best.</div></div><div class="waffle-assistant-empty-list-learn-more waffle-assistant-empty-list-link"><span>Learn more</span></div><div class="waffle-assistant-empty-list-link"><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try an example</a></div></div></div>');
return a('<div class="waffle-assistant-scroll-pane" style="display: none;"><div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-panel-pane">'+b+'<div class="waffle-assistant-panel-content-container"><div class="waffle-assistant-panel-card-holder"></div></div></div></div>')}
function APc(a,b,c){b=c||b;return P('<div class="waffle-assistant-panel-title-bar">'+O(Fr({Md:"waffle-assistant-panel-back-button",content:wr(""+O(Ls({icon:"docs-icon-img-container docs-explore-img docs-explore-back-white",Mt:"waffle-assistant-panel-back-button-icon"},b))),style:4},b))+'<div class="waffle-assistant-title-text" role="heading">'+O(a.title)+"</div></div>")};function gW(a){M.call(this,a);this.Sc=new UT(!1,"#4285f4");this.Qa(this.Sc);this.H=new M(this.qa());this.Qa(this.H);this.C=[];this.ze=this.Dc=!1;this.yd=this.ld=this.sb=this.Aa=null;this.Rb=new Gr("",a,4);mj(this.Rb,2,!1);this.Qa(this.Rb)}x(gW,M);var BPc={defaultHelpArticleId:"6280499"};p=gW.prototype;p.Ma=function(){gW.oa.Ma.call(this);this.wb=N(zPc);this.ld=this.$a("waffle-assistant-panel-content-container");this.yd=this.$a("waffle-assistant-empty-list")};
p.Wa=function(){gW.oa.Wa.call(this);var a=this.$a("waffle-assistant-spinner-container");this.Sc.render(a);this.H.Ab(this.$a("waffle-assistant-panel-card-holder"));this.Rb.Ab(this.$a("waffle-assistant-empty-list-learn-more"));this.getHandler().R(this.Rb,"action",this.s0b).R(this.qb(),"scroll",Vxc(this.lca,10,this))};p.setVisible=function(a){var b=this;L(this.qb(),a);z(this.C,function(a){if(!a.Sb()){var c=b.H.fd();a.O=c;b.H.Qa(a,!0);a.WJ()}});(this.Dc=a)&&0<this.C.length&&this.C[0].qb().focus()};
p.Gqa=function(a,b){var c=this.qa();this.Aa&&this.R4();this.Aa=new M;this.Qa(this.Aa);a=kr(a,APc,{title:b});this.sb=new Gr("",this.qa());this.Aa.Qa(this.sb);this.sb.Ab(c.$a("waffle-assistant-panel-back-button",a));ZV(this.sb.qb(),"Back");this.Aa.getHandler().R(this.sb,"action",this.r0b)};p.R4=function(){this.Aa.dispose();this.Aa=null};function CPc(a,b){VT(a.Sc,b);L(a.$a("waffle-assistant-panel-pane"),!b)}p.oI=function(a){L(this.yd,a);L(this.ld,!a)};
function DPc(a,b){jb(a.C,b);a.H.removeChild(b);a.H.Fg(b,0);a.C.push(b)}p.$H=function(a){jb(this.C,a);-1!=Ji(this.H,a)&&this.H.removeChild(a,!0)};p.QW=function(){this.H.Hd(!0);Db(this.C);this.C=[]};p.lca=function(){var a=this.qb();a=a.scrollTop+si(a).height;for(var b=0,c=0;c<this.C.length;c++){var d=this.C[c];b<a?(XOc(d,!0),b+=si(d.qb()).height):XOc(d,!1)}};function EPc(a,b){a.ze=b;z(a.C,function(a){a.Ct(b)})}p.Pd=g("ze");p.s0b=function(){K.$n.$b(BPc)};p.r0b=function(){this.dispatchEvent("Yd")};function hW(a,b,c,d){M.call(this,d);this.$=a;this.sb=b;this.Aa=new Gr("",this.qa());this.Qa(this.Aa);this.L=new M(this.qa());this.Qa(this.L);this.C=null;this.rb=[];this.ma=this.hb=!1;this.V=c}x(hW,M);p=hW.prototype;p.MMa=Je;p.Kra=Ke;p.Ma=function(){hW.oa.Ma.call(this);this.wb=N(yPc,{title:this.getTitle()})};
p.Wa=function(){hW.oa.Wa.call(this);this.L.Ab(this.$a("waffle-assistant-section-card-holder"));this.Aa.Ab(this.$a("waffle-assistant-section-more-button"));this.getHandler().R(this.Aa,"action",this.xzb);this.C=this.jCa();this.xa(this.C);L(FPc(this),this.MMa());this.setVisible(!1)};p.setVisible=function(a){if(this.Sb()&&this.isVisible()!=a&&(L(this.qb(),a),a)){L(this.Aa.qb(),this.cVa());a=new Ag;G(a,4,this.w2());var b=new yg;Vf(b,58,a);a=Lj(Kj(new Jj,10),b).build();this.V.Yb(2774,a)}};
p.isVisible=function(){return this.Sb()&&vi(this.qb())};p.cVa=function(){return this.rb.length>this.$};p.jCa=function(){return new gW(this.qa())};p.fO=function(a){this.ma=a;z(GPc(this),function(b){b.Ct(a)});EPc(this.C,a)};p.Pd=g("ma");p.Pf=sa;
p.dO=function(a){this.rb=a;for(var b=0;b<a.length;b++){if(this.L.fd()<this.$){var c=this.EP(a[b]);c.Ct(this.ma);var d=this.L.fd();c.O=d;this.L.Qa(c,!0)}if(this.Kra()&&(this.C.oI(!1),c=this.EP(a[b]),c.Ct(this.ma),d=this.C,d.C.push(c),d.Dc)){CPc(d,!1);var e=d.H.fd();c.O=e;d.H.Qa(c,!0);c.WJ()}}};function GPc(a){var b=[];a.L.wf(function(a){b.push(a)});return b}function FPc(a){return a.$a("waffle-assistant-section-content")}p.Oma=function(){return this.L.XZ()};
p.eO=function(){this.rb=[];Db(this.L.Hd(!0));this.setVisible(!1);this.Kra()&&(this.C.QW(),this.C.oI(!0))};function HPc(a){a.L.wf(function(a,c){c<this.$&&a.WJ()},a)}p.z2=function(a){var b=0;if(this.hb)this.C.lca();else if(this.Oma()){this.setVisible(!0);b=si(this.$a("waffle-assistant-section-header")).height+si(FPc(this)).height;for(var c=GPc(this),d=0;d<c.length;d++)b<a&&d<this.$?(this.NJa(c[d]),XOc(c[d],!0),b+=si(c[d].qb()).height):XOc(c[d],!1)}else this.setVisible(!1);return a-b};p.NJa=sa;
p.SU=function(a){(this.hb=a)||this.C.R4()};p.Wb=g("hb");p.pXa=function(a){this.C&&CPc(this.C,a)};function IPc(a,b){a.C.Gqa(b,a.getTitle())}p.xzb=function(){this.SU(!0);this.dispatchEvent("de")};function iW(a,b,c,d,e,f){var h=th(H(),"fmnac");h||(h=20);hW.call(this,h,e,d,f);this.Na=a;this.J=b;this.Va=c;this.D=new uPc;this.xa(this.D);this.F=null;this.H=0;this.O=null}x(iW,hW);p=iW.prototype;p.Wa=function(){iW.oa.Wa.call(this);this.D.init();this.getHandler().R(this.D,"drag",this.X_b).R(this.D,"dragend",this.W_b)};p.getTitle=n("Analysis");p.zW=function(a){return 0==a};
p.EP=function(a){return"WordCloud"==V(a,8).getChartType()?new wPc(a,this.qa()):new eW(a,this.Na,this.J,this.Va,this.V,this.D,this.O,this.qa())};p.fO=function(a){iW.oa.fO.call(this,a);a&&GXb(this.D)};p.NJa=function(a){this.getHandler().Wc(a,"content-rendered",this.V_b);this.H++};p.dO=function(a,b){this.O=b||null;iW.oa.dO.call(this,a,b)};p.V_b=function(){0==--this.H&&this.dispatchEvent("$d")};p.X_b=function(){this.F=li(this.D.Tc.target)};
p.W_b=function(a){var b=this.F,c=TE(this.J).C;if(Uh(JK(c,"page",!1,!1)).contains(b)){var d=HK(c,b.x,b.y,"page");c=pK(c,d,"page");b=new Ed(b.x-c.left,b.y-c.top);a.C.getData().rKa(d,b)}this.F=null};p.w2=n(2);var JPc={O5a:0,Hea:1,Qca:2,bea:3,i6a:4,Y4a:5,Xwa:6,fV:7,H4a:8,I4a:9},KPc={UNKNOWN_ERROR:0,sGc:1,iwc:2,yhc:3},LPc={XFc:0,Thc:1,Xca:2,jk:3,LFc:4,A7b:5,ijc:6},MPc={TFc:0,iB:1,pwc:2,Uvc:3,ezc:4},NPc={MFc:0,kwc:1,Ny:2,stc:3},OPc={BFc:0,hFc:1,Ylc:2,TDc:3,SDc:4,jac:5,cuc:6},PPc={dDc:0,rB:1,BZa:2,REc:3,$Bc:4,i3a:5,oGc:6,Fwa:7,kua:8,Sua:9,zO:10},QPc={UNKNOWN:0,j7b:1,i7b:2,h7b:3,F8b:4,y$b:5,dac:6,Ldc:7,wic:8,Ouc:9,qzc:10,Bzc:11,pDc:12,qDc:13,wEc:14,Qyc:15};var RPc={DEFAULT:0,RIGHT:1,LEFT:2,cF:3,wE:4},SPc={X4a:0,Wtc:1};function TPc(){T.call(this)}x(TPc,T);var UPc=null;function jW(){T.call(this)}x(jW,T);var VPc=null;jW.prototype.getTitle=function(){return V(this,1)};function kW(){T.call(this)}x(kW,T);var WPc=null;kW.prototype.getPosition=function(){return V(this,1)};kW.prototype.setPosition=function(a){W(this,1,a)};function lW(){T.call(this)}x(lW,T);var XPc=null;function mW(){T.call(this)}x(mW,T);var YPc=null;
mW.prototype.getTitle=function(){return V(this,3)};TPc.prototype.Ba=function(){var a=UPc;a||(UPc=a=Yv(TPc,{0:{name:"ChartScale",Bb:"virtualanalyst.sheets.ChartScale"},1:{name:"custom_scale",va:14,defaultValue:0,type:SPc},2:{name:"factor",va:1,type:Number}}));return a};TPc.Ba=TPc.prototype.Ba;jW.prototype.Ba=function(){var a=VPc;a||(VPc=a=Yv(jW,{0:{name:"ChartTitle",Bb:"virtualanalyst.sheets.ChartTitle"},1:{name:"title",va:9,type:String}}));return a};jW.Ba=jW.prototype.Ba;
kW.prototype.Ba=function(){var a=WPc;a||(WPc=a=Yv(kW,{0:{name:"ChartLegend",Bb:"virtualanalyst.sheets.ChartLegend"},1:{name:"position",va:14,defaultValue:0,type:RPc}}));return a};kW.Ba=kW.prototype.Ba;lW.prototype.Ba=function(){var a=XPc;a||(XPc=a=Yv(lW,{0:{name:"ChartAxis",Bb:"virtualanalyst.sheets.ChartAxis"},1:{name:"scale",va:11,type:TPc}}));return a};lW.Ba=lW.prototype.Ba;
mW.prototype.Ba=function(){var a=YPc;a||(YPc=a=Yv(mW,{0:{name:"ChartOptions",Bb:"virtualanalyst.sheets.ChartOptions"},1:{name:"h_axis",va:11,type:lW},2:{name:"v_axis",va:11,type:lW},3:{name:"title",va:11,type:jW},4:{name:"subtitle",va:11,type:jW},5:{name:"legend",va:11,type:kW},6:{name:"chart_conversation",va:8,type:Boolean}}));return a};mW.Ba=mW.prototype.Ba;function nW(){T.call(this)}x(nW,T);var ZPc=null;nW.prototype.bh=function(){return V(this,1)};function oW(){T.call(this)}x(oW,T);var $Pc=null;oW.prototype.getText=function(){return V(this,1)};oW.prototype.xr=function(){return Sv(this,1)};function pW(){T.call(this)}x(pW,T);var aQc=null;pW.prototype.getStatus=function(){return V(this,1)};pW.prototype.Ij=function(){return V(this,2)};pW.prototype.getError=function(){return V(this,9)};function qW(){T.call(this)}x(qW,T);var bQc=null;
function cQc(){T.call(this)}x(cQc,T);var dQc=null;function rW(){T.call(this)}x(rW,T);var eQc=null;rW.prototype.Ax=function(){return Sv(this,1)};rW.prototype.Ij=function(){return V(this,2)};rW.prototype.getType=function(){return V(this,3)};rW.prototype.setType=function(a){W(this,3,a)};function fQc(){T.call(this)}x(fQc,T);var gQc=null;function hQc(){T.call(this)}x(hQc,T);var iQc=null;
nW.prototype.Ba=function(){var a=ZPc;a||(ZPc=a=Yv(nW,{0:{name:"Error",Bb:"ritz.assistant.Error"},1:{name:"message",va:9,type:String},2:{name:"code",va:14,defaultValue:0,type:KPc},3:{name:"unsupported_op_reason",va:14,defaultValue:0,type:LPc}}));return a};nW.Ba=nW.prototype.Ba;
oW.prototype.Ba=function(){var a=$Pc;a||($Pc=a=Yv(oW,{0:{name:"AnswerQueryPhrase",Bb:"ritz.assistant.AnswerQueryPhrase"},1:{name:"text",va:9,type:String},2:{name:"start_byte",va:5,type:Number},3:{name:"num_bytes",va:5,type:Number}}));return a};oW.Ba=oW.prototype.Ba;
pW.prototype.Ba=function(){var a=aQc;a||(aQc=a=Yv(pW,{0:{name:"AnswerResponse",Bb:"ritz.assistant.AnswerResponse"},1:{name:"status",va:5,type:Number},10:{name:"parse_status",va:14,defaultValue:0,type:MPc},11:{name:"answer_status",va:14,defaultValue:0,type:NPc},2:{name:"formula",va:9,type:String},3:{name:"debug_parse_response",va:9,type:String},4:{name:"interpretation",va:9,type:String},5:{name:"debug_interpretation_response",va:9,type:String},6:{name:"unused_phrase",mc:!0,va:11,type:oW},7:{name:"used_entity_phrase",
mc:!0,va:11,type:oW},8:{name:"unused_entity_phrase",mc:!0,va:11,type:oW},9:{name:"error",va:11,type:nW},12:{name:"alternate_suggestion",mc:!0,va:11,type:rW},14:{name:"deprecated_formula_builder_used",va:9,type:String},15:{name:"answer_visualization_type",mc:!0,va:14,defaultValue:0,type:PPc},16:{name:"formula_builder_used",va:14,defaultValue:0,type:QPc},17:{name:"charting_info",va:11,type:cQc},18:{name:"answer_field_info",mc:!0,va:11,type:qW},19:{name:"charting_formula",va:9,type:String},21:{name:"parse_info",
mc:!0,va:11,type:fQc},22:{name:"answer_field_info_for_ranges",mc:!0,va:11,type:qW},23:{name:"va_query",va:9,type:String},24:{name:"pivot_table_def",va:11,type:Oy}}));return a};pW.Ba=pW.prototype.Ba;qW.prototype.Ba=function(){var a=bQc;a||(bQc=a=Yv(qW,{0:{name:"AnswerFieldInfo",Bb:"ritz.assistant.AnswerFieldInfo"},1:{name:"cell_data_type",va:14,defaultValue:0,type:EVa},2:{name:"range_ref",va:9,type:String}}));return a};qW.Ba=qW.prototype.Ba;
cQc.prototype.Ba=function(){var a=dQc;a||(dQc=a=Yv(cQc,{0:{name:"ChartingInfo",Bb:"ritz.assistant.ChartingInfo"},1:{name:"suggested_type",mc:!0,va:14,defaultValue:0,type:PPc},2:{name:"recommended",va:8,type:Boolean},3:{name:"user_requested_type",mc:!0,va:14,defaultValue:0,type:PPc},4:{name:"show_only_chart",va:8,type:Boolean},5:{name:"chart_options",va:11,type:mW}}));return a};cQc.Ba=cQc.prototype.Ba;
rW.prototype.Ba=function(){var a=eQc;a||(eQc=a=Yv(rW,{0:{name:"QuerySuggestion",Bb:"ritz.assistant.QuerySuggestion"},1:{name:"query",va:9,type:String},2:{name:"formula",va:9,type:String},3:{name:"type",va:14,defaultValue:0,type:OPc},4:{name:"deprecated_formula_builder_used",va:9,type:String},5:{name:"formula_builder_used",va:14,defaultValue:0,type:QPc}}));return a};rW.Ba=rW.prototype.Ba;
fQc.prototype.Ba=function(){var a=gQc;a||(gQc=a=Yv(fQc,{0:{name:"ParseInfo",Bb:"ritz.assistant.ParseInfo"},1:{name:"intent_info",mc:!0,va:11,type:hQc}}));return a};fQc.Ba=fQc.prototype.Ba;hQc.prototype.Ba=function(){var a=iQc;a||(iQc=a=Yv(hQc,{0:{name:"IntentInfo",Bb:"ritz.assistant.IntentInfo"},1:{name:"intent_type",va:14,defaultValue:0,type:JPc}}));return a};hQc.Ba=hQc.prototype.Ba;function jQc(){this.D=this.O="";this.J=!1;this.F=0;this.L=!1;this.H=0;this.C=""}jQc.prototype.getTitle=g("O");var kQc="help;how can;how do i;how do you;how do u;how to;what can;what does;what is this;how does this".split(";"),lQc=[{Zj:["Thank you","Thankyou","Thanks"],zq:"No problem"},{Zj:["you are amazing","This is great","omg"],zq:"Happy to help"},{Zj:["I love you"],zq:"Must be in the air"},{Zj:["How do you know","How are you so smart"],zq:"It's all in the data"},{Zj:["Are you sure"],zq:"Send feedback if this doesn't seem correct to help improve accuracy"},{Zj:["How are you"],zq:"Pretty good, thanks"},
{Zj:["Hi","Hello","Hey"],zq:"Hi, there. Try asking a question about your data."},{Zj:["You are stupid","This is dumb","You are wrong"],zq:"Help improve this experience by sending feedback"},{Zj:["How smart are you"],zq:"Pretty smart"}];function mQc(a){for(var b=0;b<lQc.length;++b)if(-1!=$a(lQc[b].Zj,function(b){return Gb(a,b)}))return b;return-1};function nQc(a,b,c,d){var e=new YNc;G(e,2,c);z(b,function(a){Rf(e,1).push(a)});G(e,3,d);d=new QV;G(d,1,a);G(d,3,b[c]);Vf(d,11,e);return d}function oQc(a,b,c,d){var e=new UNc;G(e,2,c);z(b,function(a){Rf(e,1).push(a)});G(e,3,d);d=new QV;G(d,1,a);G(d,2,b[c]);Vf(d,10,e);return d}function pQc(a){var b=new SNc;z(a,function(a){var c=a.type;Rf(b,1).push(c);a.hGa&&(a=a.hGa,Rf(b,2).push(a))});return b}function qQc(a){var b=new WNc;z(a,function(a){a=a.type;Rf(b,1).push(a)});return b}
function rQc(a,b,c,d){var e=new $Nc;a&&G(e,1,a);b&&G(e,2,b);for(a=0;a<c.length;a++)b=c[a],Rf(e,3).push(b);G(e,4,d);return e};function sW(a,b){this.D=a;this.C=b}sW.prototype.getChartType=g("D");var tW={2:new sW("ColumnChart","Column chart"),3:new sW("LineChart","Time series"),4:new sW("ScatterChart","Scatter chart"),5:new sW("PieChart","Pie chart"),10:new sW("Histogram","Histogram"),7:new sW("LineChart","Line chart")};function uW(a,b,c,d,e,f,h,k){this.D=a;this.gW=b;this.H=(void 0===h?null:h)||b;this.C=d;this.iq=c;this.cb=d?Wv(d,6):[];this.gb=d?Wv(d,7):[];this.Va=d?Wv(d,8):[];this.error=e||1;this.interpretation=d&&Sv(d,4)?V(d,4):null;this.ma=new jQc;this.O=d?Wv(d,12):[];this.Na=d?Wv(d,21):[];this.Aa=f;this.hb=null!=k?k:KI(f.C);this.F=null;this.$=this.J=!1;this.L=[];this.V=null;sQc(this)}function tQc(a){return 1==a.error&&null!=a.iq}
function uQc(a){return{cN:vQc(a),interpretation:a.interpretation,gW:a.gW,iq:a.iq,nM:1<a.gW.length&&1<a.gW[0].length,Lj:a.Lj(),rYb:a.$,Tz:a.Tz(),RKb:a.L}}uW.prototype.Lj=function(){return null!=this.F&&(this.F in tW?!0:!1)&&2<this.H.length};uW.prototype.Tz=function(){return J(H(),"feapt")&&null!==this.C&&Sv(this.C,24)};uW.prototype.getChartType=function(){if(!this.Lj())return null;var a=this.F;if(a in tW)return tW[a].getChartType();throw Error("Unknown chart type.");};
function wQc(a){a.Lj();return a.H[0][0]}function xQc(a){a.Lj();return a.H[0][1]||""}function yQc(a){return Va(Wv(a.C,22),function(b){if(V(b,2)){var c=a.Aa.C,d=XA(c,a.hb);return EE(V(b,2),c,!1,!1,d)}},a)}function zQc(a){return{cN:vQc(a),error:AQc(a)}}function BQc(a,b,c){var d=c.length;if(0==d)return a;1<d&&jb(a,10);c=V(c[0],1);2<d&&9==c&&jb(a,4);2<d&&jb(a,5);2!=c&&3!=c&&12!=c&&jb(a,3);bb(b,10)&&bb(a,10)&&Aaa(a,function(a){return 10!=a});return a}
function sQc(a){var b=null;a.J=!1;a.F=null;if(a.C&&Sv(a.C,17)){var c=V(a.C,17);a.$=V(c,4)||!1;var d=Wv(c,3),e=BQc(Wv(c,1),d,Wv(a.C,18));0<d.length&&(0==e.length||1>=a.H.length||1>a.H[0].length)?a.L.push("Charts for this question are not supported."):(0<d.length?(b=Ua(e,function(a){return bb(d,a)}),c=Ua(d,function(a){return!bb(e,a)}),jb(c,6),0<b.length?(a.J=!0,a.F=b[0],b=a.F):bb(d,10)&&bb(e,2)?(a.J=!0,a.F=2,jb(c,10),b=a.F):(b=0<c.length?c[0]:6,a.J=!0,a.F=CQc(a,e)),0<c.length&&a.L.push("Requested chart type is not supported for this question.")):
0<e.length&&1<a.H.length&&1<a.H[0].length&&(a.F=CQc(a,e),a.J=V(c,2)||!1,20<=a.H.length||3<=a.H[0].length)&&(a.J=!0),a.V=rQc(a.F,b,e,a.J))}}function CQc(a,b){if(!Wv(a.C,18).length)return b[0];a=DQc(a);a=ritz_api.AssistantApi.getAnswersChartsRecommedation(a.toJSON());for(var c=0;c<a.length;c++)if(bb(b,a[c]))return a[c];return b[0]}function EQc(a,b,c){var d={};null!=b?(d.v=FQc(a,b,c),d.f=b):d.v=null;return d}
function DQc(a){for(var b=new XH,c=a.H[0],d=qb(a.H,1),e=Wv(a.C,18),f=[],h=0;h<c.length;h++)null!=e[h]&&Sv(e[h],1)?f.push(GQc(V(e[h],1))):f.push(0==h?"string":"number"),b.oq({type:f[h],label:c[h]||"",id:"Axis"+h});for(e=0;e<d.length;++e){h=[];for(var k=0;k<c.length;k++)h.push(EQc(a,d[e][k],f[k]));b.Gt(h)}return b}
function FQc(a,b,c){switch(c){case "boolean":return"true"==b.toLowerCase()||"1"==b;case "number":return a=a.Aa.L.F,b=(b||"0").replace(new RegExp("[^-0-9"+a+"]","g"),""),b=b.replace(a,"."),ec(b);case "date":case "datetime":return new Date(b);case "timeofday":if(b){a=b.replace(/[^a-zA-Z0-9]/g," ").split(" ");c=[0,0,0,0];if(!(2>a.length)&&Lb(a[0])&&Lb(a[1])&&(Lb(a[a.length-1])||"am"==a[a.length-1].toLowerCase()||"pm"==a[a.length-1].toLowerCase())){for(var d=0;d<b.length&&4>d;d++)Lb(a[d])&&(c[d]=ec(a[d]));
"am"==a[a.length-1].toLowerCase()&&12==c[0]&&(c[0]=0);"pm"==a[a.length-1].toLowerCase()&&12!=c[0]&&(c[0]+=12)}b=c}else b=[0,0,0,0];return b;default:return b||""}}function GQc(a){switch(a){case 1:return"boolean";case 9:return"number";case 2:return"date";case 3:return"datetime";case 12:return"timeofday";default:return"string"}}
function HQc(a){if(!Sv(a.C,9))return"";if(Sv(a.C.getError(),3))switch(V(a.C.getError(),3)){case 1:return"Sorry, questions related to formatting are not supported at this time.";case 2:return"Answers provides formulas based on your data. Charts are currently not supported. Please use the menus to create a chart.";case 3:return"Sorry, this action is not supported at this time.";case 4:return"Sorry, this function is not supported at this time.";case 5:return"Sorry, your question is too generic. Please ask a more specific question.";
default:return"Sorry, this function is not supported at this time."}return a.C.getError().bh()||""}
function AQc(a){switch(a.error){case 2:return"Looks like you are offline. Try again when you reconnect.";case 3:return"There was a problem getting your answer at this time. Please try again later.";case 4:return"Sorry, couldn't understand your question.";case 5:return"Answers lets you ask question and learn more about your data.";case 6:return HQc(a)||"Sorry, couldn't understand your question.";case 7:return a=mQc(a.D),-1!=a?lQc[a].zq:""}return""}
function vQc(a){var b=[];if(tQc(a)){var c=[];z(nb(a.cb,a.Va),function(a){c.push(IQc(a,"waffle-assistant-answercard-question-unused-phrase"))});z(a.gb,function(a){c.push(IQc(a,"waffle-assistant-answercard-question-used-entity"))});vb(c,function(a,b){return a.tU>b.tU?1:-1});var d=0;z(c,function(c){var e=c.length,h=c.tU;h>d?b.push({text:a.D.substring(d,h),className:null}):(e-=d-h,h=d);0<e&&(d=h+e,b.push({text:a.D.substring(h,d),className:c.Jk}))});d<a.D.length&&b.push({text:a.D.substring(d),className:null})}else b.push({text:a.D,
className:null});return b}function IQc(a,b){return{tU:V(a,2),length:V(a,3),Jk:b}};function JQc(a,b,c){return P('<div class="waffle-assistant-answers-card-remove">'+O(Ls({icon:"docs-icon-img docs-icon-trash"},c||b))+"</div>")}
function KQc(a,b){var c=a.error;a=a.showHelp;b='<div class="waffle-assistant-answercard-error-container"><div class="waffle-assistant-answercard-error-image">'+O(Ls({icon:"docs-icon-img docs-icon-unsupported-black"},b))+'</div><div class="waffle-assistant-errorcard-content">';a?(b+='<div class="waffle-assistant-errorcard-text">',c=O(c)+' Look in <div class="waffle-assistant-answers-helpcenter-link">Sheets help</div> instead?',b=b+c+"</div>"):b+='<div class="waffle-assistant-errorcard-text">'+O(c)+
"</div>";return P(b+"</div></div>")};function LQc(a,b,c){b=c||b;c=P;var d='<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content">'+MQc({cN:a.tB.cN}),e=a.tB.gW;var f=a.tB.iq;var h=a.tB.interpretation,k=a.tB.nM,l=a.tB.Lj,m=a.tB.Tz,r=a.tB.rYb;a=a.tB.RKb;null==e||va(e);va(a);h=h={interpretation:h};h=h.interpretation;var u='<div class="waffle-assistant-answercard-answer-header" role="heading" aria-label="'+zr("Answer");u=u+'"><span aria-hidden="true">Answer'+("</span></div>"+(h?'<div class="waffle-assistant-answercard-interpret-content"><div class="waffle-assistant-answercard-interpret">'+
O(h)+"</div></div>":""));var w='<div class="waffle-assistant-answercard-answer-container">'+P(u)+'<div class="waffle-assistant-answercard-answer-content">';if(e){if(!r)if(l&&(w+='<div class="waffle-assistant-answercard-tabs"><div class="waffle-assistant-answercard-formula-tab">FORMULA</div><div class="waffle-assistant-answercard-pivot-tab" id="waffle-assistant-answercard-pivot-tab">PIVOT TABLE</div><div class="waffle-assistant-answercard-chart-tab" id="waffle-assistant-answercard-chart-tab">CHART</div></div>'),
m)w+='<div class="waffle-assistant-answercard-pivot-content"></div>';else{w+='<div class="waffle-assistant-answercard-answer">';if(k){w+='<div class="waffle-assistant-answercard-answer-rowheader">';r=e[0];h=r.length;for(u=0;u<h;u++)w+='<span class="waffle-assistant-answercard-answer-col">'+O(r[u])+"</span>";w+="</div>"}w+='<div class="waffle-assistant-answercard-answer-rows">';r=vr("waffle-assistant-answercard-answer-row"+(k?" waffle-assistant-answercard-answer-list-row":""));h=e.length;for(u=0;u<
h;u++){var y=e[u];if(k&&0==u)y="";else{var B=r;va(y);B='<div class="'+Q(B)+'">';for(var I=y.length,S=0;S<I;S++){var Y=y[S];Y?B+='<span class="waffle-assistant-answercard-answer-col">'+O(Y)+"</span>":(B+='<span class="'+Q("waffle-assistant-answercard-answer-col waffle-assistant-answercard-answer-empty")+'">',B+="N/A",B+="</span>")}y=P(B+"</div>")}w+=y}w+="</div></div>"}w+=l?'<div class="waffle-assistant-answercard-chart-container"><div class="waffle-assistant-answercard-chart-type-select"></div><div class="waffle-assistant-answercard-chart"></div></div>':
""}if(0<a.length){w+='<div class="waffle-assistant-answercard-info-msgs">';e=a.length;for(k=0;k<e;k++)w+='<div class="waffle-assistant-answercard-info-msg">* '+O(a[k])+"</div>";w+="</div>"}w+='<div class="waffle-assistant-answercard-footer">';m&&(w+='<div class="waffle-assistant-answercard-insert-pivot">INSERT PIVOT TABLE</div>');l&&(w+='<div class="waffle-assistant-answercard-insert-chart">INSERT CHART</div>');m||(w=w+'<div class="waffle-assistant-answercard-formula-holder"><div class="waffle-assistant-answercard-see-formula-link">See formula</div><div class="waffle-assistant-answercard-hide-formula-link">Hide formula</div><div class="waffle-assistant-answercard-formula"><div class="waffle-assistant-answercard-formula-help">Click to copy or drag to insert'+
('</div><div class="waffle-assistant-answercard-formula-display"><div class="waffle-assistant-answercard-formula-icon">'+O(Ls({icon:"docs-icon-img docs-icon-insert-formula"},b))+'</div><div class="waffle-assistant-answercard-formula-text-container"><div class="waffle-assistant-answercard-formula-text" tabindex="0">'+O(f)+"</div></div></div></div></div>"));f=P(w+"</div></div></div>");return c(d+f+"</div></div>")}
function MQc(a){va(a.cN);a=a.cN;var b='<div class="waffle-assistant-answercard-question-container"><div class="waffle-assistant-answercard-question-header" role="heading" aria-label="'+zr("Question");b+='"><span aria-hidden="true">Question</span></div><div class="waffle-assistant-answercard-question-content"><div class="waffle-assistant-answercard-question">';for(var c=a.length,d=0;d<c;d++){var e=a[d];b+=e.className?'<span class="'+Q(e.className)+'">'+O(e.text)+"</span>":O(e.text)}return P(b+"</div></div></div>")}
function NQc(a,b,c){b=c||b;a=a.Tz;return P(O(JQc(null,b))+(a?'<div class="waffle-assistant-button-separator"></div>'+O(Fr({Md:"waffle-assistant-zoom-button",content:wr(""+O(Ls({icon:"docs-icon-img docs-icon-zoom-in"},b))),style:4},b)):""))};function OQc(a){this.C=a}function PQc(a,b){var c=new PV;G(c,3,b);G(c,8,!0);b=new WR;Vf(b,4,c);c=new yg;Vf(c,46,b);c=Lj(Kj(new Jj,10),c).build();a.C.Yb(2753,c)};function QQc(a,b,c,d){E.call(this);this.$=a;this.V=b;this.ma=c;this.cb=d;this.bb=new Ph(this);this.xa(this.bb);this.C=new $T;this.xa(this.C);this.O="";this.L=[];this.F=this.D=this.J=null;this.H=!1;VEc(this.C,this.$);this.C.Aa=10;this.C.rb=!0;this.C.V=!1;this.C.pUa("waffle-assistant-visible");this.C.L=Mb("waffle-assistant-dragged-formula").split(" ");this.C.init();this.bb.R(this.C,OEc,this.Na).R(this.C,REc,this.Va).R(this.C,SEc,this.Aa)}x(QQc,E);
QQc.prototype.Na=function(a){a=Sa(this.$.childNodes,a.C);this.O=this.L[a]};
QQc.prototype.Va=function(a){var b=a.event instanceof xq?a.event.Ki:a.event;this.H?(a.H.px(b,!0),a.preventDefault()):(di(a.F,a.event.clientX,a.event.clientY),a=ei(a.F),b=TE(this.V).C,Uh(JK(b,"page",!1,!1)).contains(a)?(a=HK(b,a.x,a.y,"page"),(b=eG(LI(this.ma),a.y,a.x))?a=new Ed(b.yc(),b.zc()):b=Kx(a),this.J=a,this.D&&this.D.getRect().equals(b)||(a=TE(this.V),C(this.D),this.D=nxc(a,b,"waffle-assistant-formula-insertion-rect"),this.xa(this.D),yM(a.V,"default",this.D),C(this.F),this.F=WL(a,b,"waffle-assistant-formula-insertion-border",
2,0),this.xa(this.F),bMb(this.F,"#000"),this.F.setVisible(!0))):RQc(this))};QQc.prototype.Aa=function(a){if(this.J){OM(TE(this.V),!1);var b=this.J,c=LI(this.ma);b=new fN(c,b,this.O);this.cb.C(b);this.dispatchEvent(new D("formula_inserted"))}a.H.px(null,!0);a.preventDefault();this.O="";RQc(this)};function RQc(a){a.J=null;C(a.D);a.D=null;C(a.F);a.F=null};function vW(a,b,c,d,e,f,h,k,l,m,r,u,w){bW.call(this,new nH,w);this.F=a;this.Kd=yQc(a);this.Mb=a.Lj();this.Aa=a.Tz();this.Rf=r;this.L=this.C=this.Eb=null;this.yb=a.Lj()&&a.J;this.Bf=a.$;this.Ob=!1;this.Kg=b;this.qf=c;this.Se=d;this.Ai=l;this.Th=h;this.$=e;this.Tg=f;this.Lg=k;this.Ye=m;this.Le=Kj(new Jj,10).build();this.$d=new pr("",new WV,this.qa());this.Qa(this.$d);this.Zg=u;this.sb=new pr("",new WV,this.qa());this.Qa(this.sb);this.Jb=new pr("",new WV,this.qa());this.Qa(this.Jb);this.Na=null;this.V=
new pr("",new WT,this.qa());this.Qa(this.V);this.D=a.ma;this.hb=new pr("",new WT,this.qa());this.Qa(this.hb);this.Cb=new pr("",new WV,this.qa());this.Qa(this.Cb);this.ma=new PS;this.Qa(this.ma);this.gb=new CM("");this.Qa(this.gb);this.Zc=new $v;this.J=null;this.gc=2;this.Jc=DQc(this.F);this.ld=new XT(b,"waffle-assistant-answers-range-styled-border","waffle-assistant-answers-range-styled-rect");this.xa(this.ld);this.yd=!1}x(vW,bW);p=vW.prototype;p.tja=g("Lg");
p.Ma=function(){vW.oa.Ma.call(this);dW(this).appendChild(N(NQc,{Tz:this.Aa}))};
p.Wa=function(){vW.oa.Wa.call(this);var a=this.$a("waffle-assistant-answers-card-remove");this.$d.Ab(a);ZV(a,"Remove card",0);this.getHandler().Wc(this.$d,"action",this.e0b);if(this.F.Tz()){a=this.Kd[0]?this.Kd[0].bd:LI(this.qf).rc();var b=this.F;b.Tz();b=b.C?V(b.C,24):null;var c=FEc(this.Zg,b);this.Eb=new IEc(c,b,this.Ai.L.C,this.Rf,a,this.Se)}else this.getHandler().R(this.V,"action",this.$Eb).R(this.hb,"action",this.nwb).Wc(this.V,"action",this.LOa).Wc(this.hb,"action",this.EMb)};
function SQc(a){function b(b,d,e,f){var c=new NS("");c.Ab(a.$a(b));a.ma.Qa(c);a.getHandler().Wc(c,"action",v(a.BMb,a,d));f||c.setVisible(!1);e&&f&&a.ma.uN(c)}a.ma.Ab(a.$a("waffle-assistant-answercard-tabs"));a.getHandler().R(a.ma,"select",a.BHb);b("waffle-assistant-answercard-formula-tab",0,!a.yb,!a.Aa);b("waffle-assistant-answercard-pivot-tab",1,!a.yb,a.Aa);b("waffle-assistant-answercard-chart-tab",2,a.yb,!0)}
function TQc(a){var b=V(a.F.C,17);b=Wv(b,1);for(var c=0;c<b.length;c++)a.gb.Fd(UQc(b[c]));a.gb.Ab(a.$a("waffle-assistant-answercard-chart-type-select"));Wr(a.gb,UQc(a.F.F));b=a.$a("waffle-assistant-answercard-insert-chart");a.Cb.Ab(b);VQc(a);a.getHandler().R(a.Cb,"action",a.c0b).R(a.gb.Cc(),"action",a.hqb)}
p.zy=function(a){cW(this).appendChild(N(LQc,{tB:uQc(this.F)}));if(this.F.Tz()){this.Mb&&(SQc(this),TQc(this));var b=this.$a("waffle-assistant-answercard-insert-pivot");this.sb.Ab(b);b=this.$a("waffle-assistant-zoom-button");this.Jb.Ab(b);ZV(b,"Preview Pivot Table");this.getHandler().R(this.sb,"action",this.d0b).R(this.Jb,"action",this.oXa);WQc(this);b=this.qa();this.C=b.Ma("CANVAS","waffle-pivottable-pivot-canvas");b.Ak(this.C,!0);Eh(this.C,"Pivot table canvas");b=this.$a("waffle-assistant-answercard-pivot-content");
this.qa().appendChild(b,this.C);this.getHandler().yg(this.C,gf,this.oXa);KEc(this.Eb,this.C);this.gc=this.yb?1:3}else this.V.Ab(this.$a("waffle-assistant-answercard-see-formula-link")),this.hb.Ab(this.$a("waffle-assistant-answercard-hide-formula-link")),this.Na=new QQc(this.$a("waffle-assistant-answercard-formula-text-container"),this.Kg,this.qf,this.Se),b=this.Pd(),this.Na.H=b,this.Na.L=[this.F.iq],this.xa(this.Na),b=this.$a("waffle-assistant-answercard-formula-text"),Eh(b,"Formula: "+(this.F.iq+
". Click/Press ENTER to copy or drag to insert on to sheet.")),this.getHandler().Wc(this.Na,"formula_inserted",this.DMb).yg(this.$a("waffle-assistant-answercard-formula-text"),gf,this.wvb),XQc(this,this.Ye),YQc(this),this.Ye&&(ZQc(this,!0),this.getHandler().Rc(this.V,"action",this.LOa)),this.Mb&&(this.Bf?($Qc(this,this.F.getChartType()),this.Ob=!0):SQc(this),TQc(this),this.gc=1);a()};function aRc(a){return J(H(),"feepts")&&J(H(),"feapp")&&a.Aa}
function UQc(a){if(a in tW)return new Ek(tW[a].C,a);throw Error("Unknown chart type.");}p.hqb=function(a){a=a.target.ub();if(a in tW)$Qc(this,tW[a].getChartType());else throw Error("Unknown chart type model.");};
function bRc(a,b){a.D.D&&b.setSubtitle(a.D.D);var c=b.getAxis(ritz.charts.model.AxisName.X);c&&(c.setLogScale(a.D.J),a.D.F&&c.setScaleFactor(a.D.F));if(c=b.getAxis(ritz.charts.model.AxisName.Y))c.setLogScale(a.D.L),a.D.H&&c.setScaleFactor(a.D.H);if(a.D.C){c=0;switch(a.D.C.toLowerCase()){case "none":c=0;break;case "left":c=3;break;case "right":c=4;break;case "top":c=1;break;case "bottom":c=2;break;case "in":c=5;break;case "labeled":c=6}b.setLegendPositionType(c)}}
function cRc(a,b){a.D.D&&b.setOption("subtitle",a.D.D);b.setOption("hAxis.logScale",a.D.J);b.setOption("vAxis.logScale",a.D.L);a.D.C&&b.setOption("legend.position",a.D.C);a.D.F&&b.setOption("hAxis.formatOptions.scaleFactor",a.D.F);a.D.H&&b.setOption("vAxis.formatOptions.scaleFactor",a.D.H)}
function $Qc(a,b){if(ritz_api.ChartsApi){a.J=new fH;var c=new Vz;W(a.J,28,c);var d=new Rz;W(c,10,d);W(a.J,1,b);d.setType(ritz.charts.model.GvizChartUtil.toChartTypeOrdinal(b));var e=a.F.interpretation||"";W(a.J,2,e);var f=new gz;W(d,5,f);var h=new fz;W(f,1,h);RV(h,e);e=new Iz;W(d,7,e);d=new xz;W(e,1,d);f=new wz;W(d,1,f);d=new fz;W(f,1,d);f=new xz;W(e,2,f);e=new wz;W(f,1,e);f=new fz;W(e,1,f);"Histogram"===b?(DNc(a.J,wQc(a.F)),RV(d,wQc(a.F)),ENc(a.J,"Count"),RV(f,"Count")):"LineChart"===b||"ColumnChart"===
b?(e=0,"number"!=a.Jc.xd(0)&&(DNc(a.J,a.Jc.Sf(0)),RV(d,a.Jc.Sf(0)),e=1),1==a.Jc.getNumberOfColumns()-e?(ENc(a.J,a.Jc.Sf(e)),RV(f,a.Jc.Sf(e))):(ENc(a.J,"Values"),RV(f,"Values"))):(DNc(a.J,wQc(a.F)),RV(d,wQc(a.F)),ENc(a.J,xQc(a.F)),RV(f,xQc(a.F)));d=new cA;c.Df(d);Twc(d,a.Jc.toJSON());W(d,2,"0.6");d=a.$a("waffle-assistant-answercard-chart");J(H(),"fecpmr")?(f=dRc(a,c),fPc(f),bRc(a,f),f.setTitle(a.D.getTitle())):(e=aPc(a.J),e.Df(a.Jc),e=bPc(e),kT(e,e.le()),cRc(a,e),e.setOption("title",a.D.getTitle()),
h=(f=e.le())?f.toJSON():null,f=new ritz.charts.model.GvizChart,f.updateChartWrapperJsonString(e.toJSON()),h&&f.updateDataTableJsonString(h));WDc(f,d,a.Rf.C,a.$,void 0,void 0,c);a.Ob=!0}else ritz_api.RitzEntryPoint.loadChartsApi(function(){$Qc(a,b)})}function dRc(a,b){var c=new ritz.charts.model.ChartImpl;c.setChartModel(a.Zc.serialize(b.bx()));a=ritz_api.ChartsApi.createChartDataSource(a.Zc.serialize(b));c.setChartDataSource(a);c.setHasLabels(1<a.getColumnCount());return c}
p.d0b=function(){JEc(this.Eb);this.dispatchEvent("close-sidebar");this.$.C(35619,Kj(new Jj,67).build())};p.oXa=function(){var a=Kj(new Jj,67).build();this.$.C(35620,a);this.getHandler().Rc(this.L,"pd",this.nXa).Rc(this.L,"qd",this.mXa);C(this.L);this.L=new MEc(this.Eb,this.F.interpretation||"",this.$,a,35621,this.qa());this.getHandler().R(this.L,"pd",this.nXa).R(this.L,"qd",this.mXa);this.L.render();this.xa(this.L);NNc(this.L,this.Pd())};p.nXa=function(){this.C.focus()};p.mXa=function(){this.dispatchEvent("close-sidebar")};
p.c0b=function(){if(this.J)if(J(H(),"fecpmr")){var a=V(this.J,28),b=dRc(this,a);bRc(this,b);this.D.getTitle()&&b.setTitle(this.D.getTitle());this.dispatchEvent(new ZOc(b,a,this.O,2874,void 0,void 0,eRc(this)))}else a=aPc(this.J),a.Df(this.Jc),cRc(this,a),this.D.getTitle()&&a.setOption("title",this.D.getTitle()),kT(a,a.le()),this.dispatchEvent(new FOc(a,this.O,this.Jc,2874,void 0,void 0,eRc(this)))};p.yy=function(){Eh(this.qb(),"Answer Card for question: "+this.F.D)};p.OA=Ke;p.xz=n("assistantAnswersFeedback");
p.hC=n(2628);p.gC=n(2627);p.W6=n("Was this answer correct?");p.pka=n("Correct");p.oka=n("Incorrect");p.cO=g("F");p.Ct=function(a){vW.oa.Ct.call(this,a);this.Na&&(this.Na.H=a);this.L&&NNc(this.L,a);YQc(this);VQc(this);WQc(this)};p.JL=function(){vW.oa.JL.call(this);this.yd||(MNc(this.ld,this.Kd),this.yd=!0)};p.eH=function(){vW.oa.eH.call(this);ZT(this.ld);this.yd=!1};
p.BHb=function(){var a=$zc(this.ma),b=1==a;if(this.Aa){this.Jb.setVisible(b);var c=this.qa().$a("waffle-assistant-button-separator",dW(this));L(c,b)}b=2==a;L(this.$a("waffle-assistant-answercard-chart-container"),b);this.Aa?L(this.$a("waffle-assistant-answercard-pivot-content"),!b):(L(this.$a("waffle-assistant-answercard-answer"),!b),L(this.$a("waffle-assistant-answercard-formula-holder"),!b));VQc(this);!this.Ob&&b&&$Qc(this,this.F.getChartType());switch(a){case 1:WQc(this);break;case 2:WQc(this)}};
function YQc(a){var b=a.Kb("waffle-assistant-answercard-formula-help");b&&L(b,!a.Pd())}function VQc(a){var b=(a.Bf||2==$zc(a.ma))&&!a.Pd();a.Cb.setVisible(b)}function WQc(a){var b=a.Aa&&!a.Pd()&&(!a.Mb||1==$zc(a.ma));a.sb.setVisible(b)}function XQc(a,b){a.V.setVisible(!b);a.hb.setVisible(b);L(a.$a("waffle-assistant-answercard-formula"),b);b?a.$a("waffle-assistant-answercard-formula-text").focus():(a.V.qb().focus(),a.V.Pp(!0))}p.e0b=function(){PQc(this.Tg,!0);this.dispatchEvent(new D("rc"))};
p.$Eb=function(){XQc(this,!0)};p.nwb=function(){XQc(this,!1)};p.LOa=function(){ZQc(this,!0)};p.EMb=function(){ZQc(this,!1)};function ZQc(a,b){var c=new PV;G(c,9,b);b=new WR;Vf(b,4,c);c=new yg;Vf(c,46,b);c=Lj(Kj(new Jj,10),c).build();a.$.Yb(2849,c)}p.BMb=function(a){var b=this.F.V,c=new aOc;Vf(c,1,b);switch(a){case 0:G(c,2,2);break;case 1:G(c,2,3);break;case 2:G(c,2,1);break;default:G(c,2,0)}a=new PV;Vf(a,10,c);c=new WR;Vf(c,4,a);a=new yg;Vf(a,46,c);c=Lj(Kj(new Jj,10),a).build();this.$.Yb(2850,c)};
function eRc(a){var b=a.F.F;a=new bOc;G(a,1,b);b=new PV;Vf(b,11,a);a=new WR;Vf(a,4,b);b=new yg;Vf(b,46,a);return b}p.DMb=function(){this.$.Yb(2709,this.Le)};p.wvb=function(){var a=this.qa().Vb(),b=a.createElement("textarea");b.textContent=this.F.iq;b.style.position="fixed";a.body.appendChild(b);b.select();var c=!1;try{c=a.execCommand("copy")}catch(d){}finally{a.body.removeChild(b)}c&&(fRc(this.Th,"Formula copied to clipboard",this.qa()),this.$.C(35534,this.Le))};function gRc(a,b,c){b=c||b;return P('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content">'+O(MQc({cN:a.nFa.cN}))+O(KQc({error:a.nFa.error,showHelp:a.showHelp},b))+"</div></div>")}function hRc(){return P('<div class="waffle-assistant-answercard-feedback-container"><div class="waffle-assistant-answercard-feedback-link">Send feedback</div></div>')};function wW(a,b,c,d,e){bW.call(this,new nH,e);this.F=a;this.V=b;this.L=d;this.$=c;this.J=new pr("",new WV,this.qa());this.Qa(this.J);this.C=new pr("",new WT,this.qa());this.Qa(this.C);this.D=new pr("",new WT,this.qa());this.Qa(this.D)}x(wW,bW);p=wW.prototype;p.yy=function(){Eh(this.qb(),"Error Card for question: "+this.F.D)};p.xz=n("assistantAnswersFeedback");p.OA=Ke;p.T8=Je;p.Ct=function(a){wW.oa.Ct.call(this,a)};p.Ma=function(){wW.oa.Ma.call(this);dW(this).appendChild(N(JQc))};
p.Wa=function(){wW.oa.Wa.call(this);var a=this.$a("waffle-assistant-answers-card-remove");this.J.Ab(a);this.D.setVisible(this.L);ZV(a,"Remove card",0);this.getHandler().Wc(this.J,"action",this.k0b).Wc(this.C,"action",this.mFb).R(this.D,"action",this.j0b)};
p.zy=function(a){cW(this).appendChild(N(gRc,{nFa:zQc(this.F),showHelp:this.L}));if(uA){var b=N(hRc);this.qa().appendChild(this.qb(),b);this.C.Ab(this.$a("waffle-assistant-answercard-feedback-link"))}this.L&&this.D.Ab(this.$a("waffle-assistant-answers-helpcenter-link"));a()};p.tja=g("V");p.cO=g("F");p.mFb=function(){this.C.setVisible(!1);L(this.$a("waffle-assistant-answercard-feedback-container"),!1);this.dispatchEvent(new D("trigger_feedback"))};p.k0b=function(){PQc(this.$,!1);this.dispatchEvent(new D("rc"))};
p.j0b=function(){K.$n.$b()};function iRc(a){bW.call(this,new nH,a);this.C=this.qa().createElement("div");se(this.C,"Previous")}x(iRc,bW);p=iRc.prototype;p.yy=function(){Eh(this.qb(),"Previous questions below")};p.Ma=function(){iRc.oa.Ma.call(this);Jh(this.qb(),"waffle-assistant-card");Hh(this.qb(),"waffle-assistant-answers-previousheadercard")};p.zy=function(a){0<this.qa().Oh(cW(this)).length||cW(this).appendChild(this.C);a()};p.T8=Je;p.xz=n("assistantAnswersFeedback");function jRc(a,b,c){b=c||b;c=""+(a.W5?O(KQc({error:a.W5,showHelp:a.showHelp},b)):"")+(a.title?'<div class="waffle-assistant-suggestionscard-header">'+O(a.title)+"</div>":"");var d=vr("Suggested question");c+='<div class="waffle-assistant-suggested-questions">';a=a.uw;for(var e=a.length,f=0;f<e;f++){var h=a[f];c+='<div class="waffle-assistant-answercard-question-container" tabindex="0"><div class="waffle-assistant-answercard-question-header" role="heading" aria-label="'+Q(d)+'">'+O(Ls({icon:"docs-icon-img docs-icon-help"},
b))+'</div><div class="waffle-assistant-answercard-question-content"><div class="waffle-assistant-answercard-question">'+O(h)+"</div></div></div>"}return P(c+"</div>")};function xW(a,b,c,d,e,f){bW.call(this,a,f);this.C=e||null;this.V=b;this.D=d;this.$=c;this.L=this.C?5==this.C.error:!1;this.F=new pr("",new WT,this.qa());this.Qa(this.F);this.J=new pr("",new WV,this.qa());this.Qa(this.J)}x(xW,bW);p=xW.prototype;p.Ma=function(){xW.oa.Ma.call(this);this.OA()&&dW(this).appendChild(N(JQc))};
p.Wa=function(){xW.oa.Wa.call(this);Hh(this.qb(),"waffle-assistant-answers-suggestioncard");this.F.setVisible(this.L);this.getHandler().R(this.F,"action",this.l0b);if(this.OA()){var a=this.$a("waffle-assistant-answers-card-remove");this.J.Ab(a);ZV(a,"Remove card",0);this.getHandler().Wc(this.J,"action",this.m0b)}};p.hC=function(){return bb([kRc,lRc],this.D)?2799:bb([mRc,nRc],this.D)?2801:null};p.gC=function(){return bb([kRc,lRc],this.D)?2798:bb([mRc,nRc],this.D)?2800:null};p.W6=n("Were these interesting?");
p.pka=n("Interesting");p.oka=n("Not interesting");p.xz=n("assistantAnswersFeedback");p.OA=function(){return this.C?!tQc(this.C):!1};p.yy=function(){var a=this.D.title;a&&this.C?(a=(AQc(this.C)||"")+(" "+(a+(" for question : "+this.C.D))),Eh(this.qb(),a)):Eh(this.qb(),"Suggested questions")};
p.zy=function(a){var b=this;this.$.then(function(c){if(b.Sb()){if(0==c.length)L(b.qb(),!1);else{var d=b.qa(),e=cW(b);if(0==d.Oh(e).length){var f=N(jRc,{title:b.D.title,uw:Va(c,function(a){return a.query}),W5:b.C?AQc(b.C):"",showHelp:b.L});e.appendChild(f);var h=Va(c,function(a){return a.type});e=b.Ti("waffle-assistant-answercard-question-container");z(e,function(a,e){var f=new pr("",new WV,d);b.Qa(f);f.Ab(a);b.getHandler().R(f,"action",v(b.lHb,b,c[e],h,e))});b.L&&b.F.Ab(b.$a("waffle-assistant-answers-helpcenter-link"))}}a()}})};
p.m0b=function(){PQc(this.V,!1);this.dispatchEvent(new D("rc"))};p.lHb=function(a,b,c){this.dispatchEvent(new iOc(this.D.P1,a.iq||null,b,c,this.D.IW,a.query))};p.l0b=function(){K.$n.$b()};var oRc={title:"",IW:0,P1:null},kRc={title:"",IW:5,P1:1},lRc={title:"Suggested questions",IW:5,P1:1},nRc={title:"Did you mean?",IW:2,P1:4},mRc={title:"Related questions",IW:4,P1:4};function pRc(a){var b=[];if(Sv(a,25)&&(a=V(a,25)))for(var c=0;c<Tv(a,1);c++){var d=V(a,1,c);if(Sv(d,2)){var e=V(d,2);e&&b.push(qRc(e,rRc(d)))}}return b}function sRc(a){var b=pRc(a);Sv(a,6)&&(a=V(a,6))&&b.push(qRc(a,0));return b}function rRc(a){return(a=Sv(a,4)?V(a,4):0)?a:0}function qRc(a,b){return{name:a,U6a:b}};function tRc(a,b,c){this.Aa=a;this.Na=b;this.L=[];this.O=[];this.H=[];this.J=[];this.$=[];this.ma=[];this.C={};this.F={};this.V={};this.D={};uRc(this,c)}function vRc(a,b){return a[b]?a[b].values.Bd():[]}
function uRc(a,b){for(var c=new Nm,d=new Nm,e=0;e<b.length;e++){for(var f=sRc(b[e]),h=[],k=[],l=0;l<f.length;l++){var m=f[l].name.toLowerCase();if(void 0!=a.Aa[m]){var r=a.Aa[m];c.add(r);h.push(r)}void 0!=a.Na[m]&&(m=a.Na[m],d.add(m),k.push(m))}wRc(a,h,k)}a.L=c.Bd();a.O=d.Bd();vb(a.L);vb(a.O);a.H=Va(oc(a.C),function(a){return a.key});vb(a.H);a.J=Va(oc(a.F),function(a){return a.key});vb(a.J);a.$=Va(oc(a.V),function(a){return a.key});vb(a.$);a.ma=Va(oc(a.D),function(a){return a.key});vb(a.ma)}
function wRc(a,b,c){for(var d=0;d<b.length;d++)for(var e=d+1;e<b.length;e++)b[d]!=b[e]&&(xRc(a.C,b[d],b[e]),xRc(a.C,b[e],b[d]));for(d=0;d<b.length;d++)for(e=0;e<c.length;e++)xRc(a.F,b[d],c[e]),xRc(a.V,c[e],b[d]);for(b=0;b<c.length;b++)for(d=b+1;d<c.length;d++)c[b]!=c[d]&&(xRc(a.D,c[b],c[d]),xRc(a.D,c[d],c[b]))}function xRc(a,b,c){var d;a[b]?d=a[b].values:d=new Nm;d.add(c);a[b]={key:b,values:d}};function yRc(a,b){this.C=a;for(var c={},d=0;d<a.zj();d++)c[TV(a,d).getName().toLowerCase()]=d;this.O=c;c={};for(d=0;d<Tv(a,1);d++)c[V(a,1,d).getName().toLowerCase()]=d;this.V=c;c={};for(d=0;d<this.C.zj();d++)c[V(TV(this.C,d),11)]=d;this.ma=c;c={};for(d=0;d<Tv(this.C,1);d++)c[V(V(this.C,1,d),4)]=d;this.Aa=c;c=[];for(d=0;d<a.zj();d++)yW(TV(a,d).getName())&&c.push(d);this.J=c;c=[];for(d=0;d<Tv(a,1);d++)yW(V(a,1,d).getName())&&c.push(d);this.L=c;c=[];for(d=0;d<Tv(a,1);d++){for(var e=V(a,1,d).getName(),
f=!0,h=0;h<zRc.length;h++)if(-1!=e.search(new RegExp("(\\b|_)"+zRc[h]+"(\\b|_)","i"))){f=!1;break}f&&c.push(d)}this.Va=c;this.gb=ARc(a,0);this.$=ARc(a,1);c=[];for(d=0;d<a.zj();d++).8<=V(TV(a,d),6)&&c.push(d);this.Na=c;c=[];for(d=0;d<a.zj();d++)e=TV(a,d),.95<=Wv(e,2).length/V(e,8)&&c.push(d);this.hb=c;c=[];for(d=0;d<Tv(a,3);d++){e=TV(a,V(a,3,d));a:if(.5<Wv(e,2).length/V(e,8)||.3>Tv(e,3)/Tv(e,2))e=!1;else{for(f=0;f<Tv(e,10);f++)if(.95<V(e,10,f)/V(e,8)){e=!1;break a}e=!0}e&&c.push(V(a,3,d))}vb(c);this.cb=
c;this.F=BRc(a.zj());this.H=BRc(Tv(a,1));this.D=new tRc(this.O,this.V,b)}function BRc(a){for(var b=[],c=0;c<a;c++)b.push(c);return b}function ARc(a,b){for(var c=[],d=0;d<a.zj();d++)TV(a,d).getType()==b&&c.push(d);return c}function CRc(a,b){if(0==a.length&&0==b.length)return[];for(var c=0<a.length?a[0]:b[0],d=1;d<a.length;d++)c=DRc(c,a[d]);for(a=0;a<b.length;a++)d=DRc(c,b[a]),c=0<d.length?d:c;return c}
function zW(a,b,c,d,e,f,h,k){var l=[a.J,a.D.L],m=[a.F];c&&(m.push(a.gb),m.push(a.Na));d&&m.push(a.cb);e&&m.push(a.hb);null!=h&&-1!=h?l.push(vRc(a.D.V,h)):f&&l.push(a.D.J);k&&l.push(a.D.H);a=CRc(m,l);b=DRc(a,b);return 0<b.length?{index:VV(b),IB:3}:0<a.length?{index:VV(a),IB:1}:ERc()}
function AW(a,b,c,d,e,f){var h=[a.L,a.D.O],k=[a.H];c&&k.push(a.Va);null!=e&&-1!=e?h.push(vRc(a.D.F,e)):d&&h.push(a.D.$);f&&h.push(a.D.ma);a=CRc(k,h);b=DRc(a,b);return 0<b.length?{index:VV(b),IB:3}:0<a.length?{index:VV(a),IB:1}:ERc()}function FRc(a,b){for(var c=5;;){var d=TV(a.C,b),e=UV(Tv(d,2),1)[0];c--;if(yW(SV(d,e))||0==c)return e}}function GRc(a,b){for(var c=5;;){var d=TV(a.C,b),e=UV(Tv(d,3),1)[0];e=V(d,3,e);c--;if(yW(SV(d,e))||0==c)return e}}
function BW(a,b){b=TV(a.C,b);a=b.getName();yW(a)||(b=HRc(Wv(b,7)),a=null==b?a:b);return a}function CW(a,b){b=V(a.C,1,b);a=b.getName();yW(a)||(b=HRc(Wv(b,2)),a=null==b?a:b);return a}function HRc(a){for(var b=0;b<a.length;b++)if(yW(a[b]))return a[b];return null}function yW(a){return null==a?!1:50>=a.length}function IRc(a,b){return b.toLowerCase()in a.O?a.O[b.toLowerCase()]:-1}function ERc(){return{index:-1,IB:0}}
function JRc(a){for(var b=UV(a.length,2),c=[],d=0;d<b.length;d++)c.push({index:a[b[d]],IB:1});return c}function DRc(a,b){vb(a);vb(b);for(var c=[],d=0,e=0;d<a.length&&e<b.length;)a[d]==b[e]?(c.push(a[d]),d++,e++):a[d]<b[e]?d++:e++;return c}var zRc=["average","total","sum","mean","median"];function DW(a){this.Va=a;this.uw=[];this.C=this.Aa=this.ma=this.YL=this.IA=null;this.V=[];this.gb=[];this.O=new Nm;this.Na=new Nm;this.$=!1;this.D=[];this.F=[]}p=DW.prototype;p.init=function(a,b,c,d,e,f){this.reset();this.IA=b;this.YL=c;this.ma=d;this.Aa=a;this.gb=f;this.V=e;this.C=new yRc(a,e)};
p.k$=function(){KRc(this);for(var a=[],b=0;b<this.V.length;b++){var c=this.V[b];switch(c.getChartType()){case "BarChart":if(this.Bk(13)||this.Bk(2)){var d=V(c,6);if(d&&-1!=IRc(this.C,d)){var e=LRc(this,c);1<e.length&&(this.Bk(23)?EW(this,a,"Scatter chart of "+e[0].name+" vs "+e[1].name,23,2):this.Bk(2)&&EW(this,a,"Correlation of "+e[0].name+" and "+e[1].name,2,1.5))}}break;case "ScatterChart":var f=LRc(this,c);1<f.length&&(this.Bk(23)?EW(this,a,"Scatter chart of "+f[0].name+" vs "+f[1].name,23,2):
this.Bk(2)&&EW(this,a,"Correlation of "+f[0].name+" and "+f[1].name,2,1.5));break;case "PieChart":for(var h=void 0,k=[],l=pRc(c),m=0;m<l.length&&-1!=IRc(this.C,l[m].name);m++)k.push(l[m]);h=k;1==h.length&&4==h[0].U6a&&(this.Bk(20)?EW(this,a,"Chart of distribution of "+h[0].name,20,2):this.Bk(14)&&EW(this,a,"Distribution of "+h[0].name,14,1.5))}}if(this.Bk(26))for(var r=ha(this.gb),u=r.next();!u.done;u=r.next()){var w=u.value;Sv(w,3)&&EW(this,a,w.Tf(),26,2)}if(this.Bk(1)){var y=this.C.C,B=AW(this.C,
this.F,!1,!0),I=B.index,S=zW(this.C,this.D,!0,!1,!0,!0,I),Y=S.index;if(-1!=Y&&-1!=I){var U=10<=Tv(TV(y,Y),2)?"5 ":"",pa=BW(this.C,Y),ra=CW(this.C,I);if(pa!=ra){var Ba=FW(1,[B],[S]);EW(this,a,this.MHa(1)+" "+U+pa+" by "+ra,1,Ba)}}}if(this.Bk(2)&&1<Tv(this.C.C,1)){a:{var Ha=this.C,La=this.F;if(2>Ha.H.length)var Ka=[ERc(),ERc()];else{var ab=AW(Ha,La,!1,!1,void 0,!0),Ab=ab.index;if(-1!=Ab){var lb=vRc(Ha.D.D,Ab);if(0<lb.length){var cb=[ab],Dc=VV(lb),dc=2,Qc=DRc(lb,La);0<Qc.length&&(Dc=VV(Qc),dc=3);cb.push({index:Dc,
IB:dc});Ka=cb;break a}}Ka=JRc(2<=Ha.L.length?Ha.L:Ha.H)}}var Pc=Ka,kd=CW(this.C,Pc[0].index),Gd=CW(this.C,Pc[1].index);if(kd!=Gd){var Rb=FW(1,Pc,[]);EW(this,a,"Correlation of "+kd+" and "+Gd,2,Rb)}}if(this.Bk(3)){var Jg=this.C.C,wb=AW(this.C,this.F,!0),he=wb.index;if(-1!=he){var de=FW(1,[wb],[]);EW(this,a,this.vQ(Wv(V(Jg,1,he),3),3)+" of "+CW(this.C,he),3,de)}}if(this.Bk(5)){var Kg=this.C.C,Of=AW(this.C,this.F,!0,!0),Wh=Of.index,qf=zW(this.C,this.D,!0,!0,!1,!0,Wh),bh=qf.index;if(-1!=Wh&&-1!=bh){var zj=
CW(this.C,Wh),Qk=TV(Kg,bh),Aj=BW(this.C,bh);if(0<Tv(Qk,3)&&Aj!=zj){var pi=FW(1,[Of],[qf]),Bj=GRc(this.C,bh);EW(this,a,this.vQ(Wv(V(Kg,1,Wh),3),5)+" of "+zj+" when "+Aj+" is "+SV(Qk,Bj),5,pi)}}}if(this.Bk(9)){var vm=AW(this.C,this.F,!1,!0),Zj=vm.index,qi=zW(this.C,this.D,!0,!1,!0,!0,Zj),rk=qi.index;if(-1!=rk&&-1!=Zj){var Mh=CW(this.C,Zj),ql=BW(this.C,rk);if(ql!=Mh){var rl=FW(1,[vm],[qi]);EW(this,a,ql+" with "+this.$ja(9)+" "+Mh,9,rl)}}}if(this.Bk(10)&&0<Tv(this.C.C,1)){var Xl=AW(this.C,this.F),fo=
FW(1,[Xl],[]),sl=CW(this.C,Xl.index);EW(this,a,this.$ja(10)+" "+sl,10,fo)}if(this.Bk(11)){var ub=this.C.C,Yi=zW(this.C,this.D,!0,!0,!1,!1,-1),Cj=Yi.index;if(-1!=Cj){var Zi=BW(this.C,Cj);if(0<Tv(TV(ub,Cj),3)){var ln=FW(1,[],[Yi]);EW(this,a,"Most frequent "+Zi,11,ln)}}}if(this.Bk(12)){var go=this.C.C,rt=AW(this.C,this.F,!0),mn=rt.index;a:{var sk=this.C;if(1==sk.$.length){var Rk=sk.$[0];if(!V(TV(sk.C,Rk),5)){var tk=Rk;break a}}tk=-1}var uk=tk;if(-1!=uk&&-1!=mn){var Mu=CW(this.C,mn),ho=TV(go,uk);if(0<
Tv(ho,2)){var ug=FW(1,[rt],[]),io=FRc(this.C,uk);EW(this,a,this.vQ(Wv(V(go,1,mn),3),12)+" of "+Mu+" "+VV(MRc)+" "+SV(ho,io),12,ug)}}}if(this.Bk(15)){var $r=this.C.C,jo=AW(this.C,this.F,!0),nn=jo.index,np=zW(this.C,this.D,!1,!0,!1,!0,nn),wm=np.index;if(-1!=nn&&-1!=wm){var tl=CW(this.C,nn),Dq=BW(this.C,wm);if(Dq!=tl){var Sk=TV($r,wm);if(2<=Tv(Sk,3)){var Ii=FW(1,[jo],[np]),xm=UV(Tv(Sk,3),2);EW(this,a,"Compare "+this.vQ(Wv(V($r,1,nn),3),15)+" "+tl+" for "+Dq+" "+SV(Sk,V(Sk,3,xm[0]))+" and "+SV(Sk,V(Sk,
3,xm[1])),15,Ii)}}}}if(this.Bk(16)){var Dj=zW(this.C,this.D,!0,!0,!1,!1),ri=Dj.index;if(-1!=ri){var Eq=BW(this.C,ri),Fq=FW(1,[],[Dj]);EW(this,a,"List unique values in "+Eq,16,Fq)}}if(this.Bk(17)){var op=this.C.C,ko=zW(this.C,this.D,!0,!0,!1,!1),Ej=ko.index;if(-1!=Ej){var Tk=TV(op,Ej),st=BW(this.C,Ej);if(!(1>Tv(Tk,3))){var lo=GRc(this.C,Ej),Gq=FW(1,[],[ko]);EW(this,a,"What percentage of "+st+" is "+SV(Tk,lo),17,Gq)}}}if(this.Bk(13)){var as=this.C.C,on=AW(this.C,this.F,!0,!0),pn=on.index,qp=zW(this.C,
this.D,!0,!0,!1,!0,pn),mo=qp.index;if(-1!=pn&&-1!=mo){var bs=CW(this.C,pn),no=BW(this.C,mo);if(no!=bs){var wo=FW(1,[on],[qp]);EW(this,a,this.vQ(Wv(V(as,1,pn),3),13)+" of "+bs+" by "+no,13,wo)}}}if(this.Bk(18)){var xo=AW(this.C,this.F),yo=xo.index;if(-1!=yo){var $l=FW(2,[xo],[]);EW(this,a,"Histogram of "+CW(this.C,yo),18,$l)}}if(this.Bk(24)){var Yw=zW(this.C,this.D,!0,!0),nz=Yw.index;if(-1!=nz){var oz=FW(1,[Yw],[]);EW(this,a,"Count of "+BW(this.C,nz),24,oz)}}if(this.Bk(25)){var zn=this.C.C,zp=zW(this.C,
this.D,!0,!0),Xk=zp.index;if(-1!=Xk){var ts=TV(zn,Xk),Bo=FRc(this.C,Xk),Ap=FW(1,[zp],[]);EW(this,a,"Count when "+BW(this.C,Xk)+" is "+SV(ts,Bo),25,Ap)}}var Em=3>a.length;if((Em||0==UV(5,1)[0])&&this.Bk(7)){var Sq=this.C.C,us=AW(this.C,this.F,!1,!0),hv=zW(this.C,this.D,!1,!1,!1,!0,us.index);if(-1!=hv.index&&-1!=us.index){var lG=TV(Sq,hv.index),nL=BW(this.C,hv.index),pz=CW(this.C,us.index);if(0<Tv(lG,2)&&nL!=pz){var Yk=FW(1,[us],[hv]),qz=FRc(this.C,hv.index);EW(this,a,"Show "+pz+" for "+nL+" "+SV(lG,
qz),7,Yk)}}}if((Em||0==UV(5,1)[0])&&this.Bk(8)){var Fm=this.C.C;a:{var vs=this.C,Tq=this.D;if(2>vs.F.length)var Co=[ERc(),ERc()];else{var iv=zW(vs,Tq,!0,!1,!1,!1,void 0,!0),Ct=iv.index;if(-1!=Ct){var Do=vRc(vs.D.C,Ct);if(0<Do.length){var Zw=[iv],$w=VV(Do),rz=2,Dt=DRc(Do,Tq);0<Dt.length&&($w=VV(Dt),rz=3);Zw.push({index:$w,IB:rz});Co=Zw;break a}}var Bp=JRc(2<=vs.J.length?vs.J:vs.F);Bp[0].index!=Ct&&(Bp[1]=Bp[0],Bp[0]=iv);Co=Bp}}var Uq=Co,jv=Uq[0].index;if(1<Fm.zj()&&-1!=jv){var Et=Uq[1].index,Ft=TV(Fm,
Et),sz=BW(this.C,Et),mG=BW(this.C,jv);if(0<Tv(Ft,2)&&sz!=mG){var t1=FW(1,[],Uq),tz=FRc(this.C,Et);EW(this,a,"What is "+mG+" where "+sz+" is "+SV(Ft,tz),8,t1)}}}this.uw=NRc(a)};function KRc(a){if(a.$){var b=GG(a.IA?zH(a.Va,a.IA.bd):LI(a.Va)),c=Xv(a.C.C,4);z(b,function(b){var d=b.left,f=b.width;c&&(d=b.top,f=b.height);for(b=0;b<f;b++){var h=a.C.ma[d+b],k=a.C.Aa[d+b];h&&0<=h&&fb(a.D,h);k&&0<=k&&fb(a.F,k)}})}}p.reset=function(){this.uw=[];this.F=[];this.D=[];this.Na=new Nm;this.O=new Nm};p.l$=function(){return nf(this.uw.slice())};
function NRc(a){vb(a,function(a,c){return c.weight-a.weight});return Va(a,function(a){return a.DA})}function EW(a,b,c,d,e){e=a.KHa(d,e);a.Na.contains(c)||(b.push({DA:{query:c,iq:void 0,type:d},weight:e}),a.O.add(d),a.Na.add(c))}p.Bk=function(a){return!this.O.contains(a)};function ORc(a,b){return a.l$().then(function(a){return a.length<=b?a:qb(a,0,b)},null,a)}function FW(a,b,c){z(b,function(b){3==b.IB&&a++});z(c,function(b){3==b.IB&&a++});return a}
function LRc(a,b){var c=[];b=pRc(b);for(var d=0;d<b.length;d++){var e=a.C,f=b[d].name;if(-1==(f.toLowerCase()in e.V?e.V[f.toLowerCase()]:-1))break;c.push(b[d])}return c}p.vQ=function(a){a:{if(0<a.length)for(var b=0;b<a.length;b++)switch(a[b]){case 5:a=PRc;break a;case 4:a=QRc;break a}a=RRc}return VV(a)};p.MHa=function(){return VV(SRc)};p.$ja=function(){return VV(TRc)};
var RRc=["Average","Median"],PRc=["Total","Average","Median"],QRc=["Median"],TRc="Minimum Maximum Most Least Highest Lowest".split(" "),SRc=["Top","Bottom"],MRc=["before","after"];var URc={};ic({O5a:{type:0,JA:"",AA:[]},Hea:{type:1,JA:"Sum",AA:[3,5,13,12,15]},Qca:{type:2,JA:"Average",AA:[3,5,13,12,15]},bea:{type:3,JA:"Mode",AA:[3]},i6a:{type:4,JA:"Variance",AA:[3]},Y4a:{type:5,JA:"Standard deviation",AA:[3]},Xwa:{type:6,JA:"Median",AA:[3,5,13,12]},fV:{type:7,JA:"Count",AA:[24,25]},H4a:{type:8,JA:"Bottom",AA:[1,10,14]},I4a:{type:9,JA:"Top",AA:[1,11,10,14]}},function(a){URc[a.type]=a});function VRc(a){if(a=URc[a])return a};function WRc(a){DW.call(this,a);this.H=[]}q(WRc,DW);p=WRc.prototype;p.reset=function(){DW.prototype.reset.call(this);this.H=[]};p.KHa=function(a,b){return 1+b};p.Bk=function(a){return!this.O.contains(a)&&0<XRc(this,a).length};p.MHa=function(a){return YRc(this,a)};p.vQ=function(a,b){return YRc(this,b)};p.$ja=function(a){return YRc(this,a)};function ZRc(a,b){a.reset();z(b,function(b){z(Wv(b,1),function(b){a.H.push(V(b,1))},a)},a);eOc(a.H);a.k$();return ORc(a,3)}
function XRc(a,b){return Ua(a.H,function(a){return bb(VRc(a).AA,b)},a)}function $Rc(a,b){a=Za(a.H,function(a){return VRc(a).type==b},a);return VRc(a)}function YRc(a,b){b=XRc(a,b);return $Rc(a,VV(b)).JA};function GW(a,b,c,d,e,f,h,k,l,m,r,u,w,y){gW.call(this,y);this.Le=c;this.Ob=d;this.Se=e;this.ad=a;this.Cb=new WRc(this.Ob);this.rb=h;this.ma=m;this.Ye=r;this.Nb=u;this.L=this.J=this.V=this.Mb=this.F=null;this.yb="";this.Va=new kOc;this.O=f;this.cb=this.gc=this.hb=this.D=null;this.gb=k;this.$d=!1;this.Lb=Kj(new Jj,10).build();this.Zc=new $v;this.Jb=l;this.$={};this.Kd=qn();this.Eb="";this.Na=null;this.qf=w}x(GW,gW);p=GW.prototype;p.Wa=function(){GW.oa.Wa.call(this);this.oI(null==this.D)};
p.Gqa=function(a,b){GW.oa.Gqa.call(this,a,b);b=this.qa();var c=this.Aa;this.V=new XV(b);c.Qa(this.V,!0);b.appendChild(a,this.V.qb());this.V.Wa();this.J=new uOc(this.V,this.O,this.Va,10);c.xa(this.J);c.getHandler().R(this.V,"answers-submit-query",v(this.g0b,this))};p.R4=function(){GW.oa.R4.call(this);this.J=this.V=null};
p.oI=function(a){var b=this;this.V&&this.V.setVisible(!a);a?(this.Na&&this.Na.dispose(),this.Na=new Ui(function(){GW.oa.oI.call(b,a)},300,this),this.xa(this.Na),this.Na.start()):(this.Na&&this.Na.stop(),GW.oa.oI.call(this,a))};p.Pf=ca("Mb");
function aSc(a,b,c,d,e,f,h){h=void 0===h?[]:h;var k=void 0===k?[]:k;a.Cb.init(c,b,d,e,h,k);h=Va(Wv(c,1),function(a){return a.getName()});var l=[],m=[];z(Wv(c,2),function(a){l.push(a.getName());m=m.concat(Wv(a,2))});lOc(a.Va,h,l,m);a.ad.l$().then(function(a){this.Va.F=a;this.J&&(a=this.J,He(a.O.qa())==a.D&&a.xTa())},null,a);a.D=b;a.hb=d;a.gc=e;a.cb=c;a.Lb=Lj(Kj(new Jj,10),bSc(a)).build();if(f)for(c=Va(a.C,function(a){if(a instanceof vW||a instanceof wW)return a.cO().D}),a.QW(),d=0;d<c.length;d++)if(e=
c[d])f=new QV,G(f,1,5),cSc(a,e,f);a.oI(null==b)}p.reset=function(){mS(this.$);mS(this.Va.D);var a=this.Va;a.F=[];a.C.clear();this.L=null;this.Fha()};
function cSc(a,b,c,d,e){d=void 0===d?null:d;e=void 0===e?!1:e;G(c,13,a.ma.L.J);var f=new PV;Vf(f,5,c);a.J&&AOc(a.J);var h=Mb(b.toLowerCase());if(!a.Mb||a.Mb.getStatus().getState().Dh())if(a.$[h])dSc(a,b,!1);else{d=new uW(b,null,null,null,2,a.ma);eSc(a,d,!0,f);return}else{var k=a.$[h];k&&k instanceof wW&&2==k.cO().error&&delete a.$[h]}b&&a.D?a.$[h]&&!d?(a.O.Yb(2681,a.Lb),dSc(a,b,!0)):(a.$[h]&&d&&fSc(a,a.$[h],!1),h=bSc(a),k=Tf(Tf(h,WR,46),PV,4),G(k,2,e),e=Lj(Kj(new Jj,10),h).build(),a.O.Yb(2635,e),
e=GE(a.D.rect),f=Ev(Sm(Ws(Tu(Vs(a.Mb.$e("/answers/parse").Ff("q",b,"qt",F(c,1),"gid",a.D.bd,"range",e,"context",a.yb),v(a.Zk,a,b,f)),v(a.f0b,a,b,f)),"POST"),2)),a.hb&&null!=a.gc&&(b=0==a.hb.rect.width||0==a.hb.rect.height?"":GE(a.hb.rect),f.Ff("headerRange",b,"tableRecordDimension",""+a.gc)),d&&f.Ff("sgfml",d),f.De(),a.Eb=rn(a.Kd,oA.jua),gSc(a,!0)):yOc(a.J,"")}
function dSc(a,b,c){var d=a.$[Mb(b.toLowerCase())];d!=Ra(a.C)&&(1<a.C.length&&hSc(a),c&&iSc(a,d.cO()).then(function(a){jSc(this,d,a)},null,a),DPc(a,d))}p.g0b=function(a){var b=a.O;var c=a.Va;var d=a.F,e=a.Na;c?c=nQc(b,d,e,c):(c=new QV,G(c,1,b));cSc(this,a.V,c,a.C,a.H)};p.f0b=function(a,b){if(this.D){var c=F(Tf(b,QV,5),1);c=1==c||4==c?QNc.bza:QNc.Fza;var d=bSc(this),e=Tf(Tf(d,WR,46),PV,4);G(e,1,c);G(b,1,c);c=Lj(Kj(new Jj,10),d).build();this.O.Yb(2640,c);kSc(this,a,b)}};
function kSc(a,b,c){gSc(a,!1);b=new uW(b,null,null,null,3,a.ma);eSc(a,b,!1,c);lSc(a)}
p.Zk=function(a,b,c){this.D&&this.gb.C.D.C.then(function(){var d=null,e=null,f=!1,h=Tf(b,QV,5),k=F(h,1),l=bSc(this);k=1==k||4==k?QNc.bza:QNc.Fza;var m=Tf(Tf(l,WR,46),PV,4);G(m,1,k);G(b,1,k);l=Lj(Kj(new Jj,10),l).build();if(c.Mj()){e=this.Zc.zd(pW.Ba(),c.yf());if(f=e.getStatus()){switch(f){case 1:var r=2639;break;case 2:r=2643;break;case 3:r=2644;break;case 4:r=2638;break;case 5:r=2707;break;case 6:r=2706}r&&this.O.Yb(r,l)}r=V(e,10);G(h,4,r);r=V(e,11);G(h,5,r);Sv(e,16)&&(r=V(e,16),G(h,16,r));if(1==
f){kSc(this,a,b);return}if(2==f){e=-1!=mSc(a);h=-1!=mQc(a);f=4;d=Tf(b,QV,5);e?(f=5,G(d,8,2)):h&&(f=7,G(d,8,1));h=new uW(a,null,null,null,f,this.ma);e?(e=new wW(h,!0,this.Jb,!0,this.qa()),nSc(this,h,e,b)):eSc(this,h,!0,b);gSc(this,!1);lSc(this);return}k=Sv(e,2)?e.Ij():null;f=!0;if(k){r="";if(this.D.bd!=this.Ob.C.Ib()){d=XA(this.Ob,this.D.bd).Zd();k=RHb(k,this.ma);var u="";for(m=0;m<k.length;m++){var w=k[m];"range"==w.getType()?(w=w.getText(),w=xdb(w,d),u+=w):u+=w.getText()}k=u}d=KNc(this.gb,k,this.D,
!!this.cb&&!!V(this.cb,4));G(h,14,!!d);if(!d){if(m=k.match(/([A-Z]*)\(/))u=Tf(Tf(Ij(l),WR,46),PV,4),G(u,7,m[1]),G(b,7,m[1]);this.O.Yb(2645,l)}d&&LNc(d)||(r=this.gb,u=this.D,l="="!=k[0]?"="+k:k,m=u.bd+"",u=JNc(m,u),r=g5b(r.C,l,m,u.row,u.yj));l=Sv(e,19)?KNc(this.gb,V(e,19)||"",this.D,!!this.cb&&!!V(this.cb,4)):d;d=new uW(a,d,"="!=k[0]?"="+k:k,e,null,this.ma,l,this.D.bd);if(Sv(e,23)&&d.Lj()){if(Sv(e,17)&&Sv(V(e,17),5)){k=V(V(e,17),5);l=d.ma;if(Sv(k,5))switch(V(k,5).getPosition()){case 1:l.C="right";
break;case 2:l.C="left";break;case 3:l.C="top";break;case 4:l.C="bottom"}Sv(k,1)&&Sv(V(k,1),1)&&Sv(V(V(k,1),1),1)&&1==V(V(V(k,1),1),1)&&(l.J=!0);Sv(k,2)&&Sv(V(k,2),1)&&Sv(V(V(k,2),1),1)&&1==V(V(V(k,2),1),1)&&(l.L=!0);Sv(k,1)&&Sv(V(k,1),1)&&Sv(V(V(k,1),1),2)&&(m=V(V(V(k,1),1),2),l.F=m);Sv(k,2)&&Sv(V(k,2),1)&&Sv(V(V(k,2),1),2)&&(m=V(V(V(k,2),1),2),l.H=m);Sv(k,3)&&(m=k.getTitle().getTitle(),l.O=m);Sv(k,4)&&(k=V(k,4).getTitle(),l.D=k)}this.yb=Xv(e,23)}else this.yb="";r&&d.L.push(r);d.Lj()&&Vf(h,15,d.V);
d.Tz()&&Sv(e,24)&&(r=mFc(Xv(e,24)),Vf(h,17,r))}else!d&&Sv(e,24)?(d=new uW(a,[[]],"",e,null,this.ma,[[]],this.D.bd),this.yb=Xv(e,23),r=mFc(Xv(e,24)),Vf(h,17,r)):Sv(e,9)&&(r=e.getError(),d=new uW(a,null,null,e||null,6,this.ma),l=V(r,2),G(h,6,l),Sv(r,3)&&(r=V(r,3),G(h,12,r)))}else this.O.Yb(2640,l);d||(d=new uW(a,null,null,e||null,4,this.ma));gSc(this,!1);tQc(d)?oSc(this,d,f,b):eSc(this,d,f,b);lSc(this)},function(){kSc(this,a,b)},this)};function lSc(a){""!=a.Eb&&(sn(a.Kd,a.Eb),a.Eb="")}
function pSc(a){if(null!=a.iq)return mRc;switch(a.error){case 4:case 6:return 0<a.O.length?nRc:lRc;case 5:return lRc}return oRc}function bSc(a){var b=new PV;G(b,8,!0);var c=new WR;Vf(c,4,b);a=ePc(a.D);Vf(a,46,c);return a}function mSc(a){return $a(kQc,function(b){return Gb(a,b)})}
function qSc(a,b){var c=[];b=b.O;for(var d=0;d<b.length&&3>c.length;++d){var e=a.gb,f=b[d].Ij(),h=!!a.cb&&!!V(a.cb,4);e=KNc(e,f,a.D,h);LNc(e)&&(e={query:V(b[d],1),iq:b[d].Ij(),type:b[d].getType()},Sv(b[d],5)&&(e.hGa=V(b[d],5)),c.push(e))}return nf(c)}function oSc(a,b,c,d){c=new vW(b,a.Le,a.Ob,a.Se,a.O,a.Jb,a.rb,c,a.ma,a.$d,a.qf,a.gb,a.qa());nSc(a,b,c,d)}
function rSc(a,b){if(a.F&&a.F.isVisible())yN(a.F);else{var c=a.Ye.D.C["ritz-ap"]||null;aRc(b)&&(a.F=gWb(a.Nb,a.qa(),c,void 0,"answersPivotPromo"),a.F&&(a.getHandler().Wc(a.F.C,"beforeshow",function(){return a.t_b}).Wc(a,"Yd",a.Fha),a.F.show(),a.xa(a.F),PMa(c,"answersPivotPromo")))}}p.lca=function(){GW.oa.lca.call(this);this.F&&this.F.isVisible()&&this.F.C.Cd()};p.t_b=function(){var a=this.qa().$a("docs-promo-text-container",this.F.C.qb());Hh(a,"waffle-assistant-answercard-pivot-promo-text-container")};
p.Fha=function(){this.F&&this.F.isVisible()&&yN(this.F)};function eSc(a,b,c,d){c=new wW(b,c,a.Jb,!1,a.qa());nSc(a,b,c,d)}function nSc(a,b,c,d){hSc(a);var e=iSc(a,b,d);sSc(a,c);c instanceof vW&&rSc(a,c);tSc(a);tQc(b)&&mOc(a.Va,b.D);e.then(function(a){if(d){if(c instanceof vW){var b=Tf(d,QV,5);G(b,18,c.gc)}b=bSc(this);var e=Tf(b,WR,46);Vf(e,4,d);b=Lj(Kj(new Jj,10),b).build();this.O.Yb(2781,b)}jSc(this,c,a)},null,a);c.tja()&&(a.$[Mb(b.D.toLowerCase())]=c);a.getHandler().R(c,"rc",a.SLa)}
function jSc(a,b,c){b instanceof wW&&null!=c&&vi(c.getElement())&&(b=b.getElement(),L(b,!1),a.getHandler().R(c,"rc",a.SLa))}function hSc(a){uSc(a);z(a.C,function(a){a instanceof wW&&(a=a.getElement(),L(a,!0))});vSc(a)}function vSc(a){0!=a.C.length&&(a.L?DPc(a,a.L):(a.L=new iRc(a.qa()),sSc(a,a.L)))}function uSc(a){z(a.C,function(b){b instanceof vW||b instanceof wW||b==a.L||a.$H(b)})}
function wSc(a,b){var c=nf([]);b=b.Na;0<b.length&&(c=ZRc(a.Cb,b));return c=c.then(function(b){var c=3-b.length;return 0<c?ORc(a.ad,c).then(function(a){return nb(b,a)}):nf(b)})}
function iSc(a,b,c){var d=pSc(b),e=null;d==mRc||d==nRc?0<b.O.length&&(e=qSc(a,b)):d==lRc&&(e=wSc(a,b));var f=null;return e?(f=new xW(new nH,a.Jb,e,d,b,a.qa()),sSc(a,f),a.O.Yb(2769,a.Lb),a.getHandler().R(f,"sqc",v(a.kHb,a)),e.then(function(a){if(c){var b=Tf(c,QV,5);bb([mRc,nRc],f.D)?(a=pQc(a),Vf(b,7,a)):bb([kRc,lRc],f.D)&&(a=qQc(a),Vf(b,9,a))}return f},null,a)):nf(f)}p.kHb=function(a){yOc(this.J,a.F,!0);var b=a.O;b=1==b?nQc(b,a.C,a.H,3):oQc(b,a.C,a.H,a.Na);cSc(this,a.F,b,a.Ij());this.O.Yb(2762,this.Lb)};
function gSc(a,b){a.V&&(a=a.V,L(a.F,b),L(a.qa().$a("waffle-assistant-answers-button-container",a.C),!b),VT(a.H,b))}function sSc(a,b){b.Ct(a.Pd());a.C.push(b);if(a.Dc){CPc(a,!1);var c=a.H.fd();b.O=c;a.H.Fg(b,0,!0);b.WJ()}XOc(b,!0)}function tSc(a){for(var b=a.C;5<b.length;)a.$H(b[0])}p.QW=function(){GW.oa.QW.call(this);this.reset()};p.SLa=function(a){fSc(this,a.target)};p.SDb=function(a){oSc(this,a.cO(),a.tja());fRc(this.rb,"Remove answer undone",this.qa())};
p.$H=function(a){if(a.Sb()){if(a instanceof vW||a instanceof wW)delete this.$[Mb(a.cO().D.toLowerCase())],a==Ra(this.C)&&uSc(this);GW.oa.$H.call(this,a);this.Fha()}C(a)};
function fSc(a,b,c){c=void 0===c?!0:c;var d=a.qa();if(b instanceof vW)a.$H(b),c&&fRc(a.rb,"Answer removed",d,v(a.SDb,a,b));else if(b instanceof wW)a.$H(b),c&&fRc(a.rb,"Card removed",d);else if(b instanceof xW&&b.C&&!tQc(b.C)){var e=b.C.D;z(a.C,function(b){b instanceof wW&&b.cO().D==e&&(a.$H(b),c&&fRc(a.rb,"Card removed",d))})}b=a.C;!a.L||b[0]!=a.L&&b[b.length-1]!=a.L||(a.$H(a.L),a.L=null)};function xSc(a,b,c){b=c||b;a=P('<div class="waffle-assistant-answers-logging-message-container"><div class="waffle-assistant-answers-logging-message"><span class="waffle-assistant-answers-logging-text">We\'re logging your queries and data to improve the feature.</span><div class="waffle-assistant-answers-learn-more">Learn More</div><div class="waffle-assistant-answers-logging-opt-out">Opt-out for this file</div></div></div>')+'<div class="waffle-assistant-answers-input waffle-assistant-answers-input-with-icon"><form class="waffle-assistant-answers-query-box"><div class="waffle-assistant-answers-input-container"><div class="waffle-assistant-answers-search-icon">'+
O(Ls({icon:"docs-icon-img docs-icon-search-this-document"},b))+'</div><input class="waffle-assistant-answers-input-box" placeholder="';a+=zr("Ask a question about your data");return P(a+'"/></div></form></div>')};function ySc(a,b,c){DW.call(this,a);this.J=[];this.L=this.H=null;this.cb=b;this.rb=c;this.hb=Kj(new Jj,10).build()}q(ySc,DW);p=ySc.prototype;p.k$=function(){this.reset();DW.prototype.k$.call(this);zSc(this)};p.reset=function(){DW.prototype.reset.call(this);this.J=[];this.H&&(this.H.cancel(),this.H=null)};p.l$=function(){return this.H?this.H.then(function(){return this.J.slice()},null,this):DW.prototype.l$.call(this)};p.KHa=function(a,b){return Math.pow(Math.random(),1/(ASc(a)*b))};p.Pf=ca("L");
function ASc(a){switch(a){case 13:return.34;case 3:return.37;case 12:return.25;case 5:return.3;case 15:return.34;case 2:return.43;case 8:return.76;case 9:return.35;case 14:return.47;case 11:return.4;case 7:return.37;case 10:return.36;case 17:return.41;case 1:return.42;case 16:return.3;case 26:return.5;default:return.3}}
function zSc(a){var b=null;a.H=new lf(function(a){if(!this.L||this.L.getStatus().getState().Dh())this.J=this.uw,a();var c=GE(this.IA.rect),e=Va(this.uw,function(a){return a.query});c=Ws(Ev(Sm(Tu(Vs(this.L.$e("/answers/parsesuggestions").Ff("gid",this.IA.bd,"range",c),v(function(b){BSc(this,b).then(a)},this)),v(function(b){8==b.errorCode&&this.rb.Yb(2833,this.hb);this.J=this.uw;a()},this)).setContent(["queries",Vl(e)]).setTimeout(2E3),1)),"POST");this.YL&&null!=this.ma&&(e=0==this.YL.rect.width||0==
this.YL.rect.height?"":GE(this.YL.rect),c.Ff("headerRange",e,"tableRecordDimension",""+this.ma));b=c.De()},a);tf(a.H,function(){b&&b.dispose()})}function BSc(a,b){return a.cb.C.D.C.then(function(){var a=[];if(b.Mj())for(var d=b.yf(),e=0;e<d.length;e++){var f;if(f=d[e]){f=this.cb;var h=!!this.Aa&&!!V(this.Aa,4);f=KNc(f,d[e],this.IA,h);f=LNc(f)}f&&(this.uw[e].iq=d[e],a.push(this.uw[e]))}this.J=a},function(){this.J.length=0},a)};function HW(a,b,c,d,e,f,h,k,l,m,r){hW.call(this,1,f,e,r);this.Eb=c;this.gb=null;this.Na=new pr("",new WT,this.qa());this.Qa(this.Na);this.Va=new pr("",new WT,this.qa());this.Qa(this.Va);f=new e5b(a,!0,!0);f=new EEc(f);this.yb=new OQc(e);this.O=new ySc(this.Eb,f,e);this.H=new GW(this.O,a,b,c,d,e,this.sb,f,this.yb,h,k,l,m,r);a=CSc;this.D=new XT(b,a.Kda,a.Lda);this.xa(this.D);this.F=this.J=null;this.Cb=Kj(new Jj,10).build();this.cb=!1}x(HW,hW);
var CSc={Kda:"waffle-assistant-answers-styled-border",Lda:"waffle-assistant-answers-styled-rect",q1a:"waffle-assistant-answers-input-box",w3a:"waffle-assistant-answers-query-box",Tzc:"waffle-assistant-answers-query-box-focused",K1a:"waffle-assistant-answers-learn-more",Xtc:"waffle-assistant-answers-logging-message-container",R2a:"waffle-assistant-answers-logging-opt-out"};p=HW.prototype;p.Ma=function(){HW.oa.Ma.call(this);var a=N(xSc);this.qa().appendChild(FPc(this),a)};
p.Wa=function(){HW.oa.Wa.call(this);var a=CSc,b=this.$a(a.w3a),c=this.$a(a.q1a);this.Va.Ab(this.$a(a.R2a));this.Na.Ab(this.$a(a.K1a));this.getHandler().R(b,"focus",this.hDb,!0).R(b,"blur",this.fDb,!0).R(b,"mouseover",this.jDb).R(b,"mouseout",this.iDb).R(b,"click",this.gDb).R(c,"input",this.h0b).R(this.Va,"action",this.gBb).R(this.Na,"action",this.Vxb).R(pG(this.Eb),"Xa",Vxc(this.i0b,25,this));this.setVisible(null!=this.J);DSc(this,X2a&&Y2a&&yA("showAnswersLoggingOptOut"))};p.cVa=Je;p.MMa=Ke;
p.Kra=Je;p.getTitle=n("Answers");p.w2=n(1);p.zW=function(a){return 3==a||0==a||1==a};p.dO=function(a,b){vb(a,function(a,b){return V(b,2)-V(a,2)});for(var c=[],d=[],e=null,f=0;f<a.length;f++){var h=Xv(a[f],1);3==h?e=a[f]:0==h?c.push(V(a[f],8)):1==h&&d.push(a[f])}if(e&&V(e,2)){f=b||null;h=Sv(e,11)?V(e,11):null;var k=null==h?null:gy(V(e,10));0<Tv(e,4)?ESc(this,gy($R(e)),V(e,9),k,h,c,d):ESc(this,f,V(e,9),k,h,c,d);this.F||(HW.oa.dO.call(this,a,b),this.getHandler().R(this.F,"sqc",this.iHb))}else this.eO(!0)};
p.EP=function(a){if(!this.F){var b=ORc(this.O,3);this.F=new xW(a,this.yb,b,kRc,void 0,this.qa())}return this.F};p.jCa=g("H");p.Oma=function(){return this.isVisible()};
p.eO=function(a,b,c){this.O.reset();(a||b)&&this.F&&(HW.oa.eO.call(this,a,b,c),this.F.dispose(),this.F=null);if(a||t(b)&&!b)this.F&&(HW.oa.eO.call(this,a,b,c),this.F.dispose(),this.F=null),this.Sb()&&(this.O.reset(),this.J=null,a=this.H,a.Sb()&&(b=a.Va,b.F=[],b.C.clear(),a.J&&(b=a.J,b.O.Sb()&&(tOc(b.D),b.F.isDisposed()||b.F.setVisible(!1),b.J=!1)),a.QW(),a.Cb.reset(),a.D=null,a.oI(!0)),this.setVisible(!1),this.Wb()&&ZT(this.D));c&&this.H.reset()};p.pXa=function(a,b){b||CPc(this.H,a)};
p.Pf=function(a){this.gb=a;this.H.Pf(a);this.O.Pf(a)};p.SU=function(a){HW.oa.SU.call(this,a);a?YT(this.D,this.J):ZT(this.D)};function FSc(a,b){a.Wb()&&(b?ZT(a.D):YT(a.D,a.J))}function DSc(a,b){L(a.$a("waffle-assistant-answers-logging-message-container"),b)}function GSc(a,b){a=a.$a("waffle-assistant-answers-query-box");Lh(a,"waffle-assistant-answers-query-box-focused",b)}p.i0b=function(){this.Wb()&&YT(this.D,this.J)};p.hDb=function(){GSc(this,!0);YT(this.D,this.J)};
p.fDb=function(){GSc(this,!1);this.Wb()||ZT(this.D)};p.jDb=function(){YT(this.D,this.J)};p.iDb=function(){this.Wb()||ZT(this.D)};p.gDb=function(){HSc(this,"")};p.h0b=function(){var a=this.$a("waffle-assistant-answers-input-box");HSc(this,a.value);a.value=""};p.iHb=function(a){var b=this,c=a.F;HSc(this,c);var d=nQc(1,a.C,a.H,1),e=new Ui(function(){cSc(b.H,c,d,a.Ij())},300);this.xa(e);e.start();this.V.Yb(2652,this.Cb)};function HSc(a,b,c){a.SU(!0);a.dispatchEvent("de");ISc(a,b,c)}
function ISc(a,b,c){c=void 0===c?!1:c;var d=new Ui(function(){yOc(a.H.J,b,!0);var d=a.H,f=c||!1;d.$d=f;d.ad.$=f;d.Cb.$=f},300);a.xa(d);d.start()}function ESc(a,b,c,d,e,f,h){c=c||new iH;a.J=b;a.O.init(c,b,d,e,f,h);a.O.k$();a.setVisible(null!=b);aSc(a.H,b,c,d,e,a.cb,f);a.cb=!1;a.Wb()&&YT(a.D,a.J)}p.gBb=function(a){a.stopPropagation();a.preventDefault();this.gb&&(Ws(Tu(Vs(this.gb.$e("/answers/logoptout"),v(this.yyb,this)),v(this.xyb,this)),"POST").De(),this.V.Yb(2663,this.Cb))};
p.Vxb=function(a){a.stopPropagation();a.preventDefault();Dp("https://docs.google.com/document/d/1VxpmAx5RTnwmeXyj3IuPPYIXg9DYzTS8nz8pi1E_ZJk/preview",{target:"_blank"})};p.yyb=function(a){a.Mj()&&DSc(this,!1)};p.xyb=ba();function JSc(a){a='<div class="waffle-assistant-quicksum-entry" tabindex="0"><span class="waffle-assistant-quicksum-entry-name" title="'+Q(a.title)+'">'+O(a.name)+'</span><span class="waffle-assistant-quicksum-entry-value"></span><span aria-label="';a+=zr("Press enter to insert formula");return P(a+'"></span></div>')};function IW(a,b){M.call(this);this.C=a;this.D=b}x(IW,M);p=IW.prototype;p.Ma=function(){this.wb=N(JSc,{name:this.C,title:this.D})};p.Wa=function(){IW.oa.Wa.call(this);var a=this.$a("waffle-assistant-quicksum-entry-name");ZV(a);this.getHandler().R(this.qb(),"keypress",this.U_b);L(this.qb(),!1)};p.getFunctionName=g("C");p.mb=function(a){se(this.$a("waffle-assistant-quicksum-entry-value"),a||"");L(this.qb(),!!a)};p.isVisible=function(){return vi(this.qb())};
p.U_b=function(a){13==a.keyCode&&(a.stopPropagation(),a.preventDefault(),this.dispatchEvent(new D("insert",this)))};function JW(a,b,c,d,e){M.call(this,e);this.gb=a;this.Va=b;this.V=c;this.L=d;this.D=a.C;this.cb=new $v;this.ma=Kj(new Jj,17).build();this.$=Kj(new Jj,2).build();this.O=!1;this.F=[];this.C=this.J=null;this.H=[]}x(JW,M);
JW.prototype.Wa=function(){JW.oa.Wa.call(this);this.Fg(new IW(ritz_api.RitzModelApi.getLocalizedFunctionName("SUM"),"Sum"),0,!0);this.Fg(new IW(ritz_api.RitzModelApi.getLocalizedFunctionName("AVERAGE"),"Average"),1,!0);this.Fg(new IW(ritz_api.RitzModelApi.getLocalizedFunctionName("MIN"),"Minimum"),2,!0);this.Fg(new IW(ritz_api.RitzModelApi.getLocalizedFunctionName("MAX"),"Maximum"),3,!0);this.Fg(new IW(ritz_api.RitzModelApi.getLocalizedFunctionName("COUNTA"),"Count all"),4,!0);this.C=new QQc(this.qb(),
this.Va,this.D,this.V);this.C.H=this.O;this.xa(this.C);this.getHandler().R(this,"insert",this.Aa).R(this.C,"formula_inserted",this.Na)};
JW.prototype.refresh=function(a){function b(a){return h?ritz_api.RitzModelApi.renderNumberAsFormattedString(a,k):null}if(UE(this.D)){if(null==a){var c=LI(this.D),d=GG(c);a=KI(this.D);if(!Ya(d,c.Rl,c)){L(this.qb(),!1);return}c=[];for(var e=0;e<d.length;e++){var f=d[e];f=by(a+"",f.zc(),f.yc(),f.Yc(),f.cd());c.push(f)}a=c}d=[];this.F=[];for(c=0;c<a.length;c++)e=a[c],this.F.push(hy(e)),d.push(this.cb.serialize(e));a=a[0].Ib();this.J=null;a!=KI(this.D)&&(this.J=(a=XA(this.D,a))?a.Zd():null);if(d=ritz_api.RitzModelApi.quickSum(d)){L(this.qb(),
!0);a=d.count;c=d.countNumberFormat;var h=1<d.numericCount,k=h?d.valueNumberFormat:null;this.ud(0).mb(b(d.sum));this.ud(1).mb(b(d.average));this.ud(2).mb(b(d.min));this.ud(3).mb(b(d.max));1<a?this.ud(4).mb(ritz_api.RitzModelApi.renderNumberAsFormattedString(a,c)):L(this.qb(),!1);if(this.C){this.C.L=[];this.H=[];for(d=0;d<this.fd();++d)a=this.ud(d),this.H.push(KSc(this,a.getFunctionName()));this.C.L=this.H}}else L(this.qb(),!1)}else L(this.qb(),!1)};
JW.prototype.Aa=function(a){var b=a.target;a=this.F[0];a=new Ed(a.left,a.Yc());b=b.getFunctionName();b=KSc(this,b);a=new fN(LI(this.D),a,b);this.V.C(a);this.L.Yb(2624,this.$)};JW.prototype.Na=function(){this.L.Yb(2624,this.ma)};function KSc(a,b){var c=a.gb.L.D,d=a.J;a=Va(a.F,function(a){return GE(a,d)});return"="+b+"("+a.join(c)+")"};function LSc(a,b,c){E.call(this);this.C=Rmb(pH.getInstance(),a,b,c);this.D=Cf()}x(LSc,E);LSc.prototype.update=function(a,b,c){var d=this,e=this.C.C;c&&e&&!Za(c,function(a){return AYa(a,e.rect)},this)||!a&&e&&c&&1==c.length&&1==c[0].vh()&&e.rect.contains(c[0])||(this.D.cancel(!0),a&&Ywc(this.C),this.D=MSc(),this.D.addCallback(function(){return Qxc(d.C,b,!0)}))};LSc.prototype.Pf=function(a){this.C.Pf(a)};
function MSc(){var a=null,b=new vf(function(){null===a||Si(a)});a=Ri(function(){b.callback()});return b};function NSc(a,b,c){b=c||b;c='<div class="waffle-autovis-lightbox"><div class="waffle-autovis-lightbox-header"><div class="waffle-autovis-lightbox-buttons-wrapper">'+O(Fr({content:vr("INSERT CHART"),style:4,Md:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-insert waffle-autovis-lightbox-readonly-hidden"},b));c+=O(Fr({Md:"waffle-autovis-lightbox-close",content:wr(""+O(Ls({icon:"docs-icon-img docs-icon-close-white"},b))),style:4,title:vr("Close")},b));c+='</div></div><div class="waffle-autovis-lightbox-content"><div class="waffle-autovis-lightbox-content-inner">';
var d='aria-label="'+zr("Previous chart");d+='"';c+=O(Fr({content:wr("&#10094;"),style:4,Md:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-previous",attributes:xr(d)},b));c+='<div class="goog-inline-block waffle-autovis-lightbox-container"></div>';d='aria-label="'+zr("Next chart");d+='"';c+=O(Fr({content:wr("&#10095;"),style:4,Md:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-next",attributes:xr(d)},b));c+='</div><div class="waffle-autovis-lightbox-page-count"><span class="waffle-autovis-lightbox-page-number"></span>/'+
O(a.wPb)+"</div></div></div>";return P(c)}function OSc(){return P('<div class="waffle-autovis-lightbox-chart"></div>')};function PSc(a,b,c,d,e){M.call(this,e);this.F=a;this.D=b;this.$=c;this.V=d;this.H=[];this.C=new Gr("",this.qa());this.Qa(this.C);this.O=new Gr("",this.qa());this.Qa(this.O);this.L=new Gr("",this.qa());this.Qa(this.L);this.J=new Gr("",this.qa());this.Qa(this.J)}x(PSc,M);p=PSc.prototype;p.Ma=function(){PSc.oa.Ma.call(this);this.wb=N(NSc,{wPb:this.F.length})};
p.Wa=function(){PSc.oa.Wa.call(this);var a=D5a.isEnabled();QSc(this,!a);a=this.$a("waffle-autovis-lightbox-close");this.C.Ab(a);a=this.$a("waffle-autovis-lightbox-insert");this.O.Ab(a);var b=this.$a("waffle-autovis-lightbox-previous");this.L.Ab(b);b=this.$a("waffle-autovis-lightbox-next");this.J.Ab(b);RSc(this);SSc(this,this.D,!1);this.getHandler().R(document.body,"focusin",this.F0b).R(this.qb(),"keydown",this.G0b).R(Xd(),"resize",this.J0b).R(this.C,"action",this.close).R(this.O,"action",this.mxb).R(this.L,
"action",this.I0b).R(this.J,"action",this.H0b);b=new mM(this.qb(),this.qa());nM(b);this.xa(b);a.focus()};function RSc(a){var b=a.$a("waffle-autovis-lightbox-content"),c=a.$a("waffle-autovis-lightbox-content-inner");a=a.$a("waffle-autovis-lightbox-page-count");var d=Vd();a=si(a);var e=d.height-a.height-195,f=d.width-200;.75<e/f?(d=f,e=.75*f):d=e/.75;mi(c,d,e);mi(b,d,e+a.height+35)}function QSc(a,b){Lh(a.qb(),"waffle-autovis-lightbox-readonly",b)}
function SSc(a,b,c){c&&LA("Page "+(b+1+(" of "+(a.F.length+"."))));a.H[b]?TSc(a,b):a.F[b]&&(J(H(),"fecpmr")?(c=hPc(a.F[b]),USc(a,c,b)):iPc(a.F[b],function(c){if(!a.isDisposed()&&c){var d=c.le();d=d?d.toJSON():null;var f=new ritz.charts.model.GvizChart;f.updateChartWrapperJsonString(c.toJSON());d&&f.updateDataTableJsonString(d);USc(a,f,b)}},!0))}function USc(a,b,c){var d=a.$a("waffle-autovis-lightbox-container"),e=N(OSc);d.appendChild(e);a.H[c]=e;WDc(b,e,a.$,a.V);TSc(a,c)}
function TSc(a,b){L(a.H[a.D],!1);L(a.H[b],!0);a.L.ib(0!=b);a.J.ib(b!=a.F.length-1);var c=a.$a("waffle-autovis-lightbox-page-number");se(c,b+1);a.D=b}p.F0b=function(a){!qe(this.qb(),a.target)&&a.relatedTarget&&a.relatedTarget.focus()};p.G0b=function(a){27==a.keyCode?this.close():37==a.keyCode||38==a.keyCode?0!=this.D&&SSc(this,this.D-1,!0):39!=a.keyCode&&40!=a.keyCode||VSc(this);a.stopPropagation()};
p.J0b=function(){var a=this.$a("waffle-autovis-lightbox-container");fe(a);this.H=[];RSc(this);SSc(this,this.D,!0)};p.mxb=function(){this.close();lPc(this.F[this.D],2256)};p.I0b=function(){0!=this.D&&SSc(this,this.D-1,!0);0==this.D&&this.J.qb().focus()};p.H0b=function(){VSc(this);this.D==this.F.length-1&&this.L.qb().focus()};function VSc(a){a.D!=a.F.length-1&&SSc(a,a.D+1,!0)}p.close=function(){this.dispose()};p.Id=function(){PSc.oa.Id.call(this);var a=this.F[this.D];a&&a.qb()&&a.qb().focus()};function KW(a,b,c,d,e,f,h){bU.call(this,h);this.Ye=a;this.gc=b.C;this.Kg=qH(b);this.cb=c;this.qf=d;this.J=f;this.Bf=e;this.rb=new JW(b,c,d,f,this.qa());this.Qa(this.rb);this.$=new UT(!1,"#4285f4");this.Qa(this.$);this.V=null;this.Kd=this.yd=!1;this.Dc=!0;this.Rb=qn();this.Mb=this.Lb="";this.ad=null;this.yb=Kj(new Jj,10).build()}x(KW,bU);p=KW.prototype;p.Ma=function(){KW.oa.Ma.call(this);this.wb=N(WSc,{DN:this.Kg})};
p.Wa=function(){KW.oa.Wa.call(this);var a=this.$a("waffle-assistant-quicksum-panel");this.rb.Ab(a);a=this.$a("waffle-assistant-spinner-container");this.$.render(a);a=this.Ye.C;this.getHandler().R(this,"close-sidebar",this.Ama).R(a,"recommender-load-started",this.mma).R(a,"recommender-load-ended",this.kma).R(a,"recommender-calc-started",this.Kla).R(a,"recommender-calc-ended",this.Jla).R(this.$a("waffle-assistant-scroll-pane"),"scroll",Vxc(this.nca,10,this));a=D5a.isEnabled();this.mca(!a)};
p.resize=function(){var a=this.$a("waffle-assistant-sidepane-content");a=si(a).height;var b=this.$a("waffle-assistant-spinner-container");Yh(b,"margin-top",a/2-16+"px");this.nca()};p.Pf=sa;function XSc(a,b){var c=YSc(a);0!=c.length&&(C(a.V),c=c.filter(function(a){return a instanceof eW}),b=c.indexOf(b),0<c.length&&-1!=b&&(a.V=new PSc(c,b,a.Bf,a.J,a.qa()),a.V.render(),a.xa(a.V),QSc(a.V,a.Kd)))}
p.mca=function(a){this.Kd=a;Lh(this.qb(),"waffle-assistant-readonly",a);var b=this.rb;b.O=a;b.C&&(b.C.H=a);Lh(b.qb(),"waffle-assistant-quicksum-panel-readonly",a);this.V&&!this.V.isDisposed()&&QSc(this.V,a)};
p.setVisible=function(a){var b=this.isVisible();KW.oa.setVisible.call(this,a);if(a&&!b){var c=Mxc(this.Ye.C,a);c?(b=new cOc,G(b,1,Wx(c,"r")),G(b,2,Wx(c,"c")),G(b,3,c.vh()),c=new yj,Vf(c,4,b),b=Nj(Oj(this.yb),c).build()):b=this.yb;this.Mb=rn(this.Rb,oA.Iva,!1,b);VT(this.$,!0);ZSc(this)}a||$Sc(this,!0)};p.mma=function(){this.isVisible()&&($Sc(this,!0),VT(this.$,!0))};p.kma=function(){this.isVisible()&&VT(this.$,!1)};
p.Kla=function(a){this.isVisible()&&(this.J.C(2775,this.yb),$Sc(this,void 0,a.C,a.F),aTc(this)||VT(this.$,!0),ZSc(this),this.Dc=!1)};
p.Jla=function(a){if(this.isVisible()){this.J.C(2776,this.yb);var b=a.C;0<b.length&&(this.Lb=rn(this.Rb,oA.Gva));$Sc(this,!1);VT(this.$,!1);a=a.F;for(var c=ha(this.D),d=c.next();!d.done;d=c.next()){d=d.value;for(var e=[],f=ha(b),h=f.next();!h.done;h=f.next()){h=h.value;var k=Xv(h,1);d.zW(k)&&e.push(h)}0<e.length?d.dO(e,a):d.eO(!0)}b=ha(b);for(a=b.next();!a.done;a=b.next())if(a=a.value,5==Xv(a,1)){this.r4();this.sb=V(a,12);this.H=$R(a);this.Na=V(a,11);bTc(this);a=this.H;c=!1;for(d=this.Cb.length-1;0<=
d;d--)NYa(this.Cb[d],a)&&(c=!0,this.Cb.splice(d,1));this.Cb.push(a);a=c;2!=this.sb||a||cTc(this,!0)}b=YSc(this);0<b.length&&this.yd&&(b[b.length-1].Sc=!0);this.yd=!1;ZSc(this);dTc(this);this.nca()}};function ZSc(a){var b=aTc(a),c=vi(a.$a("waffle-assistant-quicksum-panel")),d=a.$.Wb();b=b||c||d;a=a.$a("waffle-assistant-empty-list");L(a,!b)}p.Nc=sa;p.Nqa=sa;p.Pd=g("Kd");p.Ama=sa;
p.XMb=function(){""!=this.Lb&&(sn(this.Rb,this.Lb),this.Lb="");""!=this.Mb&&(sn(this.Rb,this.Mb),this.Mb="");this.ad=Ea();this.Dc||(this.J.Yb(2777,this.yb),this.Dc=!0)};function WSc(a,b,c){b=c||b;a=a||{};c=P;var d=wr('<div class="waffle-assistant-replaceable-title">'+eTc(null,b)+"</div>");var e=e=a||{};var f='<div class="waffle-assistant-empty-list" style="display: none"><div class="waffle-assistant-empty-list-content" aria-live="polite">'+O(v3b({color:"rgb(46%, 46%, 46%)",iconSize:"40"}))+'<div class="waffle-assistant-empty-list-title">';f+='Get insights instantly</div><div class="waffle-assistant-empty-list-body">';f=e.DN?f+"To see answers, formatting, and charts in a single click, try adding more data or selecting different cells in your spreadsheet.":
f+"To see formatting and charts in a single click, try adding more data or selecting different cells in your spreadsheet.";e=P(f+'</div><div class="waffle-assistant-empty-list-learn-more waffle-assistant-empty-list-link"><span>Learn more</span></div><div class="waffle-assistant-empty-list-link"><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try it out</a></div></div></div>');e=P('<div class="waffle-sidebar-tables-bar" style="display: none"><div class="waffle-assistant-sidepane-tables-range"></div><div class="waffle-assistant-tables-edit-range-button">Edit'+
('</div></div><div class="waffle-assistant-scroll-pane"><div class="waffle-assistant-scroll-pane-content"><div class="waffle-assistant-scroll-pane-feature-content">'+e+'<div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-quicksum-panel" style="display: none"></div><div class="waffle-assistant-features"></div></div><div class="waffle-assistant-expanded-panel" style="display: none"></div></div></div>'));return c(O(cU(ur({title:d,jl:wr(""+e),id:vr("autovis"),pI:vr("waffle-assistant-sidepanel"),
Jba:vr("waffle-assistant-title"),cX:vr("waffle-assistant-sidepane-content")},a),b)))}function eTc(){return P('<div class="waffle-assistant-title-bar"><div class="waffle-assistant-title-icon">'+O(v3b({color:"#ffffff",iconSize:"21"}))+'</div><div class="waffle-assistant-title-text">'+O("Explore")+"</div></div>")};function fTc(a,b,c){a=P;b=""+O(Fr({Md:"waffle-assistant-datavalidation-apply-button",content:vr("Apply"),style:4},c||b));b=P(b);return a('<div class="waffle-assistant-datavalidation-rule-group"><div class="waffle-assistant-datavalidation-details"></div><div class="waffle-assistant-datavalidation-description"></div>'+b+"</div>")}function gTc(a){return P('<div class="waffle-assistant-datavalidation-detail-chip">'+O(a.f$a)+"</div>")};function hTc(a,b,c,d){bW.call(this,a,d);this.D=new XT(b,"waffle-assistant-highlight-styled-border","waffle-assistant-highlight-styled-rect");this.xa(this.D);this.C=new Gr("",this.qa());this.Qa(this.C);this.F=$R(a);this.J=c}q(hTc,bW);p=hTc.prototype;p.Ma=function(){bW.prototype.Ma.call(this);cW(this).appendChild(N(fTc))};
p.Wa=function(){bW.prototype.Wa.call(this);var a=this.$a("waffle-assistant-datavalidation-apply-button");this.C.Ab(a);ZV(a,"Apply data validation");this.getHandler().R(this.C,"action",this.tob).R(this.qb(),"mouseenter",this.tNb).R(this.qb(),"mouseleave",this.uNb);a=new Ag;Kwc(a,oFc(yw(V(V(this.H,13),3))));var b=new yg;Vf(b,58,a);a=Lj(Kj(new Jj,10),b).build();this.J.C(35577,a)};
p.zy=function(a){var b=GE(hy(this.F)),c=V(V(this.H,13),3);switch(yw(c)){case 14:var d="Email validation";c=["Is valid email"];break;case 15:d="URL validation";c=["Is valid URL"];break;case 30:d="Date validation";c=["Is valid date"];break;case 24:d="List of items";c=zw(c).map(function(a){return V(a.Io().fb(),2)});break;case 1:d="Numeric validation";c=["Greater than "+V(zw(c)[0].Io().fb(),3)];break;case 7:d="Numeric validation";c=zw(c);c=["Between "+(V(c[0].Io().fb(),3)+(" and "+V(c[1].Io().fb(),3)))];
break;case 5:d="Numeric validation";c=zw(c);c=["Equal to "+V(c[0].Io().fb(),3)];break;default:d="unrecognized",c=[]}var e=new yp,f=e.text(d)+(" for "+(e.ue("SPAN".toString(),{nF:"waffle-assistant-datavalidation-range"})+e.text(b)+e.ye("SPAN".toString())));td(this.$a("waffle-assistant-datavalidation-description"),e.format(f));var h=this.$a("waffle-assistant-datavalidation-details");z(c,function(a){a=N(gTc,{f$a:a});h.appendChild(a)});b="Suggested data validation: "+(d+(" "+(c.join()+(" for "+b))));
Eh(this.qb(),b);a()};p.yy=ba();p.xz=n("assistantDataValidationFeedback");p.hC=n(35551);p.gC=n(35550);p.tob=function(){this.dispatchEvent(new $V("Xd",this,35549))};p.tNb=function(){YT(this.D,gy(this.F))};p.uNb=function(){ZT(this.D)};function LW(a,b,c,d){Qs.call(this,a,b,c,d,void 0,void 0,!0)}x(LW,Qs);LW.prototype.Ma=function(){LW.oa.Ma.call(this);Hh(this.qb(),"waffle-assistant-toast");Hh(this.$a("docs-ui-toast-content"),"waffle-assistant-toast-content")};LW.prototype.Hw=function(a,b,c){c=c?c:"waffle-assistant-toast-action";b=Fi(this,b);LW.oa.Hw.call(this,a,b,c)};LW.prototype.wg=function(a,b,c,d){this.Hw(a,b,d);a=Hi(this,b);this.getHandler().yg(a,gf,v(function(){this.setVisible(!1);c()},this))};function iTc(){A.call(this);this.C=null}x(iTc,A);iTc.prototype.clear=function(){this.C&&(this.C.setVisible(!1),this.C.dispose(),this.C=null)};function fRc(a,b,c,d){a.clear();a.C=new LW(b,c,!1,5E3);a.C.render();d&&a.C.wg("Undo","w-a-u-tm-u",d,void 0);a.C.setVisible(!0);a.C.getElement().focus()}iTc.prototype.Pa=function(){iTc.oa.Pa.call(this);this.clear()};function jTc(a,b,c,d){hW.call(this,1,b,a,d);this.D=c}q(jTc,hW);p=jTc.prototype;p.getTitle=n("Data Validation");p.zW=function(a){return 6==a};p.EP=function(a){var b=V(a,1);switch(b){case 6:return new hTc(a,this.D,this.V,this.qa());default:throw Error("Unsupported recommendation type: "+b);}};p.fO=function(a){hW.prototype.fO.call(this,a);this.setVisible(!a)};p.z2=function(a){return this.Pd()?(this.setVisible(!1),a):hW.prototype.z2.call(this,a)};p.w2=n(4);function kTc(a,b,c){a='<div class="waffle-assistant-banding-recommendation"><div class="waffle-assistant-banding-color-picker-container"></div><div class="waffle-assistant-banding-range-wrapper">Alternating colors for '+('<span class="waffle-assistant-banding-range"></span></div>'+lTc(c||b)+"</div>");return P(a)}
function mTc(a,b,c){return P('<div class="waffle-assistant-conditionalformat-rule-group"><div class="waffle-assistant-conditionalformat-rule-holder" tabindex="0"></div><div class="waffle-assistant-conditionalformat-description"></div>'+lTc(c||b)+"</div>")}function lTc(a){a=""+O(Fr({Md:"waffle-assistant-formatting-edit-button",content:vr("Edit"),style:4},a));return P(a)};function nTc(a,b,c){bW.call(this,a,c);a=Va(Wv(this.H,7),qFc);this.C=new vFc(!1,a,7);this.Qa(this.C);this.J=new Gr("",this.qa());this.Qa(this.J);this.L=b;this.F=!1;this.D=-1}x(nTc,bW);var oTc={xZa:"waffle-assistant-banding-color-picker-container",vda:"waffle-assistant-formatting-edit-button",WE:"waffle-assistant-banding-range"};p=nTc.prototype;p.Ma=function(){nTc.oa.Ma.call(this);cW(this).appendChild(N(kTc))};
p.Wa=function(){nTc.oa.Wa.call(this);this.getHandler().R(this.J,"action",this.Ttb).R(this.C,"xd",this.Xob);this.L.C(2768)};p.zy=function(a){var b=this.$a(oTc.xZa);this.C.render(b);wFc(this.C);b=this.$a(oTc.WE);var c=$R(this.H),d=hy(c);se(b,GE(d));pTc(this,c);b=this.$a(oTc.vda);this.J.Ab(b);a()};p.yy=function(){Eh(this.qb(),"Suggested alternating background colors");ok(this.C,"Choose a color scheme")};p.xz=n("assistantBandingFeedback");p.hC=n(2672);p.gC=n(2671);
p.Ttb=function(a){JA.dispatchEvent({type:"show-banding-pane-recommendation",eTa:this.H,N9a:yFc(this.C)});a.stopPropagation()};p.Xob=function(a){if(!this.F&&xFc(this.C)){var b=this.D;this.D=this.C.Rg();this.D==b?this.dispatchEvent(new $V("ce",this,2797)):this.dispatchEvent(new $V("Vd",this,2673));a.stopPropagation()}};
function pTc(a,b){a.F=!0;var c=b.Ib();b=hy(b);c=ritz_api.RitzModelApi.getWorkbookRangeIntersectingIds(c,b.zc(),b.yc(),b.Yc(),b.cd(),7,!1);c.length?(c=ritz_api.RitzModelApi.getBandedRangeByWorkbookRangeId(c[0]),c=(new $v).zd(Xw.Ba(),c),c=qFc(c)):c=null;c?(c=zFc(a.C,c),NN(a.C,c?c.getElement():null)):NN(a.C,null);a.D=a.C.Rg();a.F=!1};function qTc(a,b){bW.call(this,a,b);this.C=new Gr("",this.qa());this.Qa(this.C);this.Dc=Wv(a,6)}x(qTc,bW);var MW={vda:"waffle-assistant-formatting-edit-button",J0a:"waffle-assistant-conditionalformat-format-preview",Y3a:"waffle-assistant-conditionalformat-rule-holder",rO:"waffle-assistant-conditionalformat-description",O2a:"one-rule",J5a:"two-rules",v5a:"three-rules",s3a:"waffle-assistant-conditionalformat-format-preview-label"};p=qTc.prototype;p.Ma=function(){qTc.oa.Ma.call(this);cW(this).appendChild(N(mTc))};
p.Wa=function(){qTc.oa.Wa.call(this);var a=this.$a(MW.vda);this.C.Ab(a);ZV(a,"Apply and edit conditional format rules");this.getHandler().R(this.C,"action",this.rob)};p.zy=function(a){se(this.$a(MW.rO),Xv(this.H,3));var b=this.$a(MW.Y3a),c=new rTc(this,this.qa());this.Qa(c);c.Ab(b);ZV(b,"Apply conditional format rules");a()};p.yy=sa;p.xz=n("assistantConditionalFormatFeedback");p.hC=n(2630);p.gC=n(2629);
p.rob=function(){this.dispatchEvent(new $V("Wd",this,2563));this.dispatchEvent(new $V("Zd",this,2670,void 0,void 0,hy(V(this.Dc[0],1,0))));l4a()};function rTc(a,b){mk.call(this,void 0,void 0,b);this.C=a}x(rTc,mk);
rTc.prototype.$c=function(a){rTc.oa.$c.call(this,a);var b=this.C.Dc;switch(b.length){case 0:break;case 1:var c=MW.O2a;break;case 2:case 4:c=MW.J5a;break;default:c=MW.v5a}for(var d=0;d<b.length;d++){var e=b[d],f=Yd("DIV");Ih(f,[MW.J0a,c]);var h=Yd("DIV");Hh(h,MW.s3a);f.appendChild(h);se(h,"123");if(Sv(e,2)){var k=V(V(e,2),1);switch(yw(Cw(k))){case 9:case 13:k=zw(Cw(k))[0];var l=Wv(e,1)[0];se(h,OF(k,Xv(l,1),Xv(l,2),Xv(l,4)))}}dzc(e,f);a.appendChild(f)}};
rTc.prototype.hh=function(){var a=this.C;a.dispatchEvent(new $V("Wd",a,2563));return!0};function sTc(a,b,c){hW.call(this,2,b,a,c)}x(sTc,hW);p=sTc.prototype;p.getTitle=n("Formatting");p.zW=function(a){return J(H(),"feecfr")&&2==a||4==a};p.EP=function(a){var b=V(a,1);switch(b){case 2:return new qTc(a,this.qa());case 4:return a=new nTc(a,this.V,this.qa()),this.getHandler().R(a,"Vd",this.QXb).R(a,"ce",this.cKb),a;default:throw Error("Unsupported recommendation type: "+b);}};p.QXb=function(a){fRc(this.sb,"Alternating colors applied",this.qa(),v(this.Yob,this,a.C))};p.cKb=function(){this.sb.clear()};
p.Yob=function(a){this.dispatchEvent(new $V("he",a,2796))};p.fO=function(a){sTc.oa.fO.call(this,a);this.setVisible(!a)};p.z2=function(a){return this.Pd()?(this.setVisible(!1),a):sTc.oa.z2.call(this,a)};p.w2=n(3);function tTc(a,b,c,d,e,f,h,k,l,m,r){bW.call(this,l,r);this.hb=b;this.sb=c;this.Na=d;this.yb=m;this.V=e;this.Aa=h;this.F=new pr("",new WV,this.qa());this.Qa(this.F);this.$=new pr("",new WV,this.qa());this.Qa(this.$);this.C=this.J=this.D=null;this.gb=this.sb.L.C;this.L=Kj(new Jj,66).build();this.ma=new XT(f,"waffle-assistant-highlight-styled-border","waffle-assistant-highlight-styled-rect");this.xa(this.ma);this.Cb=Wv(l,4)}q(tTc,bW);p=tTc.prototype;p.OA=n(!0);
p.Ma=function(){bW.prototype.Ma.call(this);cW(this).appendChild(N(fOc));dW(this).appendChild(N(gOc))};p.Wa=function(){bW.prototype.Wa.call(this);var a=V(this.H,5),b=FEc(this.Aa,a),c=LI(this.hb).rc();this.J=new IEc(b,a,this.gb,this.yb,c,this.Na);a=this.$a("waffle-assistant-insert-pivottable-button");this.F.Ab(a);ZV(a,"Insert Pivot Table");a=this.$a("waffle-assistant-zoom-button");this.$.Ab(a);ZV(a,"Preview Pivot Table");this.getHandler().R(this.F,"action",this.vNb).R(this.$,"action",this.jQa);this.Ct(this.Pd())};
p.zy=function(a){var b=this.qa();b.Ze(this.$a("waffle-assistant-answercard-interpret"),Xv(this.H,3));this.C=b.Ma("CANVAS","waffle-pivottable-pivot-canvas");b.Ak(this.C,!0);Eh(this.C,"Pivot table canvas");var c=this.$a("waffle-assistant-answercard-pivot-content");b.appendChild(c,this.C);this.getHandler().yg(this.C,gf,this.jQa);KEc(this.J,this.C);a()};
p.Ct=function(a){bW.prototype.Ct.call(this,a);if(this.F&&this.Sb()){this.F.setVisible(!a);var b=this.qa().$a("waffle-assistant-button-separator",dW(this));L(b,!a)}this.D&&NNc(this.D,this.Pd())};p.yy=function(){Eh(this.qb(),"Suggested Pivot Table-"+Xv(this.H,3))};p.xz=n("assistantPivotTableFeedback");p.hC=n(2632);p.gC=n(2631);p.vNb=function(){JEc(this.J);this.dispatchEvent("close-sidebar");this.V.C(35619,this.L)};
p.jQa=function(){this.V.C(35620,this.L);this.getHandler().Rc(this.D,"pd",this.iQa).Rc(this.D,"qd",this.hQa);C(this.D);this.D=new MEc(this.J,Xv(this.H,3),this.V,this.L,35621,this.qa());this.getHandler().R(this.D,"pd",this.iQa).R(this.D,"qd",this.hQa);this.D.render();this.xa(this.D);NNc(this.D,this.Pd())};p.iQa=function(){this.C&&this.C.focus()};p.hQa=function(){this.dispatchEvent("close-sidebar")};p.JL=function(){bW.prototype.JL.call(this);MNc(this.ma,jS(this.Cb))};
p.eH=function(){bW.prototype.eH.call(this);ZT(this.ma)};function uTc(a,b,c,d,e,f,h,k,l){hW.call(this,1,f,e,l);this.O=d;this.Na=b;this.Va=c;this.F=h;this.cb=k;this.H=Kj(new Jj,10).build();a=new e5b(a,!0,!0);this.J=new EEc(a);this.D=null}q(uTc,hW);p=uTc.prototype;p.getTitle=n("Pivot Table");p.zW=function(a){return 1==a};p.EP=function(a){var b=V(a,1);switch(b){case 1:return new tTc(this.D,this.Na,this.Va,this.O,this.V,this.F,this.J,this.H,a,this.cb,this.qa());default:throw Error("Unsupported recommendation type: "+b);}};
p.dO=function(a,b){V(a[0],5)&&(this.D=b?b:null,hW.prototype.dO.call(this,a,b))};p.w2=n(5);function NW(a,b,c,d,e){M.call(this);this.L=a;this.sb=b;this.cb=c;this.J=d;this.F=e}q(NW,M);NW.prototype.getTableRange=g("cb");NW.prototype.m$=function(a,b,c){this.cb=a;this.J=b;this.F=c};NW.prototype.Wa=function(){M.prototype.Wa.call(this);this.getHandler().R(this.L.C,"ub",this.yb)};NW.prototype.yb=function(){this.sb.$b()};function vTc(a,b,c,d){d=void 0===d?!1:d;$V.call(this,"ee",null,2859);this.Va=a;this.Na=b;this.F=c;this.V=!!d}q(vTc,$V);vTc.prototype.getTableRange=g("Va");function wTc(a,b){A.call(this);this.F=a;this.H=b;this.C=new XT(a,"waffle-assistant-table-range-border","waffle-assistant-table-range-rect");this.xa(this.C);this.D=new XT(a,"waffle-assistant-header-range-border","waffle-assistant-header-range-rect");this.xa(this.D)}q(wTc,A);wTc.prototype.Pa=function(){ZT(this.C);ZT(this.D);A.prototype.Pa.call(this)};
function xTc(a,b,c,d,e,f){rK(b);var h=hy(d);h=new Hx(h.zc(),h.yc(),Math.min(h.Yc(),h.zc()+6),Math.min(h.cd(),h.yc()+6));var k=qK(b),l=TE(a.F).C,m=lK(l,new sv(h.zc(),h.Yc()),"r",!0,!1,!0,!0)-1,r=lK(l,new sv(h.yc(),h.cd()),"c",!0,!1,!0,!0)-1;l.tc()&&--r;m=Math.min(200,m);r=Math.min(c.offsetWidth-2,r);sK(b,k,r,m);c=cPc(d,e,f);a.H.render(b,h,c);b=a.C;h=d.zc();k=d.yc();switch(e){case 0:h=Math.min(d.Yc(),d.zc()+f);break;case 1:k=Math.min(d.cd(),d.yc()+f)}d=by(d.Ib(),h,k,d.Yc(),d.cd());YT(b,gy(d));YT(a.D,
gy(c))};function yTc(a){var b=a.xSa,c=a.wSa,d=a.VQa;a=a.hBa;return P('<div class="waffle-sidebar-overlay"><div class="waffle-tables-popup" aria-label="'+Q(b)+'"><div class="waffle-tables-popup-header"><div class="waffle-tables-popup-title">'+O(b)+'</div></div><div class="waffle-tables-popup-content">'+O(c)+'<div class="waffle-assistant-canvas-container"><canvas class="waffle-assistant-table-canvas"></canvas></div></div><div class="waffle-tables-popup-buttons"><div class="waffle-tables-popup-button waffle-tables-popup-done">'+
O(d)+'</div><div class="waffle-tables-popup-button waffle-tables-popup-cancel">'+O(a)+"</div></div></div></div>")}
function zTc(){var a=vr("Edit data range");var b=P('<div class="waffle-assistant-tables-recommendation"><div class="waffle-assistant-table-range-container"><div class="waffle-assistant-tables-range-wrapper waffle-assistant-tables-data-range-wrapper"><label id="waffle-assistant-tables-data-range-label">Data Range</label><div class="waffle-assistant-tables-edit-sheet-button"></div></div><div class="waffle-assistant-tables-range-error" style="display:none">Invalid range</div></div><div class="waffle-assistant-header-range-container"><div class="waffle-assistant-tables-range-wrapper">Headers<div class="waffle-assistant-tables-edit-headers-button"></div></div></div></div>');a=
""+yTc({xSa:a,wSa:wr(""+b),VQa:vr("Update"),hBa:vr("Cancel")});return P(a)}function ATc(){var a=""+yTc({xSa:vr("Improve suggestions"),wSa:wr('<div class="waffle-tables-popup-header-message"></div>'),VQa:vr("No"),hBa:vr("Yes")});return P(a)}function BTc(a){a='For <span class="waffle-assistant-table-bar-range">'+(O(a.IA)+"</span>");return P(a)}
function CTc(a){a='Is <span class="waffle-assistant-table-first-header">'+(O(a.YL)+"</span> a header row, containing titles that describe the columns below?");return P(a)};function DTc(a,b,c,d,e,f,h){NW.call(this,a,K$a,d,e,f);this.C=(new $k).build();this.xa(this.C);this.H=new pr("",new WV,this.qa());this.Qa(this.H);rj(this.C,this.H,L$a);this.D=new pr("",new WV,this.qa());this.Qa(this.D);rj(this.C,this.D,K$a);this.O=new wTc(b,c);this.xa(this.O);this.hc=new Te(this);this.xa(this.hc);this.$=h}q(DTc,NW);DTc.prototype.Ma=function(){this.wb=N(ATc)};
DTc.prototype.Wa=function(){NW.prototype.Wa.call(this);this.H.Ab(this.$a("waffle-tables-popup-done"));this.D.Ab(this.$a("waffle-tables-popup-cancel"));var a=cPc(this.getTableRange(),this.F,1);a=GE(hy(a));a=N(CTc,{YL:a});this.$a("waffle-tables-popup-header-message").appendChild(a);this.hc.subscribe(L$a,"action",this.ma).subscribe(K$a,"action",this.V);a=this.$a("waffle-assistant-table-canvas");var b=this.$a("waffle-assistant-canvas-container");xTc(this.O,a,b,this.getTableRange(),this.F,this.J);a=this.$a("waffle-tables-popup");
Lh(a,"waffle-tables-popup-answers-enabled",this.$);b=new mM(a,this.qa());this.xa(b);nM(b);a.focus()};DTc.prototype.V=function(){this.dispatchEvent("fe")};DTc.prototype.ma=function(){var a=hy(this.getTableRange());switch(this.F){case 0:a=Ix(a.top+1,a.left,a.top+a.height,a.left+a.width);break;case 1:a=Ix(a.top,a.left+1,a.top+a.height,a.left+a.width)}var b=this.J-1,c=parseInt(this.getTableRange().Ib(),10);this.dispatchEvent(new vTc(new ay(c,"",a),b,this.F));this.dispatchEvent("fe")};function ETc(a,b,c,d,e,f,h,k,l,m){NW.call(this,a,F$a,d,e,f);var r=this;this.Va=m;this.Cb=b;this.Na=d;this.Jb=e;this.Lb=f;a=hy(d);this.H=GE(a);this.V=parseInt(d.Ib(),10);this.rb=new wTc(b,c);this.xa(this.rb);this.D=this.C=null;this.gb=h;this.O=(new $k).build();this.xa(this.O);this.Aa=new pr("",new WV,this.qa());this.Qa(this.Aa);rj(this.O,this.Aa,H$a);this.ma=new pr("",new WV,this.qa());this.Qa(this.ma);rj(this.O,this.ma,F$a);b=this.L.C.C.Zd();this.$=new MT(this.Cb,function(a,b,c){FTc(r,a,b,c)},!1,
"e.g., A2:D5",!0,b,this.qa());this.Qa(this.$);this.hb=null;this.hc=new Te(this);this.xa(this.hc);this.Nb=k;this.Eb=l}q(ETc,NW);p=ETc.prototype;p.Ma=function(){this.wb=N(zTc)};
p.Wa=function(){NW.prototype.Wa.call(this);this.Aa.Ab(this.$a("waffle-tables-popup-done"));this.ma.Ab(this.$a("waffle-tables-popup-cancel"));this.$.render(this.$a("waffle-assistant-tables-data-range-wrapper"));var a=this.$a("waffle-range-selection-input");Ah(a,"labelledby","waffle-assistant-tables-data-range-label");this.getHandler().R(a,"keydown",this.ANb).R(a,"keyup",this.BNb).R(a,"focusout",this.IHb).R(this.$,"change",this.CNb);this.hc.subscribe(H$a,"action",this.DNb).subscribe(F$a,"action",this.vpb);
GTc(this);a=this.$a("waffle-tables-popup");Lh(a,"waffle-tables-popup-answers-enabled",this.Eb);var b=new mM(a,this.qa());this.xa(b);nM(b);a.focus()};p.Pa=function(){C(this.hb);NW.prototype.Pa.call(this)};function FTc(a,b,c,d){aS(a.Nb,null,b,c,d,!1,void 0,function(b){a.hb=b})}function HTc(a){var b=a.$a("waffle-assistant-table-canvas"),c=a.$a("waffle-assistant-canvas-container");xTc(a.rb,b,c,a.getTableRange(),a.F,a.J)}p.vpb=function(){this.dispatchEvent("fe")};
p.DNb=function(){var a=!ndb.test(this.H);L(this.Kb("waffle-assistant-tables-range-error"),a);Lh(this.$a("waffle-assistant-tables-data-range-wrapper"),"waffle-assistant-tables-range-error-input",a);if(!a){a=this.Jb!=this.J||this.Lb!=this.F;var b=!ryc(this.Na,this.getTableRange()),c=this.Na.Ib()!=this.getTableRange().Ib();if(a||b)a&&this.gb.Yb(35506),b&&this.gb.Yb(35507),this.dispatchEvent(new vTc(gy(this.getTableRange()),this.J,this.F,c));this.dispatchEvent("fe")}};
function GTc(a){var b=a.$a("waffle-range-selection-input"),c=hy(a.Na);a.H=GE(c);b.value=a.H;ITc(a);JTc(a);HTc(a)}p.m$=function(a,b,c){NW.prototype.m$.call(this,a,b,c);HTc(this)};function KTc(a){var b=zH(a.L.C,a.V),c=b.rc();b=rdb(a.H,b);null!=b&&(c=Xyc(ey(b,c)),a.m$(c,LTc(a,c),a.F),ITc(a),JTc(a))}function LTc(a,b){b=MTc(b,a.F);return a.J>b?b:a.J}function MTc(a,b){a=0==b?Xv(a,3)-Xv(a,2):Xv(a,5)-Xv(a,4);return 0==a?3:Math.min(a-1,3)}
function ITc(a){if(a.Va){C(a.D);a.D=new CM;a.Qa(a.D);rj(a.O,a.D,I$a);XR(a.D,fU.getInstance());a.D.render(a.$a("waffle-assistant-tables-edit-sheet-button"));a.getHandler().R(a.D,"action",a.XFb);for(var b=0,c=ha(wdb(a.L.C)),d=c.next();!d.done;d=c.next())if(d=d.value)d.Ib()===a.V&&(b=a.D.Di()),a.D.Fd(new Ek(d.Zd(),d.Ib()));a.D.hf(b)}}
function JTc(a){C(a.C);a.C=new CM;a.Qa(a.C);rj(a.O,a.C,G$a);XR(a.C,fU.getInstance());a.C.render(a.$a("waffle-assistant-tables-edit-headers-button"));a.getHandler().R(a.C,"action",a.gwb);for(var b=MTc(a.getTableRange(),0),c=0;c<=b;c++){var d=(new Rt("{NUM_HEADER_RECORDS, plural,=0 {No rows}=1 {1 row}other {# rows}}")).format({NUM_HEADER_RECORDS:c});a.C.Fd(new Ek(d))}c=MTc(a.getTableRange(),1);for(d=0;d<=c;d++){var e=(new Rt("{NUM_HEADER_RECORDS, plural,=0 {No columns}=1 {1 column}other {# columns}}")).format({NUM_HEADER_RECORDS:d});
a.C.Fd(new Ek(e))}c=a.J;a.C.hf(0==a.F?c:c+b+1);Ah(a.C.qb(),"label","Headers")}p.IHb=function(){var a=this.$a("waffle-range-selection-input");this.H!=a.value&&(this.H=a.value,KTc(this))};p.CNb=function(){var a=this.$.fb();this.H=a;var b=this.$a("waffle-range-selection-input");b.value=a;b.select();KTc(this)};p.XFb=function(){var a=this.D.fb();a!=this.V&&(this.V=a,NTc(this,this.V));KTc(this)};
function NTc(a,b){if(a.Va){var c=zH(a.L.C,b),d=LG(c).clone();c=ha(GG(c));for(var e=c.next();!e.done;e=c.next())d.ym(e.value);ritz_api.TablesApi.getTables(fy(ey(d,b)),function(b){b.length&&(b=hy(xP(b[0].getTableRange())),b=GE(b),a.H=b,b=a.$a("waffle-range-selection-input"),b.value=a.H,b.select(),KTc(a))})}}
p.ANb=function(a){var b=this.$a("waffle-range-selection-input");switch(a.keyCode){case 13:a.stopPropagation();a.preventDefault();this.H=b.value;KTc(this);H$a.$b();break;case 27:a.stopPropagation(),a.preventDefault(),GTc(this),F$a.$b()}};p.BNb=function(){this.H=this.$a("waffle-range-selection-input").value;KTc(this)};p.gwb=function(){var a=this.C.Rg(),b=MTc(this.getTableRange(),0);this.m$(this.getTableRange(),a-(0==(a>b?1:0)?0:b+1),a>b?1:0)};function OW(a,b,c,d,e,f,h,k,l,m,r,u){KW.call(this,a,b,c,e,d,f,u);this.Se=r;this.ze=h;this.Va=b;this.Eb=new M(this.qa());this.Qa(this.Eb);this.Aa=new iTc;this.xa(this.Aa);this.D=[];this.F=null;this.Ob=new Gr("",u,4);mj(this.Ob,2,!1);this.Qa(this.Ob);this.Le=k;this.Lg=l;this.Nb=m;this.H=null;this.sb=0;this.Na=null;this.Sc=new pr("",new WV,this.qa());this.Qa(this.Sc);this.ld=new M(this.qa());this.Qa(this.ld);this.$d=(new $k).build();this.xa(this.$d);rj(this.$d,this.Sc,J$a);this.ma=this.O=null;this.Cb=
[]}x(OW,KW);var PW={yE:"waffle-assistant-scroll-pane-feature-content",Qec:"waffle-assistant-empty-list",w0a:"waffle-assistant-features",J1a:"waffle-assistant-empty-list-learn-more",pea:"waffle-assistant-expanded-panel",Lxa:"waffle-assistant-replaceable-title",d4a:"waffle-assistant-scroll-pane",o5a:"waffle-assistant-sidepane-tables-range",p5a:"waffle-sidebar-tables-bar",gza:"waffle-assistant-tables-scroll-pane",q5a:"waffle-assistant-tables-edit-range-button",Py:"waffle-assistant-title"},OTc={defaultHelpArticleId:"6280499"};
p=OW.prototype;
p.Wa=function(){var a=this;OW.oa.Wa.call(this);this.Eb.Ab(this.$a(PW.pea));ZV(this.C.qb(),"Close");this.ld.Ab(this.$a(PW.o5a));bTc(this);this.Sc.Ab(this.$a(PW.q5a));if(qH(this.Va)){var b=new HW(this.ze,this.cb,this.gc,this.qf,this.J,this.Aa,this.Va,this.Lg,this.Nb,this.Se,this.qa());this.Qa(b);this.D.push(b)}b=new sTc(this.J,this.Aa,this.qa());this.Qa(b);this.D.push(b);J(H(),"feedvs")&&(b=new jTc(this.J,this.Aa,this.cb,this.qa()),this.Qa(b),this.D.push(b));J(H(),"feepts")&&(b=new uTc(this.ze,this.gc,
this.Va,this.qf,this.J,this.Aa,this.cb,this.Se,this.qa()),this.Qa(b),this.D.push(b));b=new iW(this.gc,this.cb,this.Bf,this.J,this.Aa,this.qa());this.Qa(b);this.D.push(b);var c=this.$a(PW.w0a);z(this.D,function(b){b.render(c);a.Eb.Qa(b.C,!0)});this.Ob.Ab(this.$a(PW.J1a));this.getHandler().R(this.Ob,"action",this.t0b).R(this,"fe",this.r4).R(this,"ee",this.u0b);PTc(this)};p.u0b=function(){var a=QTc(this);a&&(a.cb=!0)};p.t0b=function(){K.$n.$b(OTc)};function dTc(a){z(a.D,function(a){HPc(a)})}
function $Sc(a,b,c,d){z(a.D,function(a){a.eO(b,c,d)})}function aTc(a){return!!Za(a.D,function(a){return a.Oma()})}p.nca=function(){var a=this,b=this.$a("waffle-assistant-scroll-pane").scrollTop+si(this.$a("waffle-assistant-sidepane-content")).height;z(this.D,function(c){a.F&&a.F!=c||(c instanceof iW&&a.getHandler().Wc(c,"$d",a.XMb),b=c.z2(b))})};function YSc(a){if(a.F)return a.F.C.C;var b=[];z(a.D,function(a){pb(b,GPc(a))});return b}p.mca=function(a){OW.oa.mca.call(this,a);PTc(this)};
p.Pf=function(a){z(this.D,function(b){b.Pf(a)})};p.Nqa=function(){var a=this.$a(PW.Lxa),b=this.$a(PW.Py);oi(b,si(a).height)};
p.Nc=function(){var a=this,b=this.$a(PW.yE),c=this.$a(PW.Lxa),d=this.Eb.qb();if(this.F)this.F.C.setVisible(!1),this.F.SU(!1),this.F=null,L(d,!1),L(b,!0),kr(c,eTc),Bh(c,"label"),this.resize(),LA("Explore Opened");else if(this.F=Za(this.D,function(a){return a.Wb()}))L(b,!1),L(d,!0),this.F.C.setVisible(!0),IPc(this.F,c),Eh(c,this.F.getTitle()),b=this.F.getTitle()+" section expanded.",LA(b);this.Nqa();b=new Ui(function(){var b=Wt;b&&b.dispatchEvent("resize");a.nca()},300);this.xa(b);b.start()};
p.setVisible=function(a){var b=this.isVisible();OW.oa.setVisible.call(this,a);a&&!b&&RTc(this,!0);a||this.Aa.clear()};p.Ama=function(){OW.oa.Ama.call(this);this.F&&this.Nc();this.r4()};p.mma=function(){OW.oa.mma.call(this);RTc(this,!0)};p.kma=function(){OW.oa.kma.call(this);RTc(this,!1)};p.Kla=function(a){OW.oa.Kla.call(this,a);RTc(this,!0,a.C)};p.Jla=function(a){OW.oa.Jla.call(this,a);RTc(this,!1)};
function STc(a,b){var c=QTc(a);if(b){lic(a.O);var d=J(H(),"feenas");a.O=new ETc(a.Va,a.cb,a.Le,a.H,a.sb,a.Na,a.J,a.Nb,null!=c&&c.Wb(),d);a.Qa(a.O);a.O.render(a.getElement())}else a.O&&(a.removeChild(a.O,!0),C(a.O),a.O=null);c&&FSc(c,b)}function cTc(a,b){if(1!=a.Na){var c=QTc(a);b?(a.ma=new DTc(a.Va,a.cb,a.Le,a.H,a.sb,a.Na,null!=c&&c.Wb()),a.Qa(a.ma),a.ma.render(a.getElement())):a.ma&&(a.removeChild(a.ma,!0),C(a.ma),a.ma=null);c&&FSc(c,b)}}function PTc(a){z(a.D,function(b){b.fO(a.Pd())})}
function QTc(a){return(a=Za(a.D,function(a){return a instanceof HW}))&&a}function TTc(a){return(a=Za(a.D,function(a){return a instanceof uTc}))&&a}function RTc(a,b,c){z(a.D,function(a){a.pXa(b,c)});b&&(a.H=null,a.sb=0,a.Na=null,a.r4(),bTc(a))}
function bTc(a){var b=a.$a(PW.p5a),c=a.$a(PW.d4a);var d=null;var e=J(H(),"feenas"),f=a.gc.getActiveGrid();if(a.H||e&&f){if(a.H){var h=hy(a.H);f=a.H.Ib();e&&(d=XA(a.Va.C,parseInt(f,10)).Zd())}else h=f.Kc().Oc(),d=f.Zd(),a.H=ey(h,f.Ib()),a.Na=0;d=GE(h,d);d=N(BTc,{IA:d});a=a.ld.Qb();fe(a);a.appendChild(d);L(b,!0);Hh(c,PW.gza)}else L(b,!1),Jh(c,PW.gza)}p.r4=function(){STc(this,!1);cTc(this,!1)};function UTc(a,b,c){b=c||b;a=a||{};if(a.TMa){c=a.TMa;var d='<div class="docs-explore-promo-header">'+O(null!=c?c:"")+"</div>"}else d="";var e=a.c$a;c=P;b='<div class="docs-explore-promo-base docs-ui-unprintable '+Q(a.ag)+'"><div class="docs-explore-promo-content">'+d+'<div class="docs-explore-promo-description">'+O(null!=e?e:"")+'<div class="docs-explore-promo-buttons">'+(a.SBa?O(Fr({Md:"docs-explore-promo-button docs-explore-promo-continue-button",content:wr(""+O(a.SBa)),style:4},b)):"")+(a.KCa?
O(Fr({Md:"docs-explore-promo-button docs-explore-promo-close-button",content:wr(""+O(a.KCa)),style:4},b)):"")+"</div></div></div>";a=a.qNa?P('<div class="docs-explore-promo-icon-wrapper"><div class="docs-explore-promo-icon">'+O(v3b({color:a.qNa,iconSize:"32"}))+"</div></div>"):"";return c(b+a+"</div>")};function VTc(a,b){M.call(this,b);this.F=new Gr("",b);this.Qa(this.F);this.C=new Gr("",b);this.Qa(this.C);this.D=new Gr("",b);mj(this.D,2,!1);this.Qa(this.D);this.H=a;Jaa([K.yda,K.zda,K.Fva],!0)}x(VTc,M);p=VTc.prototype;p.Ma=function(){this.wb=N(UTc,this.H)};
p.Wa=function(){VTc.oa.Wa.call(this);var a=this.Kb("docs-explore-promo-continue-button");a&&this.F.Ab(a);(a=this.Kb("docs-explore-promo-close-button"))&&this.C.Ab(a);(a=this.Kb("docs-explore-promo-icon"))&&this.D.Ab(a);this.getHandler().R(this.F,"action",this.EDa).R(this.C,"action",this.zab).R(this.D,"action",this.Awb)};p.show=function(a){K.Fva.$b();this.render(a)};p.EDa=function(a){K.yda.$b();a.stopPropagation()};p.zab=function(a){K.zda.$b();a.stopPropagation()};p.Awb=function(a){this.EDa(a)};function WTc(a){VTc.call(this,{ag:"waffle-assistant-entry-promo",TMa:"More insights, instantly",c$a:"Now, Sheets Explore uses the power of pivot tables to help you better understand your data",SBa:"Check it out",KCa:"Dismiss",qNa:"#0F9D58"},a)}q(WTc,VTc);function XTc(a,b,c,d,e,f,h,k,l,m,r,u){var w=this;lU.call(this,b,h);this.L=a;this.C=b;this.cb=c;this.gb=d;this.gc=e;this.O=f;this.Va=k;this.H=c.C;this.Jb=this.sb=!1;this.F=null;this.ma=l;this.Nb=m;this.Gd=r;this.Rb=u;this.Zc=new $v;this.yb=this.$=this.J=null;a=new oH;W(a,18,!0);W(a,12,xA);this.Ob=new LFc(a,5E4);this.Na=this.Aa=null;YTc(this);C5a.ib(!0);a=new Ag;G(a,6,ZTc());b=new yg;Vf(b,58,a);this.hb=Kj(Lj(new Jj,b),10).build();qn();this.rb=-1;"true"==Fl(Hl(yA("win").location.href),"rEPP")&&OI(this.Va,
"ritz-DisplayExplorePivotPromoV2",!0);a=new Ui(function(){return $Tc(w,!1)},100);this.xa(a);a.start()}x(XTc,lU);
function YTc(a){var b=pG(a.gc);a.bb.R(a.gb,"selectionChange",a.x0b).R(a.H,"ub",a.v0b).R(a.H,"Eb",a.z0b).R(b,"Ca",a.kzb).R(a.C,"Xd",a.vob).R(a.C,"Wd",a.uob).R(a.C,"Vd",a.sob).R(a.C,"ce",a.RDb).R(a.C,"Zd",a.Mpb).R(a.C,"ae",a.w0b).R(a.C,"be",a.nxb).R(a.C,"ge",a.UGb).R(a.C,"de",a.rFb).R(a.C,"Yd",a.Uob).R(a.C,"he",a.A0b).R(a.L.C,"recommender-confidence-update",a.orb).R(a.C,"ee",a.y0b);a.hc.Tb(D5a,Na,a.txb).subscribe(F5a,"action",a.Rob).subscribe(E5a,"action",a.zGb).subscribe(y5a,"action",a.Kpa).subscribe(PB,
"action",a.TAb).subscribe(J$a,"action",a.PGb).subscribe(e9a,"action",a.q8)}p=XTc.prototype;p.Mg=function(){return G5a};p.Bs=function(){return H5a};p.mw=function(a){XTc.oa.mw.call(this,a);E5a.ib(a);$Tc(this,!1);!this.sb&&a&&(this.sb=!0);Zs(this.Rb,{kc:a});a||(this.C.Nc(),(a=TTc(this.C))&&a.isVisible()&&dOc()&&FNc(this.Va)&&OI(this.Va,"ritz-DisplayExplorePivotPromoV2",!1))};p.VZ=function(a){var b=this;this.C.Nqa();var c=new Ui(function(){XTc.oa.VZ.call(b,a)},300);this.xa(c);c.start()};
p.q8=function(){XTc.oa.q8.call(this);aUc(this,!1)};p.Pf=function(a){this.C.Pf(a);this.L.Pf(a)};p.vob=function(a){var b=a.C.H,c=V(V(b,13),3);b=$R(b);var d=new Bw;W(d,1,c);var e=new oy;W(e,1,d);W(e,3,!0);Swc(e,!0);this.O.C(new dQ(e,b));QW(this,a.Ui(),!1,oFc(yw(c)))};p.Rob=function(){var a=this.C.isVisible();this.Mg().setVisible(!a);a||this.C.focus();aUc(this,!a)};function aUc(a,b){b?(QW(a,2253),a.rb=Ea()):QW(a,2226,!0)}p.Kpa=function(){this.C.isVisible()||this.mw(!0)};
p.TAb=function(){var a=QTc(this.C);a&&(a.Wb()?ISc(a,"",!0):(this.Kpa(),HSc(a,"",!0)))};p.zGb=function(a){XSc(this.C,a)};p.PGb=function(){STc(this.C,!0)};p.z0b=function(){SR(this.L.C)||(this.L.C.reset(),$Tc(this,!1))};p.x0b=function(){if(RI(this.cb)&&null==this.C.O){var a=SR(this.L.C);a&&VA(this.H)!=a.Ib()||$Tc(this,!0)}};
function $Tc(a,b,c){if(c){if(!c.length)return;if(1==c.length&&a.J&&c[0].equals(a.J)){a.J=null;return}}var d=a.C;d.isVisible()&&(d.rb.refresh(void 0),ZSc(d));a.L.update(!b,a.C.isVisible(),c)}p.l$a=function(){bUc(this)};function bUc(a){a.$&&(L(a.$.qb(),!1),Db(a.$,a.Na),a.$=null,a.Na=null,a.yb=null)}p.uub=function(){bUc(this);var a=TTc(this.C);a&&(this.Kpa(),a.SU(!0),a.dispatchEvent("de"))};
p.orb=function(a){var b=this,c=(a=a.C)?a.H:null,d=a?a.C:0,e=!!a&&a.F,f=a?a.H.rect:null;f=!!f&&f.vh()>=$2a&&Wx(f,"r")>=b3a&&Wx(f,"c")>=c3a&&f.vh()<=a3a;cUc(this,c,!!a&&a.D&&f);c.equals(this.yb)||bUc(this);f&&(dUc(this,c,d,e),dOc()&&FNc(this.Va)&&(this.Aa&&(this.Aa.cancel(),this.Aa=null),!this.C.isVisible()&&c&&(this.Aa=MFc(this.Ob,[c]),this.Aa.then(function(a){a.C.length&&(b.yb=c,b.$=new WTc,b.xa(b.$),b.$.show(),b.Na=new Te(b),b.xa(b.Na),b.Na.subscribe(K.yda,"action",b.uub).subscribe(K.zda,"action",
b.l$a),OI(b.Va,"ritz-DisplayExplorePivotPromoV2",!1))}))))};function cUc(a,b,c){if(c!==a.Jb||b&&!b.intersects(a.F))a.Jb=c,a.F=b,a.rb=Ea(),C5a.$b({r9:c,IA:b})}p.JAa=function(a){var b=this;this.C.yd=!0;var c=WG(LI(this.H));if(!vec.C&&!c){var d=a||this.hb;this.Mg().setVisible(!0);this.ma.Yb(2225,d);QW(this,2253);a=new Ui(function(){b.C.isVisible()||b.ma.Yb(2752,d)},5E3);this.xa(a);a.start()}};
function dUc(a,b,c,d){if(b&&b.rect){var e=1E3>=b.rect.vh();b=ritz_api.RitzModelApi.isFormsRegion(""+b.bd,b.rect.top,b.rect.left,b.rect.height+b.rect.top,b.rect.width+b.rect.left);d=!a.C.isVisible()&&!a.sb&&d&&e&&!a.cb.Dh();e=J(H(),"feeaof")&&b;b=J(H(),"feeaoro")&&a.cb.Pd();d&&(e||b)&&(d=new Ag,G(d,1,c),G(d,2,e),G(d,3,b),G(d,5,xA),G(d,6,ZTc()),c=new yg,Vf(c,58,d),c=Lj(Kj(new Jj,10),c).build(),a.JAa(c))}}
function ZTc(){switch(d3a){case "NO_DELAY":return 1;case "DELAY_500MS":return 2;case "DELAY_1S":return 3;case "DELAY_2S":return 4;default:return 0}}p.Uob=function(){this.C.Nc()};p.A0b=function(a){var b=a.C,c=$R(b.H),d=parseInt(c.Ib(),10);this.J=hy(c);this.O.C(new ffc(d));pTc(b,c);QW(this,a.Ui())};p.v0b=function(){UE(this.H)?(this.C.ib(!0),this.L.C.reset(),$Tc(this,!1)):(this.Mg().setVisible(!1),this.C.ib(!1))};p.txb=function(){this.C.mca(!D5a.isEnabled())};p.kzb=function(a){$Tc(this,!1,u4a(a))};
p.uob=function(a){var b=LI(this.H),c=""+b.rc(),d=[],e=azc(b);if(e){b=new $y;var f=Xv(e,2);W(b,3,f);f=Xv(e,2);W(b,2,f);e=Xv(e,1);W(b,1,e);d.push(b)}b=a.C.Dc;for(e=0;e<b.length;e++)f=new $y,W(f,2,b[e]),d.push(f);this.O.C(new QFc(d,c));QW(this,a.Ui())};
p.sob=function(a){var b=a.C,c=yFc(b.C),d=$R(b.H),e=c.Nu?c.Bx:null,f=c.C?c.ax:null,h=parseInt(d.Ib(),10),k=eUc(d);this.J=hy(d);k?this.O.C(new kU(k,h,this.J,e,c.us,c.ot,f)):this.O.C(new jU(h,this.J,e,c.us,c.ot,f));d=new Yxc;G(d,1,1);c=new WR;b=V(b.H,2);G(c,2,b);Vf(c,5,d);b=ePc(this.F);Vf(b,46,c);b=Lj(Kj(new Jj,10),b).build();this.ma.C(a.Ui(),b)};p.RDb=function(a){a=a.C;var b=$R(a.H),c=parseInt(b.Ib(),10),d=eUc(b);this.J=hy(b);this.O.C(new PFc(d,c));pTc(a,b)};
p.y0b=function(a){var b=OYa(a.getTableRange()),c=cPc(b,a.F,a.Na),d=this.L,e=a.F;Ywc(d.C);d.C.$=b;d.C.gb=c;d.C.hb=e;Pxc(d.C,!0,!0,!1);QW(this,a.Ui());a.V&&(QTc(this.C).eO(!0,!1,!0),a=this.C,b=[b],a.isVisible()&&(a.rb.refresh(b),ZSc(a)))};function eUc(a){var b=a.Ib();a=hy(a);b=ritz_api.RitzModelApi.getWorkbookRangeIntersectingIds(b,a.zc(),a.yc(),a.Yc(),a.cd(),7,!1);return 0<b.length?b[0]:null}p.Mpb=function(a){QG(LI(this.H),a.gb);QW(this,a.Ui())};
p.UGb=function(a){var b=a.C;a=a.Ui();if(b instanceof vW||b instanceof xW||b instanceof tTc)QW(this,a);else{var c=YSc(this.C),d=new WR,e=V(b.H,2);c=c.indexOf(b);G(d,1,c);G(d,2,e);e=new yg;Vf(e,46,d);if(b instanceof eW){(d=b.J)?(b=fUc(this,b,d),b=NDc(b,d,d.oh)):b=null;if(!b)return;Vf(e,39,b)}else if(b instanceof wPc){var f=b.H;c=new PNc;if(b instanceof wPc)b=1;else throw Error("Unknown text analysis card type.");f=Wv(V(f,8),20).slice(0,10);G(c,2,f||[]);G(c,1,b);Vf(d,3,c)}e=Lj(Kj(new Jj,10),e).build();
this.ma.C(a,e)}};p.rFb=function(){this.C.Nc()};p.w0b=function(a){var b=a.bx();if(b){var c=a.Na,d=Wv(c,1).map(function(a){return hy(a)});d=bzc(this.cb,d,a.H||void 0,a.O||void 0);Dxc(d,c);Fxc(d,b);this.gb.dispatchEvent(new qJ("objectRequest"));this.O.C(new cN([d]));var e=gUc(this,a.Va);HNc(e,d.getId()||0);HDc(this.ma,a.Ui(),e,10,b,c,void 0,a.F)}};
p.nxb=function(a){var b=a.V;if(b){var c=a.H;c||(c=Yx(TE(this.gb).D.C));var d=16,e=16,f=a.O;f&&(d=f.x,e=f.y);f=Jxc(this.cb.J);d={oid:null,ar:c.y,ac:c.x,x:d,y:e,h:Vmb.height,w:Vmb.width,p:{context:Dyc(f)}};(c=b.oh)?(e=new wl(c),d=new zI(VA(this.H)||0,d,!1,!1),f=Fl(e,"headers"),f=null!=f&&la(f)&&Lb(f)?parseInt(f,10):-1,d.V=f,d.H=0,f="1"==Fl(e,"transpose"),d.$=f,d.F=f?"ROWS":"COLS",f=Fl(e,"range"),f=syc(tyc(f,","),this.H),d.PD(f),(e=Fl(e,"dt"))&&dsb(d,this.Zc.zd(Wz.Ba(),JSON.parse(decodeURIComponent(e))))):
(e=new cA,W(e,2,"0.6"),Twc(e,a.le().toJSON()),d=new zI(VA(this.H)||0,d,!1,!1,e));BI(d);Exc(d,b);this.gb.dispatchEvent(new qJ("objectRequest"));this.O.C(new cN([d]));e=hUc(this,b,a.Na,a.le());d=d.getId()||0;e.C=d;MDc(this.ma,a.Ui(),e,10,b,c,void 0,a.F)}};function fUc(a,b,c){var d=YSc(a.C).filter(function(a){return a instanceof eW});return hUc(a,c,d.indexOf(b),b.J&&b.J.le())}
function gUc(a,b){var c=new KT;a=YSc(a.C).filter(function(a){return a instanceof eW}).map(function(a){return a.getChartType()});c.L=a;c.H=b;return c}function hUc(a,b,c,d){var e=new KT;a=YSc(a.C).filter(function(a){return a instanceof eW}).map(function(a){return a.getChartType()});e.L=a;e.H=c;tDc(e,b.getChartType());e.F=d?d.clone():null;return e}
function QW(a,b,c,d){if(a.F){var e=Tf(Ij(a.hb),Ag,58).getTableRange();if(c||!e||e.Ib()!=a.F.bd||e.yc()!=a.F.rect.yc()||e.zc()!=a.F.rect.zc()||e.cd()!=a.F.rect.cd()||e.Yc()!=a.F.rect.Yc()){e=new Ag;G(e,6,ZTc());var f=dPc(a.F);Vf(e,7,f);c&&(c=Ea()-a.rb,G(e,8,1E3*c),null!=a.C.ad&&(c=Ea()-a.C.ad,G(e,10,1E3*c)));d&&Kwc(e,d);d=J(H(),"feacos");G(e,9,d);d=new yg;Vf(d,58,e);a.hb=Kj(Lj(new Jj,d),10).build()}}a.ma.Yb(b,a.hb)};function iUc(){A.call(this)}x(iUc,AA);iUc.prototype.D=function(){return LSc};iUc.prototype.H=function(){return OW};iUc.prototype.F=function(){return XTc};iUc.prototype.C=function(){return BOc};GA("assistant",iUc);
